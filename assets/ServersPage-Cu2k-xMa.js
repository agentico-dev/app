import{p as K,u as P,q as x,t as E,j as e,r as N}from"./react-vendor-D9Z7L--9.js";import{B as C}from"./button-DyydDRsx.js";import{u as B,b as R,s as f,e as Y}from"./index-AU1k0GBq.js";import{F as z}from"./FilterControls-CYc6oIE5.js";import{C as y,a as w,b as T,c as A,d as j,e as F}from"./card-j9p50iY2.js";import{T as M}from"./TagBadge-BYfxwD_9.js";import{S as L}from"./star-DSolPrZb.js";import{S as _}from"./server-BMkKp4mD.js";import{C as k}from"./circle-plus-D6Dz8vAz.js";import"./ui-components-CC8ri8vc.js";import"./supabase-BVXwAj-b.js";import"./utils-DVqAV-fM.js";import"./input-C9MDm0T4.js";import"./select-DduSmGHa.js";import"./chevron-down-lRykjHmp.js";import"./check-B_vNfbYE.js";import"./chevron-up-6oX-8_Pk.js";import"./popover-BldgfOD1.js";import"./dialog-D_FN0Fk6.js";import"./search-DW8VQmka.js";import"./badge-DQslapAQ.js";import"./filter-CmYZIYFF.js";import"./tag-DrRrhomQ.js";try{let r=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},t=new r.Error().stack;t&&(r._sentryDebugIds=r._sentryDebugIds||{},r._sentryDebugIds[t]="f535b5ff-3550-4bc3-a53c-d29f8ca9e3e0",r._sentryDebugIdIdentifier="sentry-dbid-f535b5ff-3550-4bc3-a53c-d29f8ca9e3e0")}catch{}function O(){const{session:r}=B(),{toast:t}=R(),n=K(),l=!!r.user,{data:m,isLoading:d,error:c}=P({queryKey:["servers"],queryFn:async()=>{let s=f.from("servers").select("*").order("created_at",{ascending:!1});const{data:a,error:o}=await s;if(o)throw o;return a}}),i=x({mutationFn:async s=>{if(!r.user)throw new Error("Authentication required");const{data:a,error:o}=await f.from("servers").insert({name:s.name,description:s.description,type:s.type||"Standard",status:s.status||"development",organization_id:s.organization_id,user_id:r.user.id,tags:s.tags||[]}).select().single();if(o)throw o;return a},onSuccess:()=>{n.invalidateQueries({queryKey:["servers"]}),t({title:"Server created",description:"Your new server has been created successfully."})},onError:s=>{t({title:"Error creating server",description:s.message,variant:"destructive"})}}),g=x({mutationFn:async({id:s,...a})=>{if(!r.user)throw new Error("Authentication required");const{data:o,error:h}=await f.from("servers").update({name:a.name,description:a.description,type:a.type,status:a.status,tags:a.tags,updated_at:new Date().toISOString()}).eq("id",s).select().single();if(h)throw h;return o},onSuccess:()=>{n.invalidateQueries({queryKey:["servers"]}),t({title:"Server updated",description:"The server has been updated successfully."})},onError:s=>{t({title:"Error updating server",description:s.message,variant:"destructive"})}}),u=x({mutationFn:async s=>{if(!r.user)throw new Error("Authentication required");const{error:a}=await f.from("servers").delete().eq("id",s);if(a)throw a;return s},onSuccess:s=>{n.invalidateQueries({queryKey:["servers"]}),t({title:"Server deleted",description:"The server has been deleted successfully."})},onError:s=>{t({title:"Error deleting server",description:s.message,variant:"destructive"})}}),p=x({mutationFn:async({id:s,favorite:a})=>{if(!r.user)throw new Error("Authentication required");const{data:o,error:h}=await f.from("servers").update({favorite:a}).eq("id",s).select().single();if(h)throw h;return o},onSuccess:()=>{n.invalidateQueries({queryKey:["servers"]})},onError:s=>{t({title:"Error updating favorite status",description:s.message,variant:"destructive"})}});return{servers:m,isLoading:d,error:c,isAuthenticated:l,createServer:i,updateServer:g,deleteServer:u,toggleFavorite:p}}const V={active:"bg-green-500",inactive:"bg-red-500",maintenance:"bg-yellow-500",development:"bg-blue-500",deprecated:"bg-gray-500",planning:"bg-purple-500"};function $({server:r,onToggleFavorite:t,tags:n}){const l=E(),m=()=>{l(`/servers/${r.id}`)},d=async c=>{c.stopPropagation(),await t(r.id,r.favorite)};return e.jsx(y,{className:"overflow-hidden hover:shadow-md transition-shadow cursor-pointer",onClick:m,children:e.jsxs("div",{className:"relative",children:[e.jsxs(w,{className:"pb-0",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`w-3 h-3 rounded-full mr-2 ${V[r.status.toLowerCase()]||"bg-gray-500"}`}),e.jsx(T,{className:"text-lg",children:r.name})]}),e.jsx("button",{onClick:d,className:"text-muted-foreground hover:text-yellow-400 transition-colors","aria-label":r.favorite?"Remove from favorites":"Add to favorites",children:r.favorite?e.jsx(L,{className:"h-5 w-5 fill-yellow-400 text-yellow-400"}):e.jsx(L,{className:"h-5 w-5"})})]}),e.jsx(A,{className:"line-clamp-2",children:r.description||"No description available"})]}),e.jsxs(j,{className:"pt-4",children:[e.jsx("div",{className:"flex items-center text-sm text-muted-foreground mb-2",children:e.jsxs("div",{className:"flex items-center mr-4",children:[e.jsx(_,{className:"h-4 w-4 mr-1"}),e.jsx("span",{children:r.type})]})}),e.jsxs("div",{className:"flex flex-wrap gap-1 mt-2",children:[r.tags.slice(0,3).map(c=>{var i;return e.jsx(M,{name:((i=n.find(g=>g.id===c))==null?void 0:i.name)||"Unknown"},c)}),r.tags.length>3&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:["+",r.tags.length-3," more"]})]})]}),e.jsxs(F,{className:"pt-0 text-xs text-muted-foreground",children:["Created ",new Date(r.created_at).toLocaleDateString()]})]})},r.id)}function H({count:r=6}){return e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Array.from({length:r}).map((t,n)=>e.jsxs(y,{className:"animate-pulse",children:[e.jsx(w,{className:"h-24 bg-muted"}),e.jsxs(j,{className:"py-4",children:[e.jsx("div",{className:"h-5 bg-muted rounded mb-2 w-3/4"}),e.jsx("div",{className:"h-4 bg-muted rounded w-1/2"})]}),e.jsx(F,{children:e.jsx("div",{className:"h-4 bg-muted rounded w-full"})})]},n))})}function U({hasServers:r,isFiltered:t,searchQuery:n}){const l=E();return e.jsxs(y,{className:"mt-8",children:[e.jsxs(w,{children:[e.jsx(T,{className:"text-xl",children:"No Servers Found"}),e.jsx(A,{children:r&&t?"No servers match your current filters. Try changing your search criteria.":"You haven't created any servers yet. Click 'New Server' to get started."})]}),e.jsxs(j,{className:"flex flex-col items-center justify-center p-8",children:[e.jsx(_,{className:"h-16 w-16 text-muted-foreground mb-4"}),e.jsxs(C,{onClick:()=>l("/servers/new"),className:"mt-4",children:[e.jsx(k,{className:"mr-2 h-4 w-4"}),"Create Your First Server"]})]})]})}function G({servers:r,filteredServers:t,isLoading:n,toggleFavorite:l,tags:m,searchValue:d,selectedStatus:c,selectedTags:i}){if(n)return e.jsx(H,{});const g=d!==""||c!==null||i.length>0,u=r&&r.length>0;return t.length===0?e.jsx(U,{hasServers:u,isFiltered:g,searchQuery:d}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(p=>e.jsx($,{server:p,onToggleFavorite:l,tags:m},p.id))})}function ye(){const r=E(),{servers:t,isLoading:n,error:l,toggleFavorite:m}=O(),{tags:d,isLoading:c}=Y(),[i,g]=N.useState(""),[u,p]=N.useState(null),[s,a]=N.useState([]),o=(t||[]).filter(v=>{var q;const b=i===""||v.name.toLowerCase().includes(i.toLowerCase())||((q=v.description)==null?void 0:q.toLowerCase().includes(i.toLowerCase())),S=u===null||v.status.toLowerCase()===u.toLowerCase(),I=s.length===0||s.every(D=>v.tags.includes(D));return b&&S&&I}),h=async(v,b)=>{try{await m.mutateAsync({id:v,favorite:!b})}catch(S){console.error("Error toggling favorite:",S)}},Q=[{label:"All Statuses",value:null},{label:"Active",value:"active"},{label:"Inactive",value:"inactive"},{label:"Maintenance",value:"maintenance"},{label:"Development",value:"development"},{label:"Deprecated",value:"deprecated"},{label:"Planning",value:"planning"}];return l?e.jsx("div",{className:"container py-8",children:e.jsxs(y,{className:"border-destructive",children:[e.jsx(w,{children:e.jsx(T,{className:"text-destructive",children:"Error Loading Servers"})}),e.jsxs(j,{children:[e.jsx("p",{children:"There was an error loading the servers. Please try again later."}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:l.message})]}),e.jsx(F,{children:e.jsx(C,{onClick:()=>window.location.reload(),children:"Retry"})})]})}):e.jsxs("div",{className:"container py-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Servers"}),e.jsxs(C,{onClick:()=>r("/servers/new"),children:[e.jsx(k,{className:"mr-2 h-4 w-4"}),"New Server"]})]}),e.jsx(z,{searchValue:i,onSearchValueChange:g,statusOptions:Q,selectedStatus:u,onStatusChange:p,tags:d,selectedTags:s,onTagsChange:a}),e.jsx(G,{servers:t||[],filteredServers:o,isLoading:n||c,toggleFavorite:h,tags:d,searchValue:i,selectedStatus:u,selectedTags:s})]})}export{ye as default};
//# sourceMappingURL=ServersPage-Cu2k-xMa.js.map

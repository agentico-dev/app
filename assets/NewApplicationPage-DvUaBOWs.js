import{r as w,n as F,q as N,j as e,L as v}from"./react-vendor-vQbJYzIl.js";import{B as g}from"./button-BuS9drMY.js";import{C as S,a as z,b as I,c as D,d as k}from"./card-ChR_bl_w.js";import{I as y}from"./input-XSgfOhYa.js";import{T as E}from"./textarea-BcJ2PB4q.js";import{F as L,a as p,b as d,c as m,d as u,e as x,f as h}from"./form-DIouIyc2.js";import{u as T,d as c,s as C}from"./index-CF5hanbC.js";import{A as $}from"./arrow-left-DkholcDv.js";import"./ui-components-CaI0lto7.js";import"./label-tTPk6JAI.js";import"./supabase-uFuX7l-a.js";import"./utils-CP2dCvBX.js";import"./react-query-triPzI4C.js";function B(i){let r=i.toLowerCase();return r=r.replace(/\s+/g,"-"),r=r.replace(/[^a-z0-9-]/g,""),/^[a-z]/.test(r)||(r="a-"+r),/[a-z0-9]$/.test(r)||(r=r+"0"),r=r.slice(0,63),r}function q(){const[i,r]=w.useState(!1),o=F(),{session:n}=T(),t=N({defaultValues:{name:"",description:"",category:"Web",status:"Development",tags:[]}}),A=async a=>{if(!(n!=null&&n.user)){c.error("You need to be logged in to create an application");return}r(!0);try{const s=localStorage.getItem("selectedOrganizationId");if(!s){c.error("Please select an organization from the top navigation bar"),r(!1);return}const j=B(a.name),{data:f,error:l}=await C.from("applications").insert({name:a.name,slug:j,description:a.description,category:a.category,status:a.status,tags:a.tags,user_id:n.user.id,organization_id:s}).select().single();if(l)throw console.error("Error creating application:",l),l;if(c.success("Application created successfully"),f){const{data:b}=await C.from("organizations").select("slug").eq("id",s).single();o(b?`/apps/${b.slug}@${j}`:`/apps/${f.id}`)}else o("/applications")}catch(s){console.error("Error creating application:",s),c.error(`Failed to create application: ${s.message||"Unknown error"}`)}finally{r(!1)}};return e.jsx(L,{...t,children:e.jsxs("form",{onSubmit:t.handleSubmit(A),className:"space-y-6",children:[e.jsx(p,{control:t.control,name:"name",render:({field:a})=>e.jsxs(d,{children:[e.jsx(m,{children:"Application Name"}),e.jsx(u,{children:e.jsx(y,{placeholder:"Enter application name",...a})}),e.jsx(x,{children:"The name of your application."}),e.jsx(h,{})]})}),e.jsx(p,{control:t.control,name:"description",render:({field:a})=>e.jsxs(d,{children:[e.jsx(m,{children:"Description"}),e.jsx(u,{children:e.jsx(E,{placeholder:"Describe your application",className:"min-h-[120px]",...a})}),e.jsx(x,{children:"A brief description of what this application does."}),e.jsx(h,{})]})}),e.jsx(p,{control:t.control,name:"category",render:({field:a})=>e.jsxs(d,{children:[e.jsx(m,{children:"Category"}),e.jsx(u,{children:e.jsx(y,{placeholder:"e.g., Web, Mobile, Desktop",...a})}),e.jsx(x,{children:"The category this application belongs to."}),e.jsx(h,{})]})}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx(g,{type:"button",variant:"outline",onClick:()=>o("/applications"),children:"Cancel"}),e.jsx(g,{type:"submit",disabled:i,children:i?"Creating...":"Create Application"})]})]})})}function Q(){return e.jsxs("div",{className:"container py-6 space-y-6",children:[e.jsx(g,{variant:"ghost",asChild:!0,children:e.jsxs(v,{to:"/applications",children:[e.jsx($,{className:"mr-2 h-4 w-4"})," Back to Applications"]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Create New Application"}),e.jsx("p",{className:"text-muted-foreground",children:"Set up a new application in your AI ecosystem"})]}),e.jsxs(S,{children:[e.jsxs(z,{children:[e.jsx(I,{children:"Application Details"}),e.jsx(D,{children:"Fill in the details to create your new application"})]}),e.jsx(k,{children:e.jsx(q,{})})]})]})}export{Q as default};

import{o as L,r as B,w as O,j as e,O as S}from"./react-vendor-TyuC8qxg.js";import{u as R,s as M,k as V,g as i}from"./index-D5uhiMQB.js";import{C as c,a as o,b as d,d as m,c as j}from"./card-DAAmTFtc.js";import{A as Y,b as z,a as H}from"./avatar-BaIhr9EP.js";import{B as u}from"./button-CrjcO5GY.js";import{I as h}from"./input-DR-AxXjG.js";import{L as p}from"./label-ppAVubx0.js";import{T as J,a as Z,b as f,c as b}from"./tabs-CrlmdC9I.js";import{A as $,a as q}from"./alert-CHHnXdcp.js";import{u as G,P as K}from"./usePlans-CZ0bocCl.js";import{S as Q}from"./separator-Be9YcOHX.js";import{C as W}from"./circle-alert-BjO_ybi6.js";import{T as X}from"./trash-2-BPjaXdHG.js";import"./supabase-DLYUZSEu.js";import"./ui-components-CAmpQbeX.js";import"./utils-DVqAV-fM.js";import"./radio-group-BcLi_fAC.js";import"./circle-C2I3inlC.js";import"./check-CG9NCPd3.js";try{let t=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},a=new t.Error().stack;a&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[a]="c0db0961-03fa-44ed-9659-4324eeafb699",t._sentryDebugIdIdentifier="sentry-dbid-c0db0961-03fa-44ed-9659-4324eeafb699")}catch{}const ve=()=>{var v,N,_,w;const t=L(),{user:a,profile:s,loading:P}=R(),[g,y]=B.useState(!1),{plans:A,currentPlan:x,updatePlan:T,cancelSubscription:D}=G(),{register:n,handleSubmit:F,formState:{errors:ee}}=O({defaultValues:{full_name:(s==null?void 0:s.full_name)||((v=a==null?void 0:a.user_metadata)==null?void 0:v.full_name)||"",job_title:(s==null?void 0:s.job_title)||"",company:(s==null?void 0:s.company)||"",bio:(s==null?void 0:s.bio)||""}}),I=async r=>{if(a){y(!0);try{const{error:l}=await M.auth.updateUser({data:{full_name:r.full_name}});if(l)throw l;const{error:C}=await V("profiles").upsert({id:a.id,full_name:r.full_name,job_title:r.job_title,company:r.company,bio:r.bio,updated_at:new Date().toISOString()});if(C)throw C;i.success("Profile updated successfully")}catch(l){console.error("Error updating profile:",l),i.error(`Failed to update profile: ${l.message||"Unknown error"}`)}finally{y(!1)}}};if(t.pathname!=="/profile"&&t.pathname!=="/settings")return e.jsx(S,{});if(P)return e.jsx("div",{className:"flex items-center justify-center p-8",children:"Loading profile..."});if(!a)return e.jsx(c,{className:"max-w-md mx-auto my-8",children:e.jsxs(o,{children:[e.jsx(d,{children:"Profile Not Available"}),e.jsx(m,{children:"You need to be logged in to view your profile."})]})});const E=((s==null?void 0:s.full_name)||((N=a.user_metadata)==null?void 0:N.full_name)||a.email||"").split(" ").map(r=>r[0]).join("").toUpperCase(),U=async r=>{try{await T.mutateAsync(r),i.success("Plan updated",{description:"Your subscription plan has been updated successfully."})}catch(l){i.error("Error updating plan",{description:l.message||"Failed to update your plan."})}},k=()=>{D.mutate()};return e.jsxs("div",{className:"container mx-auto py-8",children:[e.jsxs(J,{defaultValue:"profile",className:"w-full max-w-4xl mx-auto",children:[e.jsxs(Z,{className:"grid w-full grid-cols-3",children:[e.jsx(f,{value:"profile",children:"Profile"}),e.jsx(f,{value:"settings",children:"Account Settings"}),e.jsx(f,{value:"plan",children:"Subscription"})]}),e.jsx(b,{value:"profile",children:e.jsxs(c,{children:[e.jsx(o,{children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(Y,{className:"h-16 w-16",children:[e.jsx(z,{src:(_=a.user_metadata)==null?void 0:_.avatar_url}),e.jsx(H,{children:E})]}),e.jsxs("div",{children:[e.jsx(d,{children:(s==null?void 0:s.full_name)||((w=a.user_metadata)==null?void 0:w.full_name)||a.email}),e.jsx(m,{children:a.email})]})]})}),e.jsx(j,{children:e.jsxs("form",{onSubmit:F(I),className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"full_name",children:"Full Name"}),e.jsx(h,{id:"full_name",...n("full_name")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"job_title",children:"Job Title"}),e.jsx(h,{id:"job_title",...n("job_title")})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"company",children:"Company"}),e.jsx(h,{id:"company",...n("company")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"bio",children:"Bio"}),e.jsx(h,{id:"bio",...n("bio")})]})]}),e.jsx(u,{type:"submit",disabled:g,children:g?"Saving...":"Save Changes"})]})})]})}),e.jsx(b,{value:"settings",children:e.jsxs(c,{children:[e.jsxs(o,{children:[e.jsx(d,{children:"Account Settings"}),e.jsx(m,{children:"Manage your account settings and preferences."})]}),e.jsx(j,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium",children:"Email"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.email})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium",children:"Change Password"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Update your password to improve account security."}),e.jsx(u,{variant:"outline",children:"Change Password"})]}),e.jsxs("div",{className:"border-t pt-6",children:[e.jsx("h3",{className:"text-lg font-medium text-destructive",children:"Danger Zone"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Delete your account and all associated data."}),e.jsx(u,{variant:"destructive",children:"Delete Account"})]})]})})]})}),e.jsx(b,{value:"plan",children:e.jsxs(c,{children:[e.jsxs(o,{children:[e.jsx(d,{children:"Subscription Plan"}),e.jsx(m,{children:"Manage your subscription and billing."})]}),e.jsxs(j,{className:"space-y-6",children:[e.jsxs($,{children:[e.jsx(W,{className:"h-4 w-4"}),e.jsx(q,{children:"During the beta period, all plans are free. Choose the plan that best suits your needs."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-medium",children:["Current Plan: ",e.jsx("span",{className:"text-primary capitalize",children:(x==null?void 0:x.name)||"Free"})]}),e.jsx("p",{className:"text-muted-foreground",children:"Select a plan to change your subscription:"}),e.jsx(K,{plans:A,selectedPlan:(s==null?void 0:s.plan_id)||"free",onSelectPlan:U})]}),e.jsx(Q,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-lg font-medium text-destructive",children:"Cancel Subscription"}),e.jsx("p",{className:"text-muted-foreground",children:"Cancel your subscription and downgrade to the Free plan."}),e.jsxs(u,{variant:"outline",className:"mt-2",onClick:k,disabled:(s==null?void 0:s.plan_id)==="free"||!(s!=null&&s.plan_id),children:[e.jsx(X,{className:"mr-2 h-4 w-4"}),"Cancel Subscription"]})]})]})]})})]}),e.jsx(S,{})]})};export{ve as default};
//# sourceMappingURL=ProfilePage-Am_l0c16.js.map

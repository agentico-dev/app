{"version":3,"file":"MessageFormPage-C-rn8oUM.js","sources":["../../src/pages/applications/message/MessageFormPage.tsx"],"sourcesContent":["\nimport { useState, useEffect } from 'react';\nimport { useParams, useNavigate } from 'react-router';\nimport { useForm } from 'react-hook-form';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Textarea } from '@/components/ui/textarea';\nimport {\n  Form,\n  FormControl,\n  FormDescription,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from '@/components/ui/form';\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/ui/select';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { ArrowLeft } from 'lucide-react';\nimport { useApplicationMessage, useApplicationMessages } from '@/hooks/useApplicationMessages';\nimport { ApplicationMessage } from '@/types/application';\nimport { toast } from 'sonner';\n\nexport default function MessageFormPage() {\n  const { applicationId, messageId } = useParams<{ applicationId: string; messageId?: string }>();\n  const navigate = useNavigate();\n  const isNew = !messageId;\n  \n  const { data: message, isLoading: isLoadingMessage } = useApplicationMessage(messageId);\n  const { createMessage, updateMessage } = useApplicationMessages(applicationId);\n  \n  const [isSubmitting, setIsSubmitting] = useState(false);\n  \n  const form = useForm<Partial<ApplicationMessage>>({\n    defaultValues: {\n      title: '',\n      content: '',\n      message_type: 'notification',\n      status: 'unread',\n    },\n  });\n\n  useEffect(() => {\n    if (message && !isNew) {\n      form.reset({\n        title: message.title,\n        content: message.content,\n        message_type: message.message_type,\n        status: message.status,\n      });\n    }\n  }, [message, form, isNew]);\n\n  const onSubmit = async (data: Partial<ApplicationMessage>) => {\n    if (!applicationId) return;\n    \n    setIsSubmitting(true);\n    try {\n      if (isNew) {\n        await createMessage.mutateAsync({\n          ...data,\n          application_id: applicationId,\n        });\n        toast.success('Message created successfully');\n      } else if (messageId) {\n        await updateMessage.mutateAsync({\n          ...data,\n          id: messageId,\n        });\n        toast.success('Message updated successfully');\n      }\n      navigate(`/applications/${applicationId}`);\n    } catch (error) {\n      console.error('Error saving message:', error);\n      toast.error('Failed to save message');\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  return (\n    <div className=\"container py-6 space-y-6\">\n      <Button variant=\"ghost\" asChild>\n        <div onClick={() => navigate(`/applications/${applicationId}`)}>\n          <ArrowLeft className=\"mr-2 h-4 w-4\" /> Back to Application\n        </div>\n      </Button>\n      \n      <div>\n        <h1 className=\"text-3xl font-bold tracking-tight\">\n          {isNew ? 'Create New Message' : 'Edit Message'}\n        </h1>\n        <p className=\"text-muted-foreground\">\n          {isNew ? 'Create a new message for your application' : 'Update the message details'}\n        </p>\n      </div>\n      \n      <Card>\n        <CardHeader>\n          <CardTitle>Message Details</CardTitle>\n          <CardDescription>\n            Fill in the details of your message\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <Form {...form}>\n            <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6\">\n              <FormField\n                control={form.control}\n                name=\"title\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Title</FormLabel>\n                    <FormControl>\n                      <Input placeholder=\"Enter message title\" {...field} />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n              \n              <FormField\n                control={form.control}\n                name=\"content\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Content</FormLabel>\n                    <FormControl>\n                      <Textarea\n                        placeholder=\"Enter message content\"\n                        className=\"min-h-[200px]\"\n                        {...field}\n                      />\n                    </FormControl>\n                    <FormDescription>\n                      The main content of your message.\n                    </FormDescription>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n              \n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                <FormField\n                  control={form.control}\n                  name=\"message_type\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Message Type</FormLabel>\n                      <Select\n                        onValueChange={field.onChange}\n                        defaultValue={field.value}\n                      >\n                        <FormControl>\n                          <SelectTrigger>\n                            <SelectValue placeholder=\"Select a type\" />\n                          </SelectTrigger>\n                        </FormControl>\n                        <SelectContent>\n                          <SelectItem value=\"notification\">Notification</SelectItem>\n                          <SelectItem value=\"alert\">Alert</SelectItem>\n                          <SelectItem value=\"info\">Information</SelectItem>\n                        </SelectContent>\n                      </Select>\n                      <FormDescription>\n                        The type of this message.\n                      </FormDescription>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n                \n                <FormField\n                  control={form.control}\n                  name=\"status\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Status</FormLabel>\n                      <Select\n                        onValueChange={field.onChange}\n                        defaultValue={field.value}\n                      >\n                        <FormControl>\n                          <SelectTrigger>\n                            <SelectValue placeholder=\"Select a status\" />\n                          </SelectTrigger>\n                        </FormControl>\n                        <SelectContent>\n                          <SelectItem value=\"unread\">Unread</SelectItem>\n                          <SelectItem value=\"read\">Read</SelectItem>\n                        </SelectContent>\n                      </Select>\n                      <FormDescription>\n                        The read status of this message.\n                      </FormDescription>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n              \n              <div className=\"flex justify-end space-x-4\">\n                <Button\n                  type=\"button\"\n                  variant=\"outline\"\n                  onClick={() => navigate(`/applications/${applicationId}`)}\n                >\n                  Cancel\n                </Button>\n                <Button type=\"submit\" disabled={isSubmitting}>\n                  {isSubmitting\n                    ? isNew\n                      ? 'Creating...'\n                      : 'Updating...'\n                    : isNew\n                    ? 'Create Message'\n                    : 'Update Message'}\n                </Button>\n              </div>\n            </form>\n          </Form>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n"],"names":["MessageFormPage","applicationId","messageId","useParams","navigate","useNavigate","isNew","message","isLoadingMessage","useApplicationMessage","createMessage","updateMessage","useApplicationMessages","isSubmitting","setIsSubmitting","useState","form","useForm","useEffect","onSubmit","data","toast","error","jsxs","jsx","Button","ArrowLeft","Card","CardHeader","CardTitle","CardDescription","CardContent","Form","FormField","field","FormItem","FormLabel","FormControl","Input","FormMessage","Textarea","FormDescription","Select","SelectTrigger","SelectValue","SelectContent","SelectItem"],"mappings":"ylCA6BA,SAAwBA,IAAkB,CACxC,KAAM,CAAE,cAAAC,EAAe,UAAAC,CAAU,EAAIC,EAAyD,EACxFC,EAAWC,EAAY,EACvBC,EAAQ,CAACJ,EAET,CAAE,KAAMK,EAAS,UAAWC,CAAiB,EAAIC,EAAsBP,CAAS,EAChF,CAAE,cAAAQ,EAAe,cAAAC,GAAkBC,EAAuBX,CAAa,EAEvE,CAACY,EAAcC,CAAe,EAAIC,EAAAA,SAAS,EAAK,EAEhDC,EAAOC,EAAqC,CAChD,cAAe,CACb,MAAO,GACP,QAAS,GACT,aAAc,eACd,OAAQ,QAAA,CACV,CACD,EAEDC,EAAAA,UAAU,IAAM,CACVX,GAAW,CAACD,GACdU,EAAK,MAAM,CACT,MAAOT,EAAQ,MACf,QAASA,EAAQ,QACjB,aAAcA,EAAQ,aACtB,OAAQA,EAAQ,MAAA,CACjB,CAEF,EAAA,CAACA,EAASS,EAAMV,CAAK,CAAC,EAEnB,MAAAa,EAAW,MAAOC,GAAsC,CAC5D,GAAKnB,EAEL,CAAAa,EAAgB,EAAI,EAChB,GAAA,CACER,GACF,MAAMI,EAAc,YAAY,CAC9B,GAAGU,EACH,eAAgBnB,CAAA,CACjB,EACDoB,EAAM,QAAQ,8BAA8B,GACnCnB,IACT,MAAMS,EAAc,YAAY,CAC9B,GAAGS,EACH,GAAIlB,CAAA,CACL,EACDmB,EAAM,QAAQ,8BAA8B,GAErCjB,EAAA,iBAAiBH,CAAa,EAAE,QAClCqB,EAAO,CACN,QAAA,MAAM,wBAAyBA,CAAK,EAC5CD,EAAM,MAAM,wBAAwB,CAAA,QACpC,CACAP,EAAgB,EAAK,CAAA,EAEzB,EAGE,OAAAS,EAAA,KAAC,MAAI,CAAA,UAAU,2BACb,SAAA,CAAAC,EAAA,IAACC,EAAO,CAAA,QAAQ,QAAQ,QAAO,GAC7B,SAAAF,EAAA,KAAC,MAAI,CAAA,QAAS,IAAMnB,EAAS,iBAAiBH,CAAa,EAAE,EAC3D,SAAA,CAACuB,EAAAA,IAAAE,EAAA,CAAU,UAAU,cAAe,CAAA,EAAE,sBAAA,CAAA,CACxC,CACF,CAAA,SAEC,MACC,CAAA,SAAA,CAAAF,MAAC,KAAG,CAAA,UAAU,oCACX,SAAAlB,EAAQ,qBAAuB,eAClC,QACC,IAAE,CAAA,UAAU,wBACV,SAAAA,EAAQ,4CAA8C,4BACzD,CAAA,CAAA,EACF,SAECqB,EACC,CAAA,SAAA,CAAAJ,OAACK,EACC,CAAA,SAAA,CAAAJ,EAAAA,IAACK,GAAU,SAAe,iBAAA,CAAA,EAC1BL,EAAAA,IAACM,GAAgB,SAEjB,qCAAA,CAAA,CAAA,EACF,EACCN,MAAAO,EAAA,CACC,SAACP,EAAAA,IAAAQ,EAAA,CAAM,GAAGhB,EACR,SAAAO,EAAAA,KAAC,OAAK,CAAA,SAAUP,EAAK,aAAaG,CAAQ,EAAG,UAAU,YACrD,SAAA,CAAAK,EAAA,IAACS,EAAA,CACC,QAASjB,EAAK,QACd,KAAK,QACL,OAAQ,CAAC,CAAE,MAAAkB,CAAM,WACdC,EACC,CAAA,SAAA,CAAAX,EAAAA,IAACY,GAAU,SAAK,OAAA,CAAA,EAChBZ,EAAAA,IAACa,GACC,SAACb,MAAAc,EAAA,CAAM,YAAY,sBAAuB,GAAGJ,EAAO,CACtD,CAAA,QACCK,EAAY,CAAA,CAAA,CAAA,CACf,CAAA,CAAA,CAEJ,EAEAf,EAAA,IAACS,EAAA,CACC,QAASjB,EAAK,QACd,KAAK,UACL,OAAQ,CAAC,CAAE,MAAAkB,CAAM,WACdC,EACC,CAAA,SAAA,CAAAX,EAAAA,IAACY,GAAU,SAAO,SAAA,CAAA,QACjBC,EACC,CAAA,SAAAb,EAAA,IAACgB,EAAA,CACC,YAAY,wBACZ,UAAU,gBACT,GAAGN,CAAA,CAAA,EAER,EACAV,EAAAA,IAACiB,GAAgB,SAEjB,mCAAA,CAAA,QACCF,EAAY,CAAA,CAAA,CAAA,CACf,CAAA,CAAA,CAEJ,EAEAhB,EAAAA,KAAC,MAAI,CAAA,UAAU,wCACb,SAAA,CAAAC,EAAA,IAACS,EAAA,CACC,QAASjB,EAAK,QACd,KAAK,eACL,OAAQ,CAAC,CAAE,MAAAkB,CAAM,WACdC,EACC,CAAA,SAAA,CAAAX,EAAAA,IAACY,GAAU,SAAY,cAAA,CAAA,EACvBb,EAAA,KAACmB,EAAA,CACC,cAAeR,EAAM,SACrB,aAAcA,EAAM,MAEpB,SAAA,CAACV,EAAAA,IAAAa,EAAA,CACC,eAACM,EACC,CAAA,SAAAnB,EAAAA,IAACoB,GAAY,YAAY,eAAA,CAAgB,EAC3C,CACF,CAAA,SACCC,EACC,CAAA,SAAA,CAACrB,EAAA,IAAAsB,EAAA,CAAW,MAAM,eAAe,SAAY,eAAA,EAC5CtB,EAAA,IAAAsB,EAAA,CAAW,MAAM,QAAQ,SAAK,QAAA,EAC9BtB,EAAA,IAAAsB,EAAA,CAAW,MAAM,OAAO,SAAW,aAAA,CAAA,CAAA,CACtC,CAAA,CAAA,CAAA,CACF,EACAtB,EAAAA,IAACiB,GAAgB,SAEjB,2BAAA,CAAA,QACCF,EAAY,CAAA,CAAA,CAAA,CACf,CAAA,CAAA,CAEJ,EAEAf,EAAA,IAACS,EAAA,CACC,QAASjB,EAAK,QACd,KAAK,SACL,OAAQ,CAAC,CAAE,MAAAkB,CAAM,WACdC,EACC,CAAA,SAAA,CAAAX,EAAAA,IAACY,GAAU,SAAM,QAAA,CAAA,EACjBb,EAAA,KAACmB,EAAA,CACC,cAAeR,EAAM,SACrB,aAAcA,EAAM,MAEpB,SAAA,CAACV,EAAAA,IAAAa,EAAA,CACC,eAACM,EACC,CAAA,SAAAnB,EAAAA,IAACoB,GAAY,YAAY,iBAAA,CAAkB,EAC7C,CACF,CAAA,SACCC,EACC,CAAA,SAAA,CAACrB,EAAA,IAAAsB,EAAA,CAAW,MAAM,SAAS,SAAM,SAAA,EAChCtB,EAAA,IAAAsB,EAAA,CAAW,MAAM,OAAO,SAAI,MAAA,CAAA,CAAA,CAC/B,CAAA,CAAA,CAAA,CACF,EACAtB,EAAAA,IAACiB,GAAgB,SAEjB,kCAAA,CAAA,QACCF,EAAY,CAAA,CAAA,CAAA,CACf,CAAA,CAAA,CAAA,CAEJ,EACF,EAEAhB,EAAAA,KAAC,MAAI,CAAA,UAAU,6BACb,SAAA,CAAAC,EAAA,IAACC,EAAA,CACC,KAAK,SACL,QAAQ,UACR,QAAS,IAAMrB,EAAS,iBAAiBH,CAAa,EAAE,EACzD,SAAA,QAAA,CAED,EACCuB,EAAA,IAAAC,EAAA,CAAO,KAAK,SAAS,SAAUZ,EAC7B,SACGA,EAAAP,EACE,cACA,cACFA,EACA,iBACA,gBACN,CAAA,CAAA,CACF,CAAA,CAAA,CACF,CAAA,CACF,CAAA,CACF,CAAA,CAAA,CACF,CAAA,CAAA,EACF,CAEJ"}
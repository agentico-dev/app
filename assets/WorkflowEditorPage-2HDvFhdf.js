import{r as v,A as au,D as cu,R as br,j as p,m as lu,t as uu}from"./react-vendor-TyuC8qxg.js";import{c as rt,g as ye,a as Ve,X as du,u as fu}from"./index-D5uhiMQB.js";import{D as li,b as ui,c as di,d as fi,e as hi,f as pi}from"./dialog-uiTA_umQ.js";import{B as ce}from"./button-CrjcO5GY.js";import{L as ct}from"./label-ppAVubx0.js";import{T as vr}from"./textarea-CzliNkd6.js";import{A as Jr}from"./app-window-BtmSL7uK.js";import{W as Qr}from"./wrench-KjQ0gjjb.js";import{B as eo}from"./brain-DMjsiMZP.js";import{C as hu,a as pu,b as gu}from"./collapsible-FhUTsrjs.js";import{I as Er}from"./input-DR-AxXjG.js";import{A as mu}from"./arrow-left-B-jkszN4.js";import{C as gi}from"./code-CWvNPmcu.js";import{S as yu}from"./save-CAbDiou2.js";import{S as mi}from"./settings-0ZFxNfWk.js";import{C as xu}from"./chevron-up-DyG2CS1O.js";import{C as wu}from"./chevron-down-Bdv2PV_A.js";import{D as _u,C as bu}from"./download-DFkLn-Kj.js";import{T as yi}from"./trash-2-BPjaXdHG.js";import{ak as vu,al as Eu,am as Nu,an as xi,ao as wi,ap as _i,aq as bi,ar as vi,as as Ei,at as Ni,au as Si,av as Ci}from"./ui-components-CAmpQbeX.js";import{C as Su}from"./chevron-right-CBt-y2ls.js";import{C as Cu}from"./check-CG9NCPd3.js";import{C as ku}from"./circle-C2I3inlC.js";import{F as ki}from"./file-text-swfOyMSZ.js";import{B as Ii}from"./badge-bpxx3q91.js";import"./supabase-DLYUZSEu.js";import"./utils-DVqAV-fM.js";try{let e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},t=new e.Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="033baf5c-b50f-4caa-95e3-72c2b16f411a",e._sentryDebugIdIdentifier="sentry-dbid-033baf5c-b50f-4caa-95e3-72c2b16f411a")}catch{}/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iu=rt("CloudUpload",[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const to=rt("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const no=rt("FileInput",[["path",{d:"M4 22h14a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v4",key:"1pf5j1"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M2 15h10",key:"jfw4w8"}],["path",{d:"m9 18 3-3-3-3",key:"112psh"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ro=rt("FileOutput",[["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M4 7V4a2 2 0 0 1 2-2 2 2 0 0 0-2 2",key:"1vk7w2"}],["path",{d:"M4.063 20.999a2 2 0 0 0 2 1L18 22a2 2 0 0 0 2-2V7l-5-5H6",key:"1jink5"}],["path",{d:"m5 11-3 3",key:"1dgrs4"}],["path",{d:"m5 17-3-3h10",key:"1mvvaf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oo=rt("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const so=rt("ListTodo",[["rect",{x:"3",y:"5",width:"6",height:"6",rx:"1",key:"1defrl"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tu=rt("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]),Ti=Object.prototype.toString;function io(e){switch(Ti.call(e)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return Qe(e,Error)}}function Et(e,t){return Ti.call(e)===`[object ${t}]`}function ao(e){return Et(e,"ErrorEvent")}function Lo(e){return Et(e,"DOMError")}function Mu(e){return Et(e,"DOMException")}function Me(e){return Et(e,"String")}function Mi(e){return typeof e=="object"&&e!==null&&"__sentry_template_string__"in e&&"__sentry_template_values__"in e}function $i(e){return e===null||Mi(e)||typeof e!="object"&&typeof e!="function"}function Hn(e){return Et(e,"Object")}function Fn(e){return typeof Event<"u"&&Qe(e,Event)}function $u(e){return typeof Element<"u"&&Qe(e,Element)}function Au(e){return Et(e,"RegExp")}function co(e){return!!(e&&e.then&&typeof e.then=="function")}function Du(e){return Hn(e)&&"nativeEvent"in e&&"preventDefault"in e&&"stopPropagation"in e}function ju(e){return typeof e=="number"&&e!==e}function Qe(e,t){try{return e instanceof t}catch{return!1}}function Ai(e){return!!(typeof e=="object"&&e!==null&&(e.__isVue||e._isVue))}function Nr(e,t=0){return typeof e!="string"||t===0||e.length<=t?e:`${e.slice(0,t)}...`}function Ho(e,t){if(!Array.isArray(e))return"";const n=[];for(let r=0;r<e.length;r++){const o=e[r];try{Ai(o)?n.push("[VueViewModel]"):n.push(String(o))}catch{n.push("[value cannot be serialized]")}}return n.join(t)}function Ru(e,t,n=!1){return Me(e)?Au(t)?t.test(e):Me(t)?n?e===t:e.includes(t):!1:!1}function zn(e,t=[],n=!1){return t.some(r=>Ru(e,r,n))}function Pu(e,t,n=250,r,o,s,i){if(!s.exception||!s.exception.values||!i||!Qe(i.originalException,Error))return;const a=s.exception.values.length>0?s.exception.values[s.exception.values.length-1]:void 0;a&&(s.exception.values=Ou(Sr(e,t,o,i.originalException,r,s.exception.values,a,0),n))}function Sr(e,t,n,r,o,s,i,a){if(s.length>=n+1)return s;let c=[...s];if(Qe(r[o],Error)){Fo(i,a);const l=e(t,r[o]),d=c.length;zo(l,o,d,a),c=Sr(e,t,n,r[o],o,[l,...c],l,d)}return Array.isArray(r.errors)&&r.errors.forEach((l,d)=>{if(Qe(l,Error)){Fo(i,a);const f=e(t,l),u=c.length;zo(f,`errors[${d}]`,u,a),c=Sr(e,t,n,l,o,[f,...c],f,u)}}),c}function Fo(e,t){e.mechanism=e.mechanism||{type:"generic",handled:!0},e.mechanism={...e.mechanism,...e.type==="AggregateError"&&{is_exception_group:!0},exception_id:t}}function zo(e,t,n,r){e.mechanism=e.mechanism||{type:"generic",handled:!0},e.mechanism={...e.mechanism,type:"chained",source:t,exception_id:n,parent_id:r}}function Ou(e,t){return e.map(n=>(n.value&&(n.value=Nr(n.value,t)),n))}function rn(e){return e&&e.Math==Math?e:void 0}const te=typeof globalThis=="object"&&rn(globalThis)||typeof window=="object"&&rn(window)||typeof self=="object"&&rn(self)||typeof global=="object"&&rn(global)||function(){return this}()||{};function lo(){return te}function Di(e,t,n){const r=n||te,o=r.__SENTRY__=r.__SENTRY__||{};return o[e]||(o[e]=t())}const uo=lo(),Lu=80;function ji(e,t={}){if(!e)return"<unknown>";try{let n=e;const r=5,o=[];let s=0,i=0;const a=" > ",c=a.length;let l;const d=Array.isArray(t)?t:t.keyAttrs,f=!Array.isArray(t)&&t.maxStringLength||Lu;for(;n&&s++<r&&(l=Hu(n,d),!(l==="html"||s>1&&i+o.length*c+l.length>=f));)o.push(l),i+=l.length,n=n.parentNode;return o.reverse().join(a)}catch{return"<unknown>"}}function Hu(e,t){const n=e,r=[];let o,s,i,a,c;if(!n||!n.tagName)return"";if(uo.HTMLElement&&n instanceof HTMLElement&&n.dataset&&n.dataset.sentryComponent)return n.dataset.sentryComponent;r.push(n.tagName.toLowerCase());const l=t&&t.length?t.filter(f=>n.getAttribute(f)).map(f=>[f,n.getAttribute(f)]):null;if(l&&l.length)l.forEach(f=>{r.push(`[${f[0]}="${f[1]}"]`)});else if(n.id&&r.push(`#${n.id}`),o=n.className,o&&Me(o))for(s=o.split(/\s+/),c=0;c<s.length;c++)r.push(`.${s[c]}`);const d=["aria-label","type","name","title","alt"];for(c=0;c<d.length;c++)i=d[c],a=n.getAttribute(i),a&&r.push(`[${i}="${a}"]`);return r.join("")}function Fu(){try{return uo.document.location.href}catch{return""}}function zu(e){if(!uo.HTMLElement)return null;let t=e;const n=5;for(let r=0;r<n;r++){if(!t)return null;if(t instanceof HTMLElement&&t.dataset.sentryComponent)return t.dataset.sentryComponent;t=t.parentNode}return null}const qt=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,Bu="Sentry Logger ",Cr=["debug","info","warn","error","log","assert","trace"],Nn={};function fo(e){if(!("console"in te))return e();const t=te.console,n={},r=Object.keys(Nn);r.forEach(o=>{const s=Nn[o];n[o]=t[o],t[o]=s});try{return e()}finally{r.forEach(o=>{t[o]=n[o]})}}function Vu(){let e=!1;const t={enable:()=>{e=!0},disable:()=>{e=!1},isEnabled:()=>e};return qt?Cr.forEach(n=>{t[n]=(...r)=>{e&&fo(()=>{te.console[n](`${Bu}[${n}]:`,...r)})}}):Cr.forEach(n=>{t[n]=()=>{}}),t}const ee=Vu(),Wu=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function Yu(e){return e==="http"||e==="https"}function Uu(e,t=!1){const{host:n,path:r,pass:o,port:s,projectId:i,protocol:a,publicKey:c}=e;return`${a}://${c}${t&&o?`:${o}`:""}@${n}${s?`:${s}`:""}/${r&&`${r}/`}${i}`}function Xu(e){const t=Wu.exec(e);if(!t){fo(()=>{console.error(`Invalid Sentry Dsn: ${e}`)});return}const[n,r,o="",s,i="",a]=t.slice(1);let c="",l=a;const d=l.split("/");if(d.length>1&&(c=d.slice(0,-1).join("/"),l=d.pop()),l){const f=l.match(/^\d+/);f&&(l=f[0])}return Ri({host:s,pass:o,path:c,projectId:l,port:i,protocol:n,publicKey:r})}function Ri(e){return{protocol:e.protocol,publicKey:e.publicKey||"",pass:e.pass||"",host:e.host,port:e.port||"",path:e.path||"",projectId:e.projectId}}function Gu(e){if(!qt)return!0;const{port:t,projectId:n,protocol:r}=e;return["protocol","publicKey","host","projectId"].find(i=>e[i]?!1:(ee.error(`Invalid Sentry Dsn: ${i} missing`),!0))?!1:n.match(/^\d+$/)?Yu(r)?t&&isNaN(parseInt(t,10))?(ee.error(`Invalid Sentry Dsn: Invalid port ${t}`),!1):!0:(ee.error(`Invalid Sentry Dsn: Invalid protocol ${r}`),!1):(ee.error(`Invalid Sentry Dsn: Invalid projectId ${n}`),!1)}function qu(e){const t=typeof e=="string"?Xu(e):Ri(e);if(!(!t||!Gu(t)))return t}function le(e,t,n){if(!(t in e))return;const r=e[t],o=n(r);typeof o=="function"&&Pi(o,r),e[t]=o}function Sn(e,t,n){try{Object.defineProperty(e,t,{value:n,writable:!0,configurable:!0})}catch{qt&&ee.log(`Failed to add non-enumerable property "${t}" to object`,e)}}function Pi(e,t){try{const n=t.prototype||{};e.prototype=t.prototype=n,Sn(e,"__sentry_original__",t)}catch{}}function ho(e){return e.__sentry_original__}function Oi(e){if(io(e))return{message:e.message,name:e.name,stack:e.stack,...Vo(e)};if(Fn(e)){const t={type:e.type,target:Bo(e.target),currentTarget:Bo(e.currentTarget),...Vo(e)};return typeof CustomEvent<"u"&&Qe(e,CustomEvent)&&(t.detail=e.detail),t}else return e}function Bo(e){try{return $u(e)?ji(e):Object.prototype.toString.call(e)}catch{return"<unknown>"}}function Vo(e){if(typeof e=="object"&&e!==null){const t={};for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}else return{}}function Ku(e,t=40){const n=Object.keys(Oi(e));if(n.sort(),!n.length)return"[object has no keys]";if(n[0].length>=t)return Nr(n[0],t);for(let r=n.length;r>0;r--){const o=n.slice(0,r).join(", ");if(!(o.length>t))return r===n.length?o:Nr(o,t)}return""}function Ge(e){return kr(e,new Map)}function kr(e,t){if(Zu(e)){const n=t.get(e);if(n!==void 0)return n;const r={};t.set(e,r);for(const o of Object.keys(e))typeof e[o]<"u"&&(r[o]=kr(e[o],t));return r}if(Array.isArray(e)){const n=t.get(e);if(n!==void 0)return n;const r=[];return t.set(e,r),e.forEach(o=>{r.push(kr(o,t))}),r}return e}function Zu(e){if(!Hn(e))return!1;try{const t=Object.getPrototypeOf(e).constructor.name;return!t||t==="Object"}catch{return!0}}const lr="<anonymous>";function Be(e){try{return!e||typeof e!="function"?lr:e.name||lr}catch{return lr}}const wn={},Wo={};function ot(e,t){wn[e]=wn[e]||[],wn[e].push(t)}function st(e,t){Wo[e]||(t(),Wo[e]=!0)}function be(e,t){const n=e&&wn[e];if(n)for(const r of n)try{r(t)}catch(o){qt&&ee.error(`Error while triggering instrumentation handler.
Type: ${e}
Name: ${Be(r)}
Error:`,o)}}function Ju(e){const t="console";ot(t,e),st(t,Qu)}function Qu(){"console"in te&&Cr.forEach(function(e){e in te.console&&le(te.console,e,function(t){return Nn[e]=t,function(...n){be("console",{args:n,level:e});const o=Nn[e];o&&o.apply(te.console,n)}})})}function ve(){const e=te,t=e.crypto||e.msCrypto;let n=()=>Math.random()*16;try{if(t&&t.randomUUID)return t.randomUUID().replace(/-/g,"");t&&t.getRandomValues&&(n=()=>{const r=new Uint8Array(1);return t.getRandomValues(r),r[0]})}catch{}return("10000000100040008000"+1e11).replace(/[018]/g,r=>(r^(n()&15)>>r/4).toString(16))}function Li(e){return e.exception&&e.exception.values?e.exception.values[0]:void 0}function He(e){const{message:t,event_id:n}=e;if(t)return t;const r=Li(e);return r?r.type&&r.value?`${r.type}: ${r.value}`:r.type||r.value||n||"<unknown>":n||"<unknown>"}function Ir(e,t,n){const r=e.exception=e.exception||{},o=r.values=r.values||[],s=o[0]=o[0]||{};s.value||(s.value=t||""),s.type||(s.type="Error")}function Tr(e,t){const n=Li(e);if(!n)return;const r={type:"generic",handled:!0},o=n.mechanism;if(n.mechanism={...r,...o,...t},t&&"data"in t){const s={...o&&o.data,...t.data};n.mechanism.data=s}}function ed(e){return Array.isArray(e)?e:[e]}const lt=te,td=1e3;let Yo,Mr,$r;function nd(e){const t="dom";ot(t,e),st(t,rd)}function rd(){if(!lt.document)return;const e=be.bind(null,"dom"),t=Uo(e,!0);lt.document.addEventListener("click",t,!1),lt.document.addEventListener("keypress",t,!1),["EventTarget","Node"].forEach(n=>{const r=lt[n]&&lt[n].prototype;!r||!r.hasOwnProperty||!r.hasOwnProperty("addEventListener")||(le(r,"addEventListener",function(o){return function(s,i,a){if(s==="click"||s=="keypress")try{const c=this,l=c.__sentry_instrumentation_handlers__=c.__sentry_instrumentation_handlers__||{},d=l[s]=l[s]||{refCount:0};if(!d.handler){const f=Uo(e);d.handler=f,o.call(this,s,f,a)}d.refCount++}catch{}return o.call(this,s,i,a)}}),le(r,"removeEventListener",function(o){return function(s,i,a){if(s==="click"||s=="keypress")try{const c=this,l=c.__sentry_instrumentation_handlers__||{},d=l[s];d&&(d.refCount--,d.refCount<=0&&(o.call(this,s,d.handler,a),d.handler=void 0,delete l[s]),Object.keys(l).length===0&&delete c.__sentry_instrumentation_handlers__)}catch{}return o.call(this,s,i,a)}}))})}function od(e){if(e.type!==Mr)return!1;try{if(!e.target||e.target._sentryId!==$r)return!1}catch{}return!0}function sd(e,t){return e!=="keypress"?!1:!t||!t.tagName?!0:!(t.tagName==="INPUT"||t.tagName==="TEXTAREA"||t.isContentEditable)}function Uo(e,t=!1){return n=>{if(!n||n._sentryCaptured)return;const r=id(n);if(sd(n.type,r))return;Sn(n,"_sentryCaptured",!0),r&&!r._sentryId&&Sn(r,"_sentryId",ve());const o=n.type==="keypress"?"input":n.type;od(n)||(e({event:n,name:o,global:t}),Mr=n.type,$r=r?r._sentryId:void 0),clearTimeout(Yo),Yo=lt.setTimeout(()=>{$r=void 0,Mr=void 0},td)}}function id(e){try{return e.target}catch{return null}}const Ar=lo();function ad(){if(!("fetch"in Ar))return!1;try{return new Headers,new Request("http://www.example.com"),new Response,!0}catch{return!1}}function Xo(e){return e&&/^function fetch\(\)\s+\{\s+\[native code\]\s+\}$/.test(e.toString())}function cd(){if(typeof EdgeRuntime=="string")return!0;if(!ad())return!1;if(Xo(Ar.fetch))return!0;let e=!1;const t=Ar.document;if(t&&typeof t.createElement=="function")try{const n=t.createElement("iframe");n.hidden=!0,t.head.appendChild(n),n.contentWindow&&n.contentWindow.fetch&&(e=Xo(n.contentWindow.fetch)),t.head.removeChild(n)}catch(n){qt&&ee.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",n)}return e}function ld(e){const t="fetch";ot(t,e),st(t,ud)}function ud(){cd()&&le(te,"fetch",function(e){return function(...t){const{method:n,url:r}=dd(t),o={args:t,fetchData:{method:n,url:r},startTimestamp:Date.now()};return be("fetch",{...o}),e.apply(te,t).then(s=>{const i={...o,endTimestamp:Date.now(),response:s};return be("fetch",i),s},s=>{const i={...o,endTimestamp:Date.now(),error:s};throw be("fetch",i),s})}})}function Dr(e,t){return!!e&&typeof e=="object"&&!!e[t]}function Go(e){return typeof e=="string"?e:e?Dr(e,"url")?e.url:e.toString?e.toString():"":""}function dd(e){if(e.length===0)return{method:"GET",url:""};if(e.length===2){const[n,r]=e;return{url:Go(n),method:Dr(r,"method")?String(r.method).toUpperCase():"GET"}}const t=e[0];return{url:Go(t),method:Dr(t,"method")?String(t.method).toUpperCase():"GET"}}let on=null;function fd(e){const t="error";ot(t,e),st(t,hd)}function hd(){on=te.onerror,te.onerror=function(e,t,n,r,o){return be("error",{column:r,error:o,line:n,msg:e,url:t}),on&&!on.__SENTRY_LOADER__?on.apply(this,arguments):!1},te.onerror.__SENTRY_INSTRUMENTED__=!0}let sn=null;function pd(e){const t="unhandledrejection";ot(t,e),st(t,gd)}function gd(){sn=te.onunhandledrejection,te.onunhandledrejection=function(e){return be("unhandledrejection",e),sn&&!sn.__SENTRY_LOADER__?sn.apply(this,arguments):!0},te.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0}const an=lo();function md(){const e=an.chrome,t=e&&e.app&&e.app.runtime,n="history"in an&&!!an.history.pushState&&!!an.history.replaceState;return!t&&n}const Tt=te;let cn;function yd(e){const t="history";ot(t,e),st(t,xd)}function xd(){if(!md())return;const e=Tt.onpopstate;Tt.onpopstate=function(...n){const r=Tt.location.href,o=cn;if(cn=r,be("history",{from:o,to:r}),e)try{return e.apply(this,n)}catch{}};function t(n){return function(...r){const o=r.length>2?r[2]:void 0;if(o){const s=cn,i=String(o);cn=i,be("history",{from:s,to:i})}return n.apply(this,r)}}le(Tt.history,"pushState",t),le(Tt.history,"replaceState",t)}const wd=te,Dt="__sentry_xhr_v3__";function _d(e){const t="xhr";ot(t,e),st(t,bd)}function bd(){if(!wd.XMLHttpRequest)return;const e=XMLHttpRequest.prototype;le(e,"open",function(t){return function(...n){const r=Date.now(),o=Me(n[0])?n[0].toUpperCase():void 0,s=vd(n[1]);if(!o||!s)return t.apply(this,n);this[Dt]={method:o,url:s,request_headers:{}},o==="POST"&&s.match(/sentry_key/)&&(this.__sentry_own_request__=!0);const i=()=>{const a=this[Dt];if(a&&this.readyState===4){try{a.status_code=this.status}catch{}const c={args:[o,s],endTimestamp:Date.now(),startTimestamp:r,xhr:this};be("xhr",c)}};return"onreadystatechange"in this&&typeof this.onreadystatechange=="function"?le(this,"onreadystatechange",function(a){return function(...c){return i(),a.apply(this,c)}}):this.addEventListener("readystatechange",i),le(this,"setRequestHeader",function(a){return function(...c){const[l,d]=c,f=this[Dt];return f&&Me(l)&&Me(d)&&(f.request_headers[l.toLowerCase()]=d),a.apply(this,c)}}),t.apply(this,n)}}),le(e,"send",function(t){return function(...n){const r=this[Dt];if(!r)return t.apply(this,n);n[0]!==void 0&&(r.body=n[0]);const o={args:[r.method,r.url],startTimestamp:Date.now(),xhr:this};return be("xhr",o),t.apply(this,n)}})}function vd(e){if(Me(e))return e;try{return e.toString()}catch{}}function Ed(){const e=typeof WeakSet=="function",t=e?new WeakSet:[];function n(o){if(e)return t.has(o)?!0:(t.add(o),!1);for(let s=0;s<t.length;s++)if(t[s]===o)return!0;return t.push(o),!1}function r(o){if(e)t.delete(o);else for(let s=0;s<t.length;s++)if(t[s]===o){t.splice(s,1);break}}return[n,r]}function Nd(e,t=100,n=1/0){try{return jr("",e,t,n)}catch(r){return{ERROR:`**non-serializable** (${r})`}}}function Hi(e,t=3,n=100*1024){const r=Nd(e,t);return Id(r)>n?Hi(e,t-1,n):r}function jr(e,t,n=1/0,r=1/0,o=Ed()){const[s,i]=o;if(t==null||["number","boolean","string"].includes(typeof t)&&!ju(t))return t;const a=Sd(e,t);if(!a.startsWith("[object "))return a;if(t.__sentry_skip_normalization__)return t;const c=typeof t.__sentry_override_normalization_depth__=="number"?t.__sentry_override_normalization_depth__:n;if(c===0)return a.replace("object ","");if(s(t))return"[Circular ~]";const l=t;if(l&&typeof l.toJSON=="function")try{const h=l.toJSON();return jr("",h,c-1,r,o)}catch{}const d=Array.isArray(t)?[]:{};let f=0;const u=Oi(t);for(const h in u){if(!Object.prototype.hasOwnProperty.call(u,h))continue;if(f>=r){d[h]="[MaxProperties ~]";break}const g=u[h];d[h]=jr(h,g,c-1,r,o),f++}return i(t),d}function Sd(e,t){try{if(e==="domain"&&t&&typeof t=="object"&&t._events)return"[Domain]";if(e==="domainEmitter")return"[DomainEmitter]";if(typeof global<"u"&&t===global)return"[Global]";if(typeof window<"u"&&t===window)return"[Window]";if(typeof document<"u"&&t===document)return"[Document]";if(Ai(t))return"[VueViewModel]";if(Du(t))return"[SyntheticEvent]";if(typeof t=="number"&&t!==t)return"[NaN]";if(typeof t=="function")return`[Function: ${Be(t)}]`;if(typeof t=="symbol")return`[${String(t)}]`;if(typeof t=="bigint")return`[BigInt: ${String(t)}]`;const n=Cd(t);return/^HTML(\w*)Element$/.test(n)?`[HTMLElement: ${n}]`:`[object ${n}]`}catch(n){return`**non-serializable** (${n})`}}function Cd(e){const t=Object.getPrototypeOf(e);return t?t.constructor.name:"null prototype"}function kd(e){return~-encodeURI(e).split(/%..|./).length}function Id(e){return kd(JSON.stringify(e))}var Ie;(function(e){e[e.PENDING=0]="PENDING";const n=1;e[e.RESOLVED=n]="RESOLVED";const r=2;e[e.REJECTED=r]="REJECTED"})(Ie||(Ie={}));class Oe{constructor(t){Oe.prototype.__init.call(this),Oe.prototype.__init2.call(this),Oe.prototype.__init3.call(this),Oe.prototype.__init4.call(this),this._state=Ie.PENDING,this._handlers=[];try{t(this._resolve,this._reject)}catch(n){this._reject(n)}}then(t,n){return new Oe((r,o)=>{this._handlers.push([!1,s=>{if(!t)r(s);else try{r(t(s))}catch(i){o(i)}},s=>{if(!n)o(s);else try{r(n(s))}catch(i){o(i)}}]),this._executeHandlers()})}catch(t){return this.then(n=>n,t)}finally(t){return new Oe((n,r)=>{let o,s;return this.then(i=>{s=!1,o=i,t&&t()},i=>{s=!0,o=i,t&&t()}).then(()=>{if(s){r(o);return}n(o)})})}__init(){this._resolve=t=>{this._setResult(Ie.RESOLVED,t)}}__init2(){this._reject=t=>{this._setResult(Ie.REJECTED,t)}}__init3(){this._setResult=(t,n)=>{if(this._state===Ie.PENDING){if(co(n)){n.then(this._resolve,this._reject);return}this._state=t,this._value=n,this._executeHandlers()}}}__init4(){this._executeHandlers=()=>{if(this._state===Ie.PENDING)return;const t=this._handlers.slice();this._handlers=[],t.forEach(n=>{n[0]||(this._state===Ie.RESOLVED&&n[1](this._value),this._state===Ie.REJECTED&&n[2](this._value),n[0]=!0)})}}}function ur(e){if(!e)return{};const t=e.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!t)return{};const n=t[6]||"",r=t[8]||"";return{host:t[4],path:t[5],protocol:t[2],search:n,hash:r,relative:t[5]+n+r}}const Td=["fatal","error","warning","log","info","debug"];function Md(e){return e==="warn"?"warning":Td.includes(e)?e:"log"}const Fi=1e3;function po(){return Date.now()/Fi}function $d(){const{performance:e}=te;if(!e||!e.now)return po;const t=Date.now()-e.now(),n=e.timeOrigin==null?t:e.timeOrigin;return()=>(n+e.now())/Fi}const zi=$d();(()=>{const{performance:e}=te;if(!e||!e.now)return;const t=3600*1e3,n=e.now(),r=Date.now(),o=e.timeOrigin?Math.abs(e.timeOrigin+n-r):t,s=o<t,i=e.timing&&e.timing.navigationStart,c=typeof i=="number"?Math.abs(i+n-r):t,l=c<t;return s||l?o<=c?e.timeOrigin:i:r})();const xe=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,Bi="production";function Ad(){return Di("globalEventProcessors",()=>[])}function Rr(e,t,n,r=0){return new Oe((o,s)=>{const i=e[r];if(t===null||typeof i!="function")o(t);else{const a=i({...t},n);xe&&i.id&&a===null&&ee.log(`Event processor "${i.id}" dropped event`),co(a)?a.then(c=>Rr(e,c,n,r+1).then(o)).then(null,s):Rr(e,a,n,r+1).then(o).then(null,s)}})}function Dd(e){const t=zi(),n={sid:ve(),init:!0,timestamp:t,started:t,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>Rd(n)};return e&&Bn(n,e),n}function Bn(e,t={}){if(t.user&&(!e.ipAddress&&t.user.ip_address&&(e.ipAddress=t.user.ip_address),!e.did&&!t.did&&(e.did=t.user.id||t.user.email||t.user.username)),e.timestamp=t.timestamp||zi(),t.abnormal_mechanism&&(e.abnormal_mechanism=t.abnormal_mechanism),t.ignoreDuration&&(e.ignoreDuration=t.ignoreDuration),t.sid&&(e.sid=t.sid.length===32?t.sid:ve()),t.init!==void 0&&(e.init=t.init),!e.did&&t.did&&(e.did=`${t.did}`),typeof t.started=="number"&&(e.started=t.started),e.ignoreDuration)e.duration=void 0;else if(typeof t.duration=="number")e.duration=t.duration;else{const n=e.timestamp-e.started;e.duration=n>=0?n:0}t.release&&(e.release=t.release),t.environment&&(e.environment=t.environment),!e.ipAddress&&t.ipAddress&&(e.ipAddress=t.ipAddress),!e.userAgent&&t.userAgent&&(e.userAgent=t.userAgent),typeof t.errors=="number"&&(e.errors=t.errors),t.status&&(e.status=t.status)}function jd(e,t){let n={};e.status==="ok"&&(n={status:"exited"}),Bn(e,n)}function Rd(e){return Ge({sid:`${e.sid}`,init:e.init,started:new Date(e.started*1e3).toISOString(),timestamp:new Date(e.timestamp*1e3).toISOString(),status:e.status,errors:e.errors,did:typeof e.did=="number"||typeof e.did=="string"?`${e.did}`:void 0,duration:e.duration,abnormal_mechanism:e.abnormal_mechanism,attrs:{release:e.release,environment:e.environment,ip_address:e.ipAddress,user_agent:e.userAgent}})}const Pd=1;function Od(e){const{spanId:t,traceId:n}=e.spanContext(),{data:r,op:o,parent_span_id:s,status:i,tags:a,origin:c}=Cn(e);return Ge({data:r,op:o,parent_span_id:s,span_id:t,status:i,tags:a,trace_id:n,origin:c})}function Cn(e){return Ld(e)?e.getSpanJSON():typeof e.toJSON=="function"?e.toJSON():{}}function Ld(e){return typeof e.getSpanJSON=="function"}function Hd(e){const{traceFlags:t}=e.spanContext();return!!(t&Pd)}function Fd(e){if(e)return zd(e)?{captureContext:e}:Vd(e)?{captureContext:e}:e}function zd(e){return e instanceof Ke||typeof e=="function"}const Bd=["user","level","extra","contexts","tags","fingerprint","requestSession","propagationContext"];function Vd(e){return Object.keys(e).some(t=>Bd.includes(t))}function go(e,t){return De().captureException(e,Fd(t))}function Vi(e,t){return De().captureEvent(e,t)}function et(e,t){De().addBreadcrumb(e,t)}function Wd(e,t){De().setContext(e,t)}function Yd(e,t){De().setTag(e,t)}function Wi(...e){const t=De();if(e.length===2){const[n,r]=e;return n?t.withScope(()=>(t.getStackTop().scope=n,r(n))):t.withScope(r)}return t.withScope(e[0])}function pe(){return De().getClient()}function Ud(){return De().getScope()}function Yi(e){return e.transaction}function Xd(e,t,n){const r=t.getOptions(),{publicKey:o}=t.getDsn()||{},{segment:s}=n&&n.getUser()||{},i=Ge({environment:r.environment||Bi,release:r.release,user_segment:s,public_key:o,trace_id:e});return t.emit&&t.emit("createDsc",i),i}function Gd(e){const t=pe();if(!t)return{};const n=Xd(Cn(e).trace_id||"",t,Ud()),r=Yi(e);if(!r)return n;const o=r&&r._frozenDynamicSamplingContext;if(o)return o;const{sampleRate:s,source:i}=r.metadata;s!=null&&(n.sample_rate=`${s}`);const a=Cn(r);return i&&i!=="url"&&(n.transaction=a.description),n.sampled=String(Hd(r)),t.emit&&t.emit("createDsc",n),n}function qd(e,t){const{fingerprint:n,span:r,breadcrumbs:o,sdkProcessingMetadata:s}=t;Kd(e,t),r&&Qd(e,r),ef(e,n),Zd(e,o),Jd(e,s)}function Kd(e,t){const{extra:n,tags:r,user:o,contexts:s,level:i,transactionName:a}=t,c=Ge(n);c&&Object.keys(c).length&&(e.extra={...c,...e.extra});const l=Ge(r);l&&Object.keys(l).length&&(e.tags={...l,...e.tags});const d=Ge(o);d&&Object.keys(d).length&&(e.user={...d,...e.user});const f=Ge(s);f&&Object.keys(f).length&&(e.contexts={...f,...e.contexts}),i&&(e.level=i),a&&(e.transaction=a)}function Zd(e,t){const n=[...e.breadcrumbs||[],...t];e.breadcrumbs=n.length?n:void 0}function Jd(e,t){e.sdkProcessingMetadata={...e.sdkProcessingMetadata,...t}}function Qd(e,t){e.contexts={trace:Od(t),...e.contexts};const n=Yi(t);if(n){e.sdkProcessingMetadata={dynamicSamplingContext:Gd(t),...e.sdkProcessingMetadata};const r=Cn(n).description;r&&(e.tags={transaction:r,...e.tags})}}function ef(e,t){e.fingerprint=e.fingerprint?ed(e.fingerprint):[],t&&(e.fingerprint=e.fingerprint.concat(t)),e.fingerprint&&!e.fingerprint.length&&delete e.fingerprint}const tf=100;class Ke{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext=qo()}static clone(t){return t?t.clone():new Ke}clone(){const t=new Ke;return t._breadcrumbs=[...this._breadcrumbs],t._tags={...this._tags},t._extra={...this._extra},t._contexts={...this._contexts},t._user=this._user,t._level=this._level,t._span=this._span,t._session=this._session,t._transactionName=this._transactionName,t._fingerprint=this._fingerprint,t._eventProcessors=[...this._eventProcessors],t._requestSession=this._requestSession,t._attachments=[...this._attachments],t._sdkProcessingMetadata={...this._sdkProcessingMetadata},t._propagationContext={...this._propagationContext},t._client=this._client,t}setClient(t){this._client=t}getClient(){return this._client}addScopeListener(t){this._scopeListeners.push(t)}addEventProcessor(t){return this._eventProcessors.push(t),this}setUser(t){return this._user=t||{email:void 0,id:void 0,ip_address:void 0,segment:void 0,username:void 0},this._session&&Bn(this._session,{user:t}),this._notifyScopeListeners(),this}getUser(){return this._user}getRequestSession(){return this._requestSession}setRequestSession(t){return this._requestSession=t,this}setTags(t){return this._tags={...this._tags,...t},this._notifyScopeListeners(),this}setTag(t,n){return this._tags={...this._tags,[t]:n},this._notifyScopeListeners(),this}setExtras(t){return this._extra={...this._extra,...t},this._notifyScopeListeners(),this}setExtra(t,n){return this._extra={...this._extra,[t]:n},this._notifyScopeListeners(),this}setFingerprint(t){return this._fingerprint=t,this._notifyScopeListeners(),this}setLevel(t){return this._level=t,this._notifyScopeListeners(),this}setTransactionName(t){return this._transactionName=t,this._notifyScopeListeners(),this}setContext(t,n){return n===null?delete this._contexts[t]:this._contexts[t]=n,this._notifyScopeListeners(),this}setSpan(t){return this._span=t,this._notifyScopeListeners(),this}getSpan(){return this._span}getTransaction(){const t=this._span;return t&&t.transaction}setSession(t){return t?this._session=t:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(t){if(!t)return this;const n=typeof t=="function"?t(this):t;if(n instanceof Ke){const r=n.getScopeData();this._tags={...this._tags,...r.tags},this._extra={...this._extra,...r.extra},this._contexts={...this._contexts,...r.contexts},r.user&&Object.keys(r.user).length&&(this._user=r.user),r.level&&(this._level=r.level),r.fingerprint.length&&(this._fingerprint=r.fingerprint),n.getRequestSession()&&(this._requestSession=n.getRequestSession()),r.propagationContext&&(this._propagationContext=r.propagationContext)}else if(Hn(n)){const r=t;this._tags={...this._tags,...r.tags},this._extra={...this._extra,...r.extra},this._contexts={...this._contexts,...r.contexts},r.user&&(this._user=r.user),r.level&&(this._level=r.level),r.fingerprint&&(this._fingerprint=r.fingerprint),r.requestSession&&(this._requestSession=r.requestSession),r.propagationContext&&(this._propagationContext=r.propagationContext)}return this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._requestSession=void 0,this._span=void 0,this._session=void 0,this._notifyScopeListeners(),this._attachments=[],this._propagationContext=qo(),this}addBreadcrumb(t,n){const r=typeof n=="number"?n:tf;if(r<=0)return this;const o={timestamp:po(),...t},s=this._breadcrumbs;return s.push(o),this._breadcrumbs=s.length>r?s.slice(-r):s,this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(t){return this._attachments.push(t),this}getAttachments(){return this.getScopeData().attachments}clearAttachments(){return this._attachments=[],this}getScopeData(){const{_breadcrumbs:t,_attachments:n,_contexts:r,_tags:o,_extra:s,_user:i,_level:a,_fingerprint:c,_eventProcessors:l,_propagationContext:d,_sdkProcessingMetadata:f,_transactionName:u,_span:h}=this;return{breadcrumbs:t,attachments:n,contexts:r,tags:o,extra:s,user:i,level:a,fingerprint:c||[],eventProcessors:l,propagationContext:d,sdkProcessingMetadata:f,transactionName:u,span:h}}applyToEvent(t,n={},r=[]){qd(t,this.getScopeData());const o=[...r,...Ad(),...this._eventProcessors];return Rr(o,t,n)}setSDKProcessingMetadata(t){return this._sdkProcessingMetadata={...this._sdkProcessingMetadata,...t},this}setPropagationContext(t){return this._propagationContext=t,this}getPropagationContext(){return this._propagationContext}captureException(t,n){const r=n&&n.event_id?n.event_id:ve();if(!this._client)return ee.warn("No client configured on scope - will not capture exception!"),r;const o=new Error("Sentry syntheticException");return this._client.captureException(t,{originalException:t,syntheticException:o,...n,event_id:r},this),r}captureMessage(t,n,r){const o=r&&r.event_id?r.event_id:ve();if(!this._client)return ee.warn("No client configured on scope - will not capture message!"),o;const s=new Error(t);return this._client.captureMessage(t,n,{originalException:t,syntheticException:s,...r,event_id:o},this),o}captureEvent(t,n){const r=n&&n.event_id?n.event_id:ve();return this._client?(this._client.captureEvent(t,{...n,event_id:r},this),r):(ee.warn("No client configured on scope - will not capture event!"),r)}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(t=>{t(this)}),this._notifyingListeners=!1)}}function qo(){return{traceId:ve(),spanId:ve().substring(16)}}const nf="7.120.3",Ui=parseFloat(nf),rf=100;class Xi{constructor(t,n,r,o=Ui){this._version=o;let s;n?s=n:(s=new Ke,s.setClient(t));let i;r?i=r:(i=new Ke,i.setClient(t)),this._stack=[{scope:s}],t&&this.bindClient(t),this._isolationScope=i}isOlderThan(t){return this._version<t}bindClient(t){const n=this.getStackTop();n.client=t,n.scope.setClient(t),t&&t.setupIntegrations&&t.setupIntegrations()}pushScope(){const t=this.getScope().clone();return this.getStack().push({client:this.getClient(),scope:t}),t}popScope(){return this.getStack().length<=1?!1:!!this.getStack().pop()}withScope(t){const n=this.pushScope();let r;try{r=t(n)}catch(o){throw this.popScope(),o}return co(r)?r.then(o=>(this.popScope(),o),o=>{throw this.popScope(),o}):(this.popScope(),r)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStack(){return this._stack}getStackTop(){return this._stack[this._stack.length-1]}captureException(t,n){const r=this._lastEventId=n&&n.event_id?n.event_id:ve(),o=new Error("Sentry syntheticException");return this.getScope().captureException(t,{originalException:t,syntheticException:o,...n,event_id:r}),r}captureMessage(t,n,r){const o=this._lastEventId=r&&r.event_id?r.event_id:ve(),s=new Error(t);return this.getScope().captureMessage(t,n,{originalException:t,syntheticException:s,...r,event_id:o}),o}captureEvent(t,n){const r=n&&n.event_id?n.event_id:ve();return t.type||(this._lastEventId=r),this.getScope().captureEvent(t,{...n,event_id:r}),r}lastEventId(){return this._lastEventId}addBreadcrumb(t,n){const{scope:r,client:o}=this.getStackTop();if(!o)return;const{beforeBreadcrumb:s=null,maxBreadcrumbs:i=rf}=o.getOptions&&o.getOptions()||{};if(i<=0)return;const c={timestamp:po(),...t},l=s?fo(()=>s(c,n)):c;l!==null&&(o.emit&&o.emit("beforeAddBreadcrumb",l,n),r.addBreadcrumb(l,i))}setUser(t){this.getScope().setUser(t),this.getIsolationScope().setUser(t)}setTags(t){this.getScope().setTags(t),this.getIsolationScope().setTags(t)}setExtras(t){this.getScope().setExtras(t),this.getIsolationScope().setExtras(t)}setTag(t,n){this.getScope().setTag(t,n),this.getIsolationScope().setTag(t,n)}setExtra(t,n){this.getScope().setExtra(t,n),this.getIsolationScope().setExtra(t,n)}setContext(t,n){this.getScope().setContext(t,n),this.getIsolationScope().setContext(t,n)}configureScope(t){const{scope:n,client:r}=this.getStackTop();r&&t(n)}run(t){const n=Ko(this);try{t(this)}finally{Ko(n)}}getIntegration(t){const n=this.getClient();if(!n)return null;try{return n.getIntegration(t)}catch{return xe&&ee.warn(`Cannot retrieve integration ${t.id} from the current Hub`),null}}startTransaction(t,n){const r=this._callExtensionMethod("startTransaction",t,n);return xe&&!r&&(this.getClient()?ee.warn(`Tracing extension 'startTransaction' has not been added. Call 'addTracingExtensions' before calling 'init':
Sentry.addTracingExtensions();
Sentry.init({...});
`):ee.warn("Tracing extension 'startTransaction' is missing. You should 'init' the SDK before calling 'startTransaction'")),r}traceHeaders(){return this._callExtensionMethod("traceHeaders")}captureSession(t=!1){if(t)return this.endSession();this._sendSessionUpdate()}endSession(){const n=this.getStackTop().scope,r=n.getSession();r&&jd(r),this._sendSessionUpdate(),n.setSession()}startSession(t){const{scope:n,client:r}=this.getStackTop(),{release:o,environment:s=Bi}=r&&r.getOptions()||{},{userAgent:i}=te.navigator||{},a=Dd({release:o,environment:s,user:n.getUser(),...i&&{userAgent:i},...t}),c=n.getSession&&n.getSession();return c&&c.status==="ok"&&Bn(c,{status:"exited"}),this.endSession(),n.setSession(a),a}shouldSendDefaultPii(){const t=this.getClient(),n=t&&t.getOptions();return!!(n&&n.sendDefaultPii)}_sendSessionUpdate(){const{scope:t,client:n}=this.getStackTop(),r=t.getSession();r&&n&&n.captureSession&&n.captureSession(r)}_callExtensionMethod(t,...n){const o=Vn().__SENTRY__;if(o&&o.extensions&&typeof o.extensions[t]=="function")return o.extensions[t].apply(this,n);xe&&ee.warn(`Extension method ${t} couldn't be found, doing nothing.`)}}function Vn(){return te.__SENTRY__=te.__SENTRY__||{extensions:{},hub:void 0},te}function Ko(e){const t=Vn(),n=Pr(t);return Gi(t,e),n}function De(){const e=Vn();if(e.__SENTRY__&&e.__SENTRY__.acs){const t=e.__SENTRY__.acs.getCurrentHub();if(t)return t}return of(e)}function of(e=Vn()){return(!sf(e)||Pr(e).isOlderThan(Ui))&&Gi(e,new Xi),Pr(e)}function sf(e){return!!(e&&e.__SENTRY__&&e.__SENTRY__.hub)}function Pr(e){return Di("hub",()=>new Xi,e)}function Gi(e,t){if(!e)return!1;const n=e.__SENTRY__=e.__SENTRY__||{};return n.hub=t,!0}function af(e){const t=e.protocol?`${e.protocol}:`:"",n=e.port?`:${e.port}`:"";return`${t}//${e.host}${n}${e.path?`/${e.path}`:""}/api/`}function cf(e,t){const n=qu(e);if(!n)return"";const r=`${af(n)}embed/error-page/`;let o=`dsn=${Uu(n)}`;for(const s in t)if(s!=="dsn"&&s!=="onClose")if(s==="user"){const i=t.user;if(!i)continue;i.name&&(o+=`&name=${encodeURIComponent(i.name)}`),i.email&&(o+=`&email=${encodeURIComponent(i.email)}`)}else o+=`&${encodeURIComponent(s)}=${encodeURIComponent(t[s])}`;return`${r}?${o}`}function We(e,t){return Object.assign(function(...r){return t(...r)},{id:e})}const lf=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/,/^ResizeObserver loop completed with undelivered notifications.$/,/^Cannot redefine property: googletag$/],uf=[/^.*\/healthcheck$/,/^.*\/healthy$/,/^.*\/live$/,/^.*\/ready$/,/^.*\/heartbeat$/,/^.*\/health$/,/^.*\/healthz$/],qi="InboundFilters",df=(e={})=>({name:qi,setupOnce(){},processEvent(t,n,r){const o=r.getOptions(),s=ff(e,o);return hf(t,s)?null:t}}),Ki=df;We(qi,Ki);function ff(e={},t={}){return{allowUrls:[...e.allowUrls||[],...t.allowUrls||[]],denyUrls:[...e.denyUrls||[],...t.denyUrls||[]],ignoreErrors:[...e.ignoreErrors||[],...t.ignoreErrors||[],...e.disableErrorDefaults?[]:lf],ignoreTransactions:[...e.ignoreTransactions||[],...t.ignoreTransactions||[],...e.disableTransactionDefaults?[]:uf],ignoreInternal:e.ignoreInternal!==void 0?e.ignoreInternal:!0}}function hf(e,t){return t.ignoreInternal&&wf(e)?(xe&&ee.warn(`Event dropped due to being internal Sentry Error.
Event: ${He(e)}`),!0):pf(e,t.ignoreErrors)?(xe&&ee.warn(`Event dropped due to being matched by \`ignoreErrors\` option.
Event: ${He(e)}`),!0):gf(e,t.ignoreTransactions)?(xe&&ee.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.
Event: ${He(e)}`),!0):mf(e,t.denyUrls)?(xe&&ee.warn(`Event dropped due to being matched by \`denyUrls\` option.
Event: ${He(e)}.
Url: ${kn(e)}`),!0):yf(e,t.allowUrls)?!1:(xe&&ee.warn(`Event dropped due to not being matched by \`allowUrls\` option.
Event: ${He(e)}.
Url: ${kn(e)}`),!0)}function pf(e,t){return e.type||!t||!t.length?!1:xf(e).some(n=>zn(n,t))}function gf(e,t){if(e.type!=="transaction"||!t||!t.length)return!1;const n=e.transaction;return n?zn(n,t):!1}function mf(e,t){if(!t||!t.length)return!1;const n=kn(e);return n?zn(n,t):!1}function yf(e,t){if(!t||!t.length)return!0;const n=kn(e);return n?zn(n,t):!0}function xf(e){const t=[];e.message&&t.push(e.message);let n;try{n=e.exception.values[e.exception.values.length-1]}catch{}return n&&n.value&&(t.push(n.value),n.type&&t.push(`${n.type}: ${n.value}`)),xe&&t.length===0&&ee.error(`Could not extract message for event ${He(e)}`),t}function wf(e){try{return e.exception.values[0].type==="SentryError"}catch{}return!1}function _f(e=[]){for(let t=e.length-1;t>=0;t--){const n=e[t];if(n&&n.filename!=="<anonymous>"&&n.filename!=="[native code]")return n.filename||null}return null}function kn(e){try{let t;try{t=e.exception.values[0].stacktrace.frames}catch{}return t?_f(t):null}catch{return xe&&ee.error(`Cannot extract url for event ${He(e)}`),null}}let Zo;const Zi="FunctionToString",Jo=new WeakMap,bf=()=>({name:Zi,setupOnce(){Zo=Function.prototype.toString;try{Function.prototype.toString=function(...e){const t=ho(this),n=Jo.has(pe())&&t!==void 0?t:this;return Zo.apply(n,e)}}catch{}},setup(e){Jo.set(e,!0)}}),Ji=bf;We(Zi,Ji);const ie=te;let Or=0;function Qi(){return Or>0}function vf(){Or++,setTimeout(()=>{Or--})}function gt(e,t={},n){if(typeof e!="function")return e;try{const o=e.__sentry_wrapped__;if(o)return typeof o=="function"?o:e;if(ho(e))return e}catch{return e}const r=function(){const o=Array.prototype.slice.call(arguments);try{const s=o.map(i=>gt(i,t));return e.apply(this,s)}catch(s){throw vf(),Wi(i=>{i.addEventProcessor(a=>(t.mechanism&&(Ir(a,void 0),Tr(a,t.mechanism)),a.extra={...a.extra,arguments:o},a)),go(s)}),s}};try{for(const o in e)Object.prototype.hasOwnProperty.call(e,o)&&(r[o]=e[o])}catch{}Pi(r,e),Sn(e,"__sentry_wrapped__",r);try{Object.getOwnPropertyDescriptor(r,"name").configurable&&Object.defineProperty(r,"name",{get(){return e.name}})}catch{}return r}const ft=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__;function ea(e,t){const n=Nf(e,t),r={type:t&&t.name,value:kf(t)};return n.length&&(r.stacktrace={frames:n}),r.type===void 0&&r.value===""&&(r.value="Unrecoverable error caught"),r}function Ef(e,t,n,r){const o=pe(),s=o&&o.getOptions().normalizeDepth;return{exception:{values:[{type:Fn(t)?t.constructor.name:r?"UnhandledRejection":"Error",value:If(t,{isUnhandledRejection:r})}]},extra:{__serialized__:Hi(t,s)}}}function dr(e,t){return{exception:{values:[ea(e,t)]}}}function Nf(e,t){const n=t.stacktrace||t.stack||"",r=Cf(t);try{return e(n,r)}catch{}return[]}const Sf=/Minified React error #\d+;/i;function Cf(e){if(e){if(typeof e.framesToPop=="number")return e.framesToPop;if(Sf.test(e.message))return 1}return 0}function kf(e){const t=e&&e.message;return t?t.error&&typeof t.error.message=="string"?t.error.message:t:"No error message"}function ta(e,t,n,r,o){let s;if(ao(t)&&t.error)return dr(e,t.error);if(Lo(t)||Mu(t)){const i=t;if("stack"in t)s=dr(e,t);else{const a=i.name||(Lo(i)?"DOMError":"DOMException"),c=i.message?`${a}: ${i.message}`:a;s=Qo(e,c),Ir(s,c)}return"code"in i&&(s.tags={...s.tags,"DOMException.code":`${i.code}`}),s}return io(t)?dr(e,t):Hn(t)||Fn(t)?(s=Ef(e,t,n,o),Tr(s,{synthetic:!0}),s):(s=Qo(e,t),Ir(s,`${t}`),Tr(s,{synthetic:!0}),s)}function Qo(e,t,n,r){const o={};if(Mi(t)){const{__sentry_template_string__:s,__sentry_template_values__:i}=t;return o.logentry={message:s,params:i},o}return o.message=t,o}function If(e,{isUnhandledRejection:t}){const n=Ku(e),r=t?"promise rejection":"exception";return ao(e)?`Event \`ErrorEvent\` captured as ${r} with message \`${e.message}\``:Fn(e)?`Event \`${Tf(e)}\` (type=${e.type}) captured as ${r}`:`Object captured as ${r} with keys: ${n}`}function Tf(e){try{const t=Object.getPrototypeOf(e);return t?t.constructor.name:void 0}catch{}}const ln=1024,na="Breadcrumbs",Mf=(e={})=>{const t={console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0,...e};return{name:na,setupOnce(){},setup(n){t.console&&Ju(Df(n)),t.dom&&nd(Af(n,t.dom)),t.xhr&&_d(jf(n)),t.fetch&&ld(Rf(n)),t.history&&yd(Pf(n)),t.sentry&&n.on&&n.on("beforeSendEvent",$f(n))}}},ra=Mf;We(na,ra);function $f(e){return function(n){pe()===e&&et({category:`sentry.${n.type==="transaction"?"transaction":"event"}`,event_id:n.event_id,level:n.level,message:He(n)},{event:n})}}function Af(e,t){return function(r){if(pe()!==e)return;let o,s,i=typeof t=="object"?t.serializeAttribute:void 0,a=typeof t=="object"&&typeof t.maxStringLength=="number"?t.maxStringLength:void 0;a&&a>ln&&(ft&&ee.warn(`\`dom.maxStringLength\` cannot exceed ${ln}, but a value of ${a} was configured. Sentry will use ${ln} instead.`),a=ln),typeof i=="string"&&(i=[i]);try{const l=r.event,d=Of(l)?l.target:l;o=ji(d,{keyAttrs:i,maxStringLength:a}),s=zu(d)}catch{o="<unknown>"}if(o.length===0)return;const c={category:`ui.${r.name}`,message:o};s&&(c.data={"ui.component_name":s}),et(c,{event:r.event,name:r.name,global:r.global})}}function Df(e){return function(n){if(pe()!==e)return;const r={category:"console",data:{arguments:n.args,logger:"console"},level:Md(n.level),message:Ho(n.args," ")};if(n.level==="assert")if(n.args[0]===!1)r.message=`Assertion failed: ${Ho(n.args.slice(1)," ")||"console.assert"}`,r.data.arguments=n.args.slice(1);else return;et(r,{input:n.args,level:n.level})}}function jf(e){return function(n){if(pe()!==e)return;const{startTimestamp:r,endTimestamp:o}=n,s=n.xhr[Dt];if(!r||!o||!s)return;const{method:i,url:a,status_code:c,body:l}=s,d={method:i,url:a,status_code:c},f={xhr:n.xhr,input:l,startTimestamp:r,endTimestamp:o};et({category:"xhr",data:d,type:"http"},f)}}function Rf(e){return function(n){if(pe()!==e)return;const{startTimestamp:r,endTimestamp:o}=n;if(o&&!(n.fetchData.url.match(/sentry_key/)&&n.fetchData.method==="POST"))if(n.error){const s=n.fetchData,i={data:n.error,input:n.args,startTimestamp:r,endTimestamp:o};et({category:"fetch",data:s,level:"error",type:"http"},i)}else{const s=n.response,i={...n.fetchData,status_code:s&&s.status},a={input:n.args,response:s,startTimestamp:r,endTimestamp:o};et({category:"fetch",data:i,type:"http"},a)}}}function Pf(e){return function(n){if(pe()!==e)return;let r=n.from,o=n.to;const s=ur(ie.location.href);let i=r?ur(r):void 0;const a=ur(o);(!i||!i.path)&&(i=s),s.protocol===a.protocol&&s.host===a.host&&(o=a.relative),s.protocol===i.protocol&&s.host===i.host&&(r=i.relative),et({category:"navigation",data:{from:r,to:o}})}}function Of(e){return!!e&&!!e.target}const oa="Dedupe",Lf=()=>{let e;return{name:oa,setupOnce(){},processEvent(t){if(t.type)return t;try{if(Hf(t,e))return ft&&ee.warn("Event dropped due to being a duplicate of previously captured event."),null}catch{}return e=t}}},sa=Lf;We(oa,sa);function Hf(e,t){return t?!!(Ff(e,t)||zf(e,t)):!1}function Ff(e,t){const n=e.message,r=t.message;return!(!n&&!r||n&&!r||!n&&r||n!==r||!aa(e,t)||!ia(e,t))}function zf(e,t){const n=es(t),r=es(e);return!(!n||!r||n.type!==r.type||n.value!==r.value||!aa(e,t)||!ia(e,t))}function ia(e,t){let n=ts(e),r=ts(t);if(!n&&!r)return!0;if(n&&!r||!n&&r||(n=n,r=r,r.length!==n.length))return!1;for(let o=0;o<r.length;o++){const s=r[o],i=n[o];if(s.filename!==i.filename||s.lineno!==i.lineno||s.colno!==i.colno||s.function!==i.function)return!1}return!0}function aa(e,t){let n=e.fingerprint,r=t.fingerprint;if(!n&&!r)return!0;if(n&&!r||!n&&r)return!1;n=n,r=r;try{return n.join("")===r.join("")}catch{return!1}}function es(e){return e.exception&&e.exception.values&&e.exception.values[0]}function ts(e){const t=e.exception;if(t)try{return t.values[0].stacktrace.frames}catch{return}}const ca="GlobalHandlers",Bf=(e={})=>{const t={onerror:!0,onunhandledrejection:!0,...e};return{name:ca,setupOnce(){Error.stackTraceLimit=50},setup(n){t.onerror&&(Vf(n),ns("onerror")),t.onunhandledrejection&&(Wf(n),ns("onunhandledrejection"))}}},la=Bf;We(ca,la);function Vf(e){fd(t=>{const{stackParser:n,attachStacktrace:r}=da();if(pe()!==e||Qi())return;const{msg:o,url:s,line:i,column:a,error:c}=t,l=c===void 0&&Me(o)?Xf(o,s,i,a):ua(ta(n,c||o,void 0,r,!1),s,i,a);l.level="error",Vi(l,{originalException:c,mechanism:{handled:!1,type:"onerror"}})})}function Wf(e){pd(t=>{const{stackParser:n,attachStacktrace:r}=da();if(pe()!==e||Qi())return;const o=Yf(t),s=$i(o)?Uf(o):ta(n,o,void 0,r,!0);s.level="error",Vi(s,{originalException:o,mechanism:{handled:!1,type:"onunhandledrejection"}})})}function Yf(e){if($i(e))return e;const t=e;try{if("reason"in t)return t.reason;if("detail"in t&&"reason"in t.detail)return t.detail.reason}catch{}return e}function Uf(e){return{exception:{values:[{type:"UnhandledRejection",value:`Non-Error promise rejection captured with value: ${String(e)}`}]}}}function Xf(e,t,n,r){const o=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/i;let s=ao(e)?e.message:e,i="Error";const a=s.match(o);return a&&(i=a[1],s=a[2]),ua({exception:{values:[{type:i,value:s}]}},t,n,r)}function ua(e,t,n,r){const o=e.exception=e.exception||{},s=o.values=o.values||[],i=s[0]=s[0]||{},a=i.stacktrace=i.stacktrace||{},c=a.frames=a.frames||[],l=isNaN(parseInt(r,10))?void 0:r,d=isNaN(parseInt(n,10))?void 0:n,f=Me(t)&&t.length>0?t:Fu();return c.length===0&&c.push({colno:l,filename:f,function:"?",in_app:!0,lineno:d}),e}function ns(e){ft&&ee.log(`Global Handler attached: ${e}`)}function da(){const e=pe();return e&&e.getOptions()||{stackParser:()=>[],attachStacktrace:!1}}const fa="HttpContext",Gf=()=>({name:fa,setupOnce(){},preprocessEvent(e){if(!ie.navigator&&!ie.location&&!ie.document)return;const t=e.request&&e.request.url||ie.location&&ie.location.href,{referrer:n}=ie.document||{},{userAgent:r}=ie.navigator||{},o={...e.request&&e.request.headers,...n&&{Referer:n},...r&&{"User-Agent":r}},s={...e.request,...t&&{url:t},headers:o};e.request=s}}),ha=Gf;We(fa,ha);const qf="cause",Kf=5,pa="LinkedErrors",Zf=(e={})=>{const t=e.limit||Kf,n=e.key||qf;return{name:pa,setupOnce(){},preprocessEvent(r,o,s){const i=s.getOptions();Pu(ea,i.stackParser,i.maxValueLength,n,t,r,o)}}},ga=Zf;We(pa,ga);const Jf=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","BroadcastChannel","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","SharedWorker","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],ma="TryCatch",Qf=(e={})=>{const t={XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0,...e};return{name:ma,setupOnce(){t.setTimeout&&le(ie,"setTimeout",rs),t.setInterval&&le(ie,"setInterval",rs),t.requestAnimationFrame&&le(ie,"requestAnimationFrame",eh),t.XMLHttpRequest&&"XMLHttpRequest"in ie&&le(XMLHttpRequest.prototype,"send",th);const n=t.eventTarget;n&&(Array.isArray(n)?n:Jf).forEach(nh)}}},ya=Qf;We(ma,ya);function rs(e){return function(...t){const n=t[0];return t[0]=gt(n,{mechanism:{data:{function:Be(e)},handled:!1,type:"instrument"}}),e.apply(this,t)}}function eh(e){return function(t){return e.apply(this,[gt(t,{mechanism:{data:{function:"requestAnimationFrame",handler:Be(e)},handled:!1,type:"instrument"}})])}}function th(e){return function(...t){const n=this;return["onload","onerror","onprogress","onreadystatechange"].forEach(o=>{o in n&&typeof n[o]=="function"&&le(n,o,function(s){const i={mechanism:{data:{function:o,handler:Be(s)},handled:!1,type:"instrument"}},a=ho(s);return a&&(i.mechanism.data.handler=Be(a)),gt(s,i)})}),e.apply(this,t)}}function nh(e){const t=ie,n=t[e]&&t[e].prototype;!n||!n.hasOwnProperty||!n.hasOwnProperty("addEventListener")||(le(n,"addEventListener",function(r){return function(o,s,i){try{typeof s.handleEvent=="function"&&(s.handleEvent=gt(s.handleEvent,{mechanism:{data:{function:"handleEvent",handler:Be(s),target:e},handled:!1,type:"instrument"}}))}catch{}return r.apply(this,[o,gt(s,{mechanism:{data:{function:"addEventListener",handler:Be(s),target:e},handled:!1,type:"instrument"}}),i])}}),le(n,"removeEventListener",function(r){return function(o,s,i){const a=s;try{const c=a&&a.__sentry_wrapped__;c&&r.call(this,o,c,i)}catch{}return r.call(this,o,a,i)}}))}Ki(),Ji(),ya(),ra(),la(),ga(),sa(),ha();const os=(e={},t=De())=>{if(!ie.document){ft&&ee.error("Global document not defined in showReportDialog call");return}const{client:n,scope:r}=t.getStackTop(),o=e.dsn||n&&n.getDsn();if(!o){ft&&ee.error("DSN not configured for showReportDialog call");return}r&&(e.user={...r.getUser(),...e.user}),e.eventId||(e.eventId=t.lastEventId());const s=ie.document.createElement("script");s.async=!0,s.crossOrigin="anonymous",s.src=cf(o,e),e.onLoad&&(s.onload=e.onLoad);const{onClose:i}=e;if(i){const c=l=>{if(l.data==="__sentry_reportdialog_closed__")try{i()}finally{ie.removeEventListener("message",c)}};ie.addEventListener("message",c)}const a=ie.document.head||ie.document.body;a?a.appendChild(s):ft&&ee.error("Not injecting report dialog. No injection point found in HTML")},rh=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,ss="/home/runner/work/sentry-javascript/sentry-javascript/packages/react/src/errorboundary.tsx";function oh(e){const t=e.match(/^([^.]+)/);return t!==null&&parseInt(t[0])>=17}const sh="unknown",is={componentStack:null,error:null,eventId:null};function ih(e,t){const n=new WeakMap;function r(o,s){if(!n.has(o)){if(o.cause)return n.set(o,!0),r(o.cause,s);o.cause=s}}r(e,t)}class mo extends v.Component{constructor(t){super(t),mo.prototype.__init.call(this),this.state=is,this._openFallbackReportDialog=!0;const n=pe();n&&n.on&&t.showDialog&&(this._openFallbackReportDialog=!1,n.on("afterSendEvent",r=>{!r.type&&r.event_id===this._lastEventId&&os({...t.dialogOptions,eventId:this._lastEventId})}))}componentDidCatch(t,{componentStack:n}){const{beforeCapture:r,onError:o,showDialog:s,dialogOptions:i}=this.props;Wi(a=>{if(oh(v.version)&&io(t)){const l=new Error(t.message);l.name=`React ErrorBoundary ${t.name}`,l.stack=n,ih(t,l)}r&&r(a,t,n);const c=go(t,{captureContext:{contexts:{react:{componentStack:n}}},mechanism:{handled:!!this.props.fallback}});o&&o(t,n,c),s&&(this._lastEventId=c,this._openFallbackReportDialog&&os({...i,eventId:c})),this.setState({error:t,componentStack:n,eventId:c})})}componentDidMount(){const{onMount:t}=this.props;t&&t()}componentWillUnmount(){const{error:t,componentStack:n,eventId:r}=this.state,{onUnmount:o}=this.props;o&&o(t,n,r)}__init(){this.resetErrorBoundary=()=>{const{onReset:t}=this.props,{error:n,componentStack:r,eventId:o}=this.state;t&&t(n,r,o),this.setState(is)}}render(){const{fallback:t,children:n}=this.props,r=this.state;if(r.error){let o;return typeof t=="function"?o=t({error:r.error,componentStack:r.componentStack,resetError:this.resetErrorBoundary,eventId:r.eventId}):o=t,v.isValidElement(o)?o:(t&&rh&&ee.warn("fallback did not produce a valid ReactElement"),null)}return typeof n=="function"?n():n}}function ah(e,t){const n=e.displayName||e.name||sh,r=o=>v.createElement(mo,{...t,__self:this,__source:{fileName:ss,lineNumber:240}},v.createElement(e,{...o,__self:this,__source:{fileName:ss,lineNumber:241}}));return r.displayName=`errorBoundary(${n})`,au(r,e),r}function se(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,r;n<e.length;n++)(r=se(e[n]))!==""&&(t+=(t&&" ")+r);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var ch={value:()=>{}};function Wn(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new _n(n)}function _n(e){this._=e}function lh(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",o=n.indexOf(".");if(o>=0&&(r=n.slice(o+1),n=n.slice(0,o)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}_n.prototype=Wn.prototype={constructor:_n,on:function(e,t){var n=this._,r=lh(e+"",n),o,s=-1,i=r.length;if(arguments.length<2){for(;++s<i;)if((o=(e=r[s]).type)&&(o=uh(n[o],e.name)))return o;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++s<i;)if(o=(e=r[s]).type)n[o]=as(n[o],e.name,t);else if(t==null)for(o in n)n[o]=as(n[o],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new _n(e)},call:function(e,t){if((o=arguments.length-2)>0)for(var n=new Array(o),r=0,o,s;r<o;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],r=0,o=s.length;r<o;++r)s[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],o=0,s=r.length;o<s;++o)r[o].value.apply(t,n)}};function uh(e,t){for(var n=0,r=e.length,o;n<r;++n)if((o=e[n]).name===t)return o.value}function as(e,t,n){for(var r=0,o=e.length;r<o;++r)if(e[r].name===t){e[r]=ch,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var Lr="http://www.w3.org/1999/xhtml";const cs={svg:"http://www.w3.org/2000/svg",xhtml:Lr,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Yn(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),cs.hasOwnProperty(t)?{space:cs[t],local:e}:e}function dh(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Lr&&t.documentElement.namespaceURI===Lr?t.createElement(e):t.createElementNS(n,e)}}function fh(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function xa(e){var t=Yn(e);return(t.local?fh:dh)(t)}function hh(){}function yo(e){return e==null?hh:function(){return this.querySelector(e)}}function ph(e){typeof e!="function"&&(e=yo(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var s=t[o],i=s.length,a=r[o]=new Array(i),c,l,d=0;d<i;++d)(c=s[d])&&(l=e.call(c,c.__data__,d,s))&&("__data__"in c&&(l.__data__=c.__data__),a[d]=l);return new he(r,this._parents)}function gh(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function mh(){return[]}function wa(e){return e==null?mh:function(){return this.querySelectorAll(e)}}function yh(e){return function(){return gh(e.apply(this,arguments))}}function xh(e){typeof e=="function"?e=yh(e):e=wa(e);for(var t=this._groups,n=t.length,r=[],o=[],s=0;s<n;++s)for(var i=t[s],a=i.length,c,l=0;l<a;++l)(c=i[l])&&(r.push(e.call(c,c.__data__,l,i)),o.push(c));return new he(r,o)}function _a(e){return function(){return this.matches(e)}}function ba(e){return function(t){return t.matches(e)}}var wh=Array.prototype.find;function _h(e){return function(){return wh.call(this.children,e)}}function bh(){return this.firstElementChild}function vh(e){return this.select(e==null?bh:_h(typeof e=="function"?e:ba(e)))}var Eh=Array.prototype.filter;function Nh(){return Array.from(this.children)}function Sh(e){return function(){return Eh.call(this.children,e)}}function Ch(e){return this.selectAll(e==null?Nh:Sh(typeof e=="function"?e:ba(e)))}function kh(e){typeof e!="function"&&(e=_a(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var s=t[o],i=s.length,a=r[o]=[],c,l=0;l<i;++l)(c=s[l])&&e.call(c,c.__data__,l,s)&&a.push(c);return new he(r,this._parents)}function va(e){return new Array(e.length)}function Ih(){return new he(this._enter||this._groups.map(va),this._parents)}function In(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}In.prototype={constructor:In,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function Th(e){return function(){return e}}function Mh(e,t,n,r,o,s){for(var i=0,a,c=t.length,l=s.length;i<l;++i)(a=t[i])?(a.__data__=s[i],r[i]=a):n[i]=new In(e,s[i]);for(;i<c;++i)(a=t[i])&&(o[i]=a)}function $h(e,t,n,r,o,s,i){var a,c,l=new Map,d=t.length,f=s.length,u=new Array(d),h;for(a=0;a<d;++a)(c=t[a])&&(u[a]=h=i.call(c,c.__data__,a,t)+"",l.has(h)?o[a]=c:l.set(h,c));for(a=0;a<f;++a)h=i.call(e,s[a],a,s)+"",(c=l.get(h))?(r[a]=c,c.__data__=s[a],l.delete(h)):n[a]=new In(e,s[a]);for(a=0;a<d;++a)(c=t[a])&&l.get(u[a])===c&&(o[a]=c)}function Ah(e){return e.__data__}function Dh(e,t){if(!arguments.length)return Array.from(this,Ah);var n=t?$h:Mh,r=this._parents,o=this._groups;typeof e!="function"&&(e=Th(e));for(var s=o.length,i=new Array(s),a=new Array(s),c=new Array(s),l=0;l<s;++l){var d=r[l],f=o[l],u=f.length,h=jh(e.call(d,d&&d.__data__,l,r)),g=h.length,x=a[l]=new Array(g),b=i[l]=new Array(g),_=c[l]=new Array(u);n(d,f,x,b,_,h,t);for(var E=0,m=0,w,T;E<g;++E)if(w=x[E]){for(E>=m&&(m=E+1);!(T=b[m])&&++m<g;);w._next=T||null}}return i=new he(i,r),i._enter=a,i._exit=c,i}function jh(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Rh(){return new he(this._exit||this._groups.map(va),this._parents)}function Ph(e,t,n){var r=this.enter(),o=this,s=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(o=t(o),o&&(o=o.selection())),n==null?s.remove():n(s),r&&o?r.merge(o).order():o}function Oh(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,o=n.length,s=r.length,i=Math.min(o,s),a=new Array(o),c=0;c<i;++c)for(var l=n[c],d=r[c],f=l.length,u=a[c]=new Array(f),h,g=0;g<f;++g)(h=l[g]||d[g])&&(u[g]=h);for(;c<o;++c)a[c]=n[c];return new he(a,this._parents)}function Lh(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],o=r.length-1,s=r[o],i;--o>=0;)(i=r[o])&&(s&&i.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(i,s),s=i);return this}function Hh(e){e||(e=Fh);function t(f,u){return f&&u?e(f.__data__,u.__data__):!f-!u}for(var n=this._groups,r=n.length,o=new Array(r),s=0;s<r;++s){for(var i=n[s],a=i.length,c=o[s]=new Array(a),l,d=0;d<a;++d)(l=i[d])&&(c[d]=l);c.sort(t)}return new he(o,this._parents).order()}function Fh(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function zh(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function Bh(){return Array.from(this)}function Vh(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],o=0,s=r.length;o<s;++o){var i=r[o];if(i)return i}return null}function Wh(){let e=0;for(const t of this)++e;return e}function Yh(){return!this.node()}function Uh(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var o=t[n],s=0,i=o.length,a;s<i;++s)(a=o[s])&&e.call(a,a.__data__,s,o);return this}function Xh(e){return function(){this.removeAttribute(e)}}function Gh(e){return function(){this.removeAttributeNS(e.space,e.local)}}function qh(e,t){return function(){this.setAttribute(e,t)}}function Kh(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Zh(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function Jh(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function Qh(e,t){var n=Yn(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?Gh:Xh:typeof t=="function"?n.local?Jh:Zh:n.local?Kh:qh)(n,t))}function Ea(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function ep(e){return function(){this.style.removeProperty(e)}}function tp(e,t,n){return function(){this.style.setProperty(e,t,n)}}function np(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function rp(e,t,n){return arguments.length>1?this.each((t==null?ep:typeof t=="function"?np:tp)(e,t,n??"")):mt(this.node(),e)}function mt(e,t){return e.style.getPropertyValue(t)||Ea(e).getComputedStyle(e,null).getPropertyValue(t)}function op(e){return function(){delete this[e]}}function sp(e,t){return function(){this[e]=t}}function ip(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function ap(e,t){return arguments.length>1?this.each((t==null?op:typeof t=="function"?ip:sp)(e,t)):this.node()[e]}function Na(e){return e.trim().split(/^|\s+/)}function xo(e){return e.classList||new Sa(e)}function Sa(e){this._node=e,this._names=Na(e.getAttribute("class")||"")}Sa.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Ca(e,t){for(var n=xo(e),r=-1,o=t.length;++r<o;)n.add(t[r])}function ka(e,t){for(var n=xo(e),r=-1,o=t.length;++r<o;)n.remove(t[r])}function cp(e){return function(){Ca(this,e)}}function lp(e){return function(){ka(this,e)}}function up(e,t){return function(){(t.apply(this,arguments)?Ca:ka)(this,e)}}function dp(e,t){var n=Na(e+"");if(arguments.length<2){for(var r=xo(this.node()),o=-1,s=n.length;++o<s;)if(!r.contains(n[o]))return!1;return!0}return this.each((typeof t=="function"?up:t?cp:lp)(n,t))}function fp(){this.textContent=""}function hp(e){return function(){this.textContent=e}}function pp(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function gp(e){return arguments.length?this.each(e==null?fp:(typeof e=="function"?pp:hp)(e)):this.node().textContent}function mp(){this.innerHTML=""}function yp(e){return function(){this.innerHTML=e}}function xp(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function wp(e){return arguments.length?this.each(e==null?mp:(typeof e=="function"?xp:yp)(e)):this.node().innerHTML}function _p(){this.nextSibling&&this.parentNode.appendChild(this)}function bp(){return this.each(_p)}function vp(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Ep(){return this.each(vp)}function Np(e){var t=typeof e=="function"?e:xa(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function Sp(){return null}function Cp(e,t){var n=typeof e=="function"?e:xa(e),r=t==null?Sp:typeof t=="function"?t:yo(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function kp(){var e=this.parentNode;e&&e.removeChild(this)}function Ip(){return this.each(kp)}function Tp(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Mp(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function $p(e){return this.select(e?Mp:Tp)}function Ap(e){return arguments.length?this.property("__data__",e):this.node().__data__}function Dp(e){return function(t){e.call(this,t,this.__data__)}}function jp(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function Rp(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,o=t.length,s;n<o;++n)s=t[n],(!e.type||s.type===e.type)&&s.name===e.name?this.removeEventListener(s.type,s.listener,s.options):t[++r]=s;++r?t.length=r:delete this.__on}}}function Pp(e,t,n){return function(){var r=this.__on,o,s=Dp(t);if(r){for(var i=0,a=r.length;i<a;++i)if((o=r[i]).type===e.type&&o.name===e.name){this.removeEventListener(o.type,o.listener,o.options),this.addEventListener(o.type,o.listener=s,o.options=n),o.value=t;return}}this.addEventListener(e.type,s,n),o={type:e.type,name:e.name,value:t,listener:s,options:n},r?r.push(o):this.__on=[o]}}function Op(e,t,n){var r=jp(e+""),o,s=r.length,i;if(arguments.length<2){var a=this.node().__on;if(a){for(var c=0,l=a.length,d;c<l;++c)for(o=0,d=a[c];o<s;++o)if((i=r[o]).type===d.type&&i.name===d.name)return d.value}return}for(a=t?Pp:Rp,o=0;o<s;++o)this.each(a(r[o],t,n));return this}function Ia(e,t,n){var r=Ea(e),o=r.CustomEvent;typeof o=="function"?o=new o(t,n):(o=r.document.createEvent("Event"),n?(o.initEvent(t,n.bubbles,n.cancelable),o.detail=n.detail):o.initEvent(t,!1,!1)),e.dispatchEvent(o)}function Lp(e,t){return function(){return Ia(this,e,t)}}function Hp(e,t){return function(){return Ia(this,e,t.apply(this,arguments))}}function Fp(e,t){return this.each((typeof t=="function"?Hp:Lp)(e,t))}function*zp(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],o=0,s=r.length,i;o<s;++o)(i=r[o])&&(yield i)}var Ta=[null];function he(e,t){this._groups=e,this._parents=t}function Kt(){return new he([[document.documentElement]],Ta)}function Bp(){return this}he.prototype=Kt.prototype={constructor:he,select:ph,selectAll:xh,selectChild:vh,selectChildren:Ch,filter:kh,data:Dh,enter:Ih,exit:Rh,join:Ph,merge:Oh,selection:Bp,order:Lh,sort:Hh,call:zh,nodes:Bh,node:Vh,size:Wh,empty:Yh,each:Uh,attr:Qh,style:rp,property:ap,classed:dp,text:gp,html:wp,raise:bp,lower:Ep,append:Np,insert:Cp,remove:Ip,clone:$p,datum:Ap,on:Op,dispatch:Fp,[Symbol.iterator]:zp};function fe(e){return typeof e=="string"?new he([[document.querySelector(e)]],[document.documentElement]):new he([[e]],Ta)}function Vp(e){let t;for(;t=e.sourceEvent;)e=t;return e}function me(e,t){if(e=Vp(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var o=t.getBoundingClientRect();return[e.clientX-o.left-t.clientLeft,e.clientY-o.top-t.clientTop]}}return[e.pageX,e.pageY]}const Wp={passive:!1},Ht={capture:!0,passive:!1};function fr(e){e.stopImmediatePropagation()}function ht(e){e.preventDefault(),e.stopImmediatePropagation()}function Ma(e){var t=e.document.documentElement,n=fe(e).on("dragstart.drag",ht,Ht);"onselectstart"in t?n.on("selectstart.drag",ht,Ht):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function $a(e,t){var n=e.document.documentElement,r=fe(e).on("dragstart.drag",null);t&&(r.on("click.drag",ht,Ht),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const un=e=>()=>e;function Hr(e,{sourceEvent:t,subject:n,target:r,identifier:o,active:s,x:i,y:a,dx:c,dy:l,dispatch:d}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:o,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:i,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:l,enumerable:!0,configurable:!0},_:{value:d}})}Hr.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function Yp(e){return!e.ctrlKey&&!e.button}function Up(){return this.parentNode}function Xp(e,t){return t??{x:e.x,y:e.y}}function Gp(){return navigator.maxTouchPoints||"ontouchstart"in this}function Aa(){var e=Yp,t=Up,n=Xp,r=Gp,o={},s=Wn("start","drag","end"),i=0,a,c,l,d,f=0;function u(w){w.on("mousedown.drag",h).filter(r).on("touchstart.drag",b).on("touchmove.drag",_,Wp).on("touchend.drag touchcancel.drag",E).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(w,T){if(!(d||!e.call(this,w,T))){var $=m(this,t.call(this,w,T),w,T,"mouse");$&&(fe(w.view).on("mousemove.drag",g,Ht).on("mouseup.drag",x,Ht),Ma(w.view),fr(w),l=!1,a=w.clientX,c=w.clientY,$("start",w))}}function g(w){if(ht(w),!l){var T=w.clientX-a,$=w.clientY-c;l=T*T+$*$>f}o.mouse("drag",w)}function x(w){fe(w.view).on("mousemove.drag mouseup.drag",null),$a(w.view,l),ht(w),o.mouse("end",w)}function b(w,T){if(e.call(this,w,T)){var $=w.changedTouches,I=t.call(this,w,T),R=$.length,A,j;for(A=0;A<R;++A)(j=m(this,I,w,T,$[A].identifier,$[A]))&&(fr(w),j("start",w,$[A]))}}function _(w){var T=w.changedTouches,$=T.length,I,R;for(I=0;I<$;++I)(R=o[T[I].identifier])&&(ht(w),R("drag",w,T[I]))}function E(w){var T=w.changedTouches,$=T.length,I,R;for(d&&clearTimeout(d),d=setTimeout(function(){d=null},500),I=0;I<$;++I)(R=o[T[I].identifier])&&(fr(w),R("end",w,T[I]))}function m(w,T,$,I,R,A){var j=s.copy(),H=me(A||$,T),L,O,y;if((y=n.call(w,new Hr("beforestart",{sourceEvent:$,target:u,identifier:R,active:i,x:H[0],y:H[1],dx:0,dy:0,dispatch:j}),I))!=null)return L=y.x-H[0]||0,O=y.y-H[1]||0,function k(N,C,M){var S=H,D;switch(N){case"start":o[R]=k,D=i++;break;case"end":delete o[R],--i;case"drag":H=me(M||C,T),D=i;break}j.call(N,w,new Hr(N,{sourceEvent:C,subject:y,target:u,identifier:R,active:D,x:H[0]+L,y:H[1]+O,dx:H[0]-S[0],dy:H[1]-S[1],dispatch:j}),I)}}return u.filter=function(w){return arguments.length?(e=typeof w=="function"?w:un(!!w),u):e},u.container=function(w){return arguments.length?(t=typeof w=="function"?w:un(w),u):t},u.subject=function(w){return arguments.length?(n=typeof w=="function"?w:un(w),u):n},u.touchable=function(w){return arguments.length?(r=typeof w=="function"?w:un(!!w),u):r},u.on=function(){var w=s.on.apply(s,arguments);return w===s?u:w},u.clickDistance=function(w){return arguments.length?(f=(w=+w)*w,u):Math.sqrt(f)},u}function wo(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Da(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Zt(){}var Ft=.7,Tn=1/Ft,pt="\\s*([+-]?\\d+)\\s*",zt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ne="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",qp=/^#([0-9a-f]{3,8})$/,Kp=new RegExp(`^rgb\\(${pt},${pt},${pt}\\)$`),Zp=new RegExp(`^rgb\\(${Ne},${Ne},${Ne}\\)$`),Jp=new RegExp(`^rgba\\(${pt},${pt},${pt},${zt}\\)$`),Qp=new RegExp(`^rgba\\(${Ne},${Ne},${Ne},${zt}\\)$`),eg=new RegExp(`^hsl\\(${zt},${Ne},${Ne}\\)$`),tg=new RegExp(`^hsla\\(${zt},${Ne},${Ne},${zt}\\)$`),ls={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};wo(Zt,Bt,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:us,formatHex:us,formatHex8:ng,formatHsl:rg,formatRgb:ds,toString:ds});function us(){return this.rgb().formatHex()}function ng(){return this.rgb().formatHex8()}function rg(){return ja(this).formatHsl()}function ds(){return this.rgb().formatRgb()}function Bt(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=qp.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?fs(t):n===3?new de(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?dn(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?dn(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Kp.exec(e))?new de(t[1],t[2],t[3],1):(t=Zp.exec(e))?new de(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Jp.exec(e))?dn(t[1],t[2],t[3],t[4]):(t=Qp.exec(e))?dn(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=eg.exec(e))?gs(t[1],t[2]/100,t[3]/100,1):(t=tg.exec(e))?gs(t[1],t[2]/100,t[3]/100,t[4]):ls.hasOwnProperty(e)?fs(ls[e]):e==="transparent"?new de(NaN,NaN,NaN,0):null}function fs(e){return new de(e>>16&255,e>>8&255,e&255,1)}function dn(e,t,n,r){return r<=0&&(e=t=n=NaN),new de(e,t,n,r)}function og(e){return e instanceof Zt||(e=Bt(e)),e?(e=e.rgb(),new de(e.r,e.g,e.b,e.opacity)):new de}function Fr(e,t,n,r){return arguments.length===1?og(e):new de(e,t,n,r??1)}function de(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}wo(de,Fr,Da(Zt,{brighter(e){return e=e==null?Tn:Math.pow(Tn,e),new de(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Ft:Math.pow(Ft,e),new de(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new de(Ze(this.r),Ze(this.g),Ze(this.b),Mn(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:hs,formatHex:hs,formatHex8:sg,formatRgb:ps,toString:ps}));function hs(){return`#${qe(this.r)}${qe(this.g)}${qe(this.b)}`}function sg(){return`#${qe(this.r)}${qe(this.g)}${qe(this.b)}${qe((isNaN(this.opacity)?1:this.opacity)*255)}`}function ps(){const e=Mn(this.opacity);return`${e===1?"rgb(":"rgba("}${Ze(this.r)}, ${Ze(this.g)}, ${Ze(this.b)}${e===1?")":`, ${e})`}`}function Mn(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Ze(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function qe(e){return e=Ze(e),(e<16?"0":"")+e.toString(16)}function gs(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new we(e,t,n,r)}function ja(e){if(e instanceof we)return new we(e.h,e.s,e.l,e.opacity);if(e instanceof Zt||(e=Bt(e)),!e)return new we;if(e instanceof we)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,o=Math.min(t,n,r),s=Math.max(t,n,r),i=NaN,a=s-o,c=(s+o)/2;return a?(t===s?i=(n-r)/a+(n<r)*6:n===s?i=(r-t)/a+2:i=(t-n)/a+4,a/=c<.5?s+o:2-s-o,i*=60):a=c>0&&c<1?0:i,new we(i,a,c,e.opacity)}function ig(e,t,n,r){return arguments.length===1?ja(e):new we(e,t,n,r??1)}function we(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}wo(we,ig,Da(Zt,{brighter(e){return e=e==null?Tn:Math.pow(Tn,e),new we(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Ft:Math.pow(Ft,e),new we(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,o=2*n-r;return new de(hr(e>=240?e-240:e+120,o,r),hr(e,o,r),hr(e<120?e+240:e-120,o,r),this.opacity)},clamp(){return new we(ms(this.h),fn(this.s),fn(this.l),Mn(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Mn(this.opacity);return`${e===1?"hsl(":"hsla("}${ms(this.h)}, ${fn(this.s)*100}%, ${fn(this.l)*100}%${e===1?")":`, ${e})`}`}}));function ms(e){return e=(e||0)%360,e<0?e+360:e}function fn(e){return Math.max(0,Math.min(1,e||0))}function hr(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const Ra=e=>()=>e;function ag(e,t){return function(n){return e+n*t}}function cg(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function lg(e){return(e=+e)==1?Pa:function(t,n){return n-t?cg(t,n,e):Ra(isNaN(t)?n:t)}}function Pa(e,t){var n=t-e;return n?ag(e,n):Ra(isNaN(e)?t:e)}const ys=function e(t){var n=lg(t);function r(o,s){var i=n((o=Fr(o)).r,(s=Fr(s)).r),a=n(o.g,s.g),c=n(o.b,s.b),l=Pa(o.opacity,s.opacity);return function(d){return o.r=i(d),o.g=a(d),o.b=c(d),o.opacity=l(d),o+""}}return r.gamma=e,r}(1);function Le(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var zr=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,pr=new RegExp(zr.source,"g");function ug(e){return function(){return e}}function dg(e){return function(t){return e(t)+""}}function fg(e,t){var n=zr.lastIndex=pr.lastIndex=0,r,o,s,i=-1,a=[],c=[];for(e=e+"",t=t+"";(r=zr.exec(e))&&(o=pr.exec(t));)(s=o.index)>n&&(s=t.slice(n,s),a[i]?a[i]+=s:a[++i]=s),(r=r[0])===(o=o[0])?a[i]?a[i]+=o:a[++i]=o:(a[++i]=null,c.push({i,x:Le(r,o)})),n=pr.lastIndex;return n<t.length&&(s=t.slice(n),a[i]?a[i]+=s:a[++i]=s),a.length<2?c[0]?dg(c[0].x):ug(t):(t=c.length,function(l){for(var d=0,f;d<t;++d)a[(f=c[d]).i]=f.x(l);return a.join("")})}var xs=180/Math.PI,Br={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Oa(e,t,n,r,o,s){var i,a,c;return(i=Math.sqrt(e*e+t*t))&&(e/=i,t/=i),(c=e*n+t*r)&&(n-=e*c,r-=t*c),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,c/=a),e*r<t*n&&(e=-e,t=-t,c=-c,i=-i),{translateX:o,translateY:s,rotate:Math.atan2(t,e)*xs,skewX:Math.atan(c)*xs,scaleX:i,scaleY:a}}var hn;function hg(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Br:Oa(t.a,t.b,t.c,t.d,t.e,t.f)}function pg(e){return e==null||(hn||(hn=document.createElementNS("http://www.w3.org/2000/svg","g")),hn.setAttribute("transform",e),!(e=hn.transform.baseVal.consolidate()))?Br:(e=e.matrix,Oa(e.a,e.b,e.c,e.d,e.e,e.f))}function La(e,t,n,r){function o(l){return l.length?l.pop()+" ":""}function s(l,d,f,u,h,g){if(l!==f||d!==u){var x=h.push("translate(",null,t,null,n);g.push({i:x-4,x:Le(l,f)},{i:x-2,x:Le(d,u)})}else(f||u)&&h.push("translate("+f+t+u+n)}function i(l,d,f,u){l!==d?(l-d>180?d+=360:d-l>180&&(l+=360),u.push({i:f.push(o(f)+"rotate(",null,r)-2,x:Le(l,d)})):d&&f.push(o(f)+"rotate("+d+r)}function a(l,d,f,u){l!==d?u.push({i:f.push(o(f)+"skewX(",null,r)-2,x:Le(l,d)}):d&&f.push(o(f)+"skewX("+d+r)}function c(l,d,f,u,h,g){if(l!==f||d!==u){var x=h.push(o(h)+"scale(",null,",",null,")");g.push({i:x-4,x:Le(l,f)},{i:x-2,x:Le(d,u)})}else(f!==1||u!==1)&&h.push(o(h)+"scale("+f+","+u+")")}return function(l,d){var f=[],u=[];return l=e(l),d=e(d),s(l.translateX,l.translateY,d.translateX,d.translateY,f,u),i(l.rotate,d.rotate,f,u),a(l.skewX,d.skewX,f,u),c(l.scaleX,l.scaleY,d.scaleX,d.scaleY,f,u),l=d=null,function(h){for(var g=-1,x=u.length,b;++g<x;)f[(b=u[g]).i]=b.x(h);return f.join("")}}}var gg=La(hg,"px, ","px)","deg)"),mg=La(pg,", ",")",")"),yg=1e-12;function ws(e){return((e=Math.exp(e))+1/e)/2}function xg(e){return((e=Math.exp(e))-1/e)/2}function wg(e){return((e=Math.exp(2*e))-1)/(e+1)}const _g=function e(t,n,r){function o(s,i){var a=s[0],c=s[1],l=s[2],d=i[0],f=i[1],u=i[2],h=d-a,g=f-c,x=h*h+g*g,b,_;if(x<yg)_=Math.log(u/l)/t,b=function(I){return[a+I*h,c+I*g,l*Math.exp(t*I*_)]};else{var E=Math.sqrt(x),m=(u*u-l*l+r*x)/(2*l*n*E),w=(u*u-l*l-r*x)/(2*u*n*E),T=Math.log(Math.sqrt(m*m+1)-m),$=Math.log(Math.sqrt(w*w+1)-w);_=($-T)/t,b=function(I){var R=I*_,A=ws(T),j=l/(n*E)*(A*wg(t*R+T)-xg(T));return[a+j*h,c+j*g,l*A/ws(t*R+T)]}}return b.duration=_*1e3*t/Math.SQRT2,b}return o.rho=function(s){var i=Math.max(.001,+s),a=i*i,c=a*a;return e(i,a,c)},o}(Math.SQRT2,2,4);var yt=0,jt=0,Mt=0,Ha=1e3,$n,Rt,An=0,tt=0,Un=0,Vt=typeof performance=="object"&&performance.now?performance:Date,Fa=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function _o(){return tt||(Fa(bg),tt=Vt.now()+Un)}function bg(){tt=0}function Dn(){this._call=this._time=this._next=null}Dn.prototype=za.prototype={constructor:Dn,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?_o():+n)+(t==null?0:+t),!this._next&&Rt!==this&&(Rt?Rt._next=this:$n=this,Rt=this),this._call=e,this._time=n,Vr()},stop:function(){this._call&&(this._call=null,this._time=1/0,Vr())}};function za(e,t,n){var r=new Dn;return r.restart(e,t,n),r}function vg(){_o(),++yt;for(var e=$n,t;e;)(t=tt-e._time)>=0&&e._call.call(void 0,t),e=e._next;--yt}function _s(){tt=(An=Vt.now())+Un,yt=jt=0;try{vg()}finally{yt=0,Ng(),tt=0}}function Eg(){var e=Vt.now(),t=e-An;t>Ha&&(Un-=t,An=e)}function Ng(){for(var e,t=$n,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:$n=n);Rt=e,Vr(r)}function Vr(e){if(!yt){jt&&(jt=clearTimeout(jt));var t=e-tt;t>24?(e<1/0&&(jt=setTimeout(_s,e-Vt.now()-Un)),Mt&&(Mt=clearInterval(Mt))):(Mt||(An=Vt.now(),Mt=setInterval(Eg,Ha)),yt=1,Fa(_s))}}function bs(e,t,n){var r=new Dn;return t=t==null?0:+t,r.restart(o=>{r.stop(),e(o+t)},t,n),r}var Sg=Wn("start","end","cancel","interrupt"),Cg=[],Ba=0,vs=1,Wr=2,bn=3,Es=4,Yr=5,vn=6;function Xn(e,t,n,r,o,s){var i=e.__transition;if(!i)e.__transition={};else if(n in i)return;kg(e,n,{name:t,index:r,group:o,on:Sg,tween:Cg,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:Ba})}function bo(e,t){var n=Ee(e,t);if(n.state>Ba)throw new Error("too late; already scheduled");return n}function Ce(e,t){var n=Ee(e,t);if(n.state>bn)throw new Error("too late; already running");return n}function Ee(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function kg(e,t,n){var r=e.__transition,o;r[t]=n,n.timer=za(s,0,n.time);function s(l){n.state=vs,n.timer.restart(i,n.delay,n.time),n.delay<=l&&i(l-n.delay)}function i(l){var d,f,u,h;if(n.state!==vs)return c();for(d in r)if(h=r[d],h.name===n.name){if(h.state===bn)return bs(i);h.state===Es?(h.state=vn,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete r[d]):+d<t&&(h.state=vn,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete r[d])}if(bs(function(){n.state===bn&&(n.state=Es,n.timer.restart(a,n.delay,n.time),a(l))}),n.state=Wr,n.on.call("start",e,e.__data__,n.index,n.group),n.state===Wr){for(n.state=bn,o=new Array(u=n.tween.length),d=0,f=-1;d<u;++d)(h=n.tween[d].value.call(e,e.__data__,n.index,n.group))&&(o[++f]=h);o.length=f+1}}function a(l){for(var d=l<n.duration?n.ease.call(null,l/n.duration):(n.timer.restart(c),n.state=Yr,1),f=-1,u=o.length;++f<u;)o[f].call(e,d);n.state===Yr&&(n.on.call("end",e,e.__data__,n.index,n.group),c())}function c(){n.state=vn,n.timer.stop(),delete r[t];for(var l in r)return;delete e.__transition}}function En(e,t){var n=e.__transition,r,o,s=!0,i;if(n){t=t==null?null:t+"";for(i in n){if((r=n[i]).name!==t){s=!1;continue}o=r.state>Wr&&r.state<Yr,r.state=vn,r.timer.stop(),r.on.call(o?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[i]}s&&delete e.__transition}}function Ig(e){return this.each(function(){En(this,e)})}function Tg(e,t){var n,r;return function(){var o=Ce(this,e),s=o.tween;if(s!==n){r=n=s;for(var i=0,a=r.length;i<a;++i)if(r[i].name===t){r=r.slice(),r.splice(i,1);break}}o.tween=r}}function Mg(e,t,n){var r,o;if(typeof n!="function")throw new Error;return function(){var s=Ce(this,e),i=s.tween;if(i!==r){o=(r=i).slice();for(var a={name:t,value:n},c=0,l=o.length;c<l;++c)if(o[c].name===t){o[c]=a;break}c===l&&o.push(a)}s.tween=o}}function $g(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=Ee(this.node(),n).tween,o=0,s=r.length,i;o<s;++o)if((i=r[o]).name===e)return i.value;return null}return this.each((t==null?Tg:Mg)(n,e,t))}function vo(e,t,n){var r=e._id;return e.each(function(){var o=Ce(this,r);(o.value||(o.value={}))[t]=n.apply(this,arguments)}),function(o){return Ee(o,r).value[t]}}function Va(e,t){var n;return(typeof t=="number"?Le:t instanceof Bt?ys:(n=Bt(t))?(t=n,ys):fg)(e,t)}function Ag(e){return function(){this.removeAttribute(e)}}function Dg(e){return function(){this.removeAttributeNS(e.space,e.local)}}function jg(e,t,n){var r,o=n+"",s;return function(){var i=this.getAttribute(e);return i===o?null:i===r?s:s=t(r=i,n)}}function Rg(e,t,n){var r,o=n+"",s;return function(){var i=this.getAttributeNS(e.space,e.local);return i===o?null:i===r?s:s=t(r=i,n)}}function Pg(e,t,n){var r,o,s;return function(){var i,a=n(this),c;return a==null?void this.removeAttribute(e):(i=this.getAttribute(e),c=a+"",i===c?null:i===r&&c===o?s:(o=c,s=t(r=i,a)))}}function Og(e,t,n){var r,o,s;return function(){var i,a=n(this),c;return a==null?void this.removeAttributeNS(e.space,e.local):(i=this.getAttributeNS(e.space,e.local),c=a+"",i===c?null:i===r&&c===o?s:(o=c,s=t(r=i,a)))}}function Lg(e,t){var n=Yn(e),r=n==="transform"?mg:Va;return this.attrTween(e,typeof t=="function"?(n.local?Og:Pg)(n,r,vo(this,"attr."+e,t)):t==null?(n.local?Dg:Ag)(n):(n.local?Rg:jg)(n,r,t))}function Hg(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function Fg(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function zg(e,t){var n,r;function o(){var s=t.apply(this,arguments);return s!==r&&(n=(r=s)&&Fg(e,s)),n}return o._value=t,o}function Bg(e,t){var n,r;function o(){var s=t.apply(this,arguments);return s!==r&&(n=(r=s)&&Hg(e,s)),n}return o._value=t,o}function Vg(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=Yn(e);return this.tween(n,(r.local?zg:Bg)(r,t))}function Wg(e,t){return function(){bo(this,e).delay=+t.apply(this,arguments)}}function Yg(e,t){return t=+t,function(){bo(this,e).delay=t}}function Ug(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Wg:Yg)(t,e)):Ee(this.node(),t).delay}function Xg(e,t){return function(){Ce(this,e).duration=+t.apply(this,arguments)}}function Gg(e,t){return t=+t,function(){Ce(this,e).duration=t}}function qg(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Xg:Gg)(t,e)):Ee(this.node(),t).duration}function Kg(e,t){if(typeof t!="function")throw new Error;return function(){Ce(this,e).ease=t}}function Zg(e){var t=this._id;return arguments.length?this.each(Kg(t,e)):Ee(this.node(),t).ease}function Jg(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;Ce(this,e).ease=n}}function Qg(e){if(typeof e!="function")throw new Error;return this.each(Jg(this._id,e))}function em(e){typeof e!="function"&&(e=_a(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var s=t[o],i=s.length,a=r[o]=[],c,l=0;l<i;++l)(c=s[l])&&e.call(c,c.__data__,l,s)&&a.push(c);return new Ae(r,this._parents,this._name,this._id)}function tm(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,o=n.length,s=Math.min(r,o),i=new Array(r),a=0;a<s;++a)for(var c=t[a],l=n[a],d=c.length,f=i[a]=new Array(d),u,h=0;h<d;++h)(u=c[h]||l[h])&&(f[h]=u);for(;a<r;++a)i[a]=t[a];return new Ae(i,this._parents,this._name,this._id)}function nm(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function rm(e,t,n){var r,o,s=nm(t)?bo:Ce;return function(){var i=s(this,e),a=i.on;a!==r&&(o=(r=a).copy()).on(t,n),i.on=o}}function om(e,t){var n=this._id;return arguments.length<2?Ee(this.node(),n).on.on(e):this.each(rm(n,e,t))}function sm(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function im(){return this.on("end.remove",sm(this._id))}function am(e){var t=this._name,n=this._id;typeof e!="function"&&(e=yo(e));for(var r=this._groups,o=r.length,s=new Array(o),i=0;i<o;++i)for(var a=r[i],c=a.length,l=s[i]=new Array(c),d,f,u=0;u<c;++u)(d=a[u])&&(f=e.call(d,d.__data__,u,a))&&("__data__"in d&&(f.__data__=d.__data__),l[u]=f,Xn(l[u],t,n,u,l,Ee(d,n)));return new Ae(s,this._parents,t,n)}function cm(e){var t=this._name,n=this._id;typeof e!="function"&&(e=wa(e));for(var r=this._groups,o=r.length,s=[],i=[],a=0;a<o;++a)for(var c=r[a],l=c.length,d,f=0;f<l;++f)if(d=c[f]){for(var u=e.call(d,d.__data__,f,c),h,g=Ee(d,n),x=0,b=u.length;x<b;++x)(h=u[x])&&Xn(h,t,n,x,u,g);s.push(u),i.push(d)}return new Ae(s,i,t,n)}var lm=Kt.prototype.constructor;function um(){return new lm(this._groups,this._parents)}function dm(e,t){var n,r,o;return function(){var s=mt(this,e),i=(this.style.removeProperty(e),mt(this,e));return s===i?null:s===n&&i===r?o:o=t(n=s,r=i)}}function Wa(e){return function(){this.style.removeProperty(e)}}function fm(e,t,n){var r,o=n+"",s;return function(){var i=mt(this,e);return i===o?null:i===r?s:s=t(r=i,n)}}function hm(e,t,n){var r,o,s;return function(){var i=mt(this,e),a=n(this),c=a+"";return a==null&&(c=a=(this.style.removeProperty(e),mt(this,e))),i===c?null:i===r&&c===o?s:(o=c,s=t(r=i,a))}}function pm(e,t){var n,r,o,s="style."+t,i="end."+s,a;return function(){var c=Ce(this,e),l=c.on,d=c.value[s]==null?a||(a=Wa(t)):void 0;(l!==n||o!==d)&&(r=(n=l).copy()).on(i,o=d),c.on=r}}function gm(e,t,n){var r=(e+="")=="transform"?gg:Va;return t==null?this.styleTween(e,dm(e,r)).on("end.style."+e,Wa(e)):typeof t=="function"?this.styleTween(e,hm(e,r,vo(this,"style."+e,t))).each(pm(this._id,e)):this.styleTween(e,fm(e,r,t),n).on("end.style."+e,null)}function mm(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function ym(e,t,n){var r,o;function s(){var i=t.apply(this,arguments);return i!==o&&(r=(o=i)&&mm(e,i,n)),r}return s._value=t,s}function xm(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,ym(e,t,n??""))}function wm(e){return function(){this.textContent=e}}function _m(e){return function(){var t=e(this);this.textContent=t??""}}function bm(e){return this.tween("text",typeof e=="function"?_m(vo(this,"text",e)):wm(e==null?"":e+""))}function vm(e){return function(t){this.textContent=e.call(this,t)}}function Em(e){var t,n;function r(){var o=e.apply(this,arguments);return o!==n&&(t=(n=o)&&vm(o)),t}return r._value=e,r}function Nm(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,Em(e))}function Sm(){for(var e=this._name,t=this._id,n=Ya(),r=this._groups,o=r.length,s=0;s<o;++s)for(var i=r[s],a=i.length,c,l=0;l<a;++l)if(c=i[l]){var d=Ee(c,t);Xn(c,e,n,l,i,{time:d.time+d.delay+d.duration,delay:0,duration:d.duration,ease:d.ease})}return new Ae(r,this._parents,e,n)}function Cm(){var e,t,n=this,r=n._id,o=n.size();return new Promise(function(s,i){var a={value:i},c={value:function(){--o===0&&s()}};n.each(function(){var l=Ce(this,r),d=l.on;d!==e&&(t=(e=d).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(c)),l.on=t}),o===0&&s()})}var km=0;function Ae(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function Ya(){return++km}var ke=Kt.prototype;Ae.prototype={constructor:Ae,select:am,selectAll:cm,selectChild:ke.selectChild,selectChildren:ke.selectChildren,filter:em,merge:tm,selection:um,transition:Sm,call:ke.call,nodes:ke.nodes,node:ke.node,size:ke.size,empty:ke.empty,each:ke.each,on:om,attr:Lg,attrTween:Vg,style:gm,styleTween:xm,text:bm,textTween:Nm,remove:im,tween:$g,delay:Ug,duration:qg,ease:Zg,easeVarying:Qg,end:Cm,[Symbol.iterator]:ke[Symbol.iterator]};function Im(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var Tm={time:null,delay:0,duration:250,ease:Im};function Mm(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function $m(e){var t,n;e instanceof Ae?(t=e._id,e=e._name):(t=Ya(),(n=Tm).time=_o(),e=e==null?null:e+"");for(var r=this._groups,o=r.length,s=0;s<o;++s)for(var i=r[s],a=i.length,c,l=0;l<a;++l)(c=i[l])&&Xn(c,e,t,l,i,n||Mm(c,t));return new Ae(r,this._parents,e,t)}Kt.prototype.interrupt=Ig;Kt.prototype.transition=$m;const pn=e=>()=>e;function Am(e,{sourceEvent:t,target:n,transform:r,dispatch:o}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:o}})}function Te(e,t,n){this.k=e,this.x=t,this.y=n}Te.prototype={constructor:Te,scale:function(e){return e===1?this:new Te(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Te(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Gn=new Te(1,0,0);Ua.prototype=Te.prototype;function Ua(e){for(;!e.__zoom;)if(!(e=e.parentNode))return Gn;return e.__zoom}function gr(e){e.stopImmediatePropagation()}function $t(e){e.preventDefault(),e.stopImmediatePropagation()}function Dm(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function jm(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function Ns(){return this.__zoom||Gn}function Rm(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function Pm(){return navigator.maxTouchPoints||"ontouchstart"in this}function Om(e,t,n){var r=e.invertX(t[0][0])-n[0][0],o=e.invertX(t[1][0])-n[1][0],s=e.invertY(t[0][1])-n[0][1],i=e.invertY(t[1][1])-n[1][1];return e.translate(o>r?(r+o)/2:Math.min(0,r)||Math.max(0,o),i>s?(s+i)/2:Math.min(0,s)||Math.max(0,i))}function Xa(){var e=Dm,t=jm,n=Om,r=Rm,o=Pm,s=[0,1/0],i=[[-1/0,-1/0],[1/0,1/0]],a=250,c=_g,l=Wn("start","zoom","end"),d,f,u,h=500,g=150,x=0,b=10;function _(y){y.property("__zoom",Ns).on("wheel.zoom",R,{passive:!1}).on("mousedown.zoom",A).on("dblclick.zoom",j).filter(o).on("touchstart.zoom",H).on("touchmove.zoom",L).on("touchend.zoom touchcancel.zoom",O).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}_.transform=function(y,k,N,C){var M=y.selection?y.selection():y;M.property("__zoom",Ns),y!==M?T(y,k,N,C):M.interrupt().each(function(){$(this,arguments).event(C).start().zoom(null,typeof k=="function"?k.apply(this,arguments):k).end()})},_.scaleBy=function(y,k,N,C){_.scaleTo(y,function(){var M=this.__zoom.k,S=typeof k=="function"?k.apply(this,arguments):k;return M*S},N,C)},_.scaleTo=function(y,k,N,C){_.transform(y,function(){var M=t.apply(this,arguments),S=this.__zoom,D=N==null?w(M):typeof N=="function"?N.apply(this,arguments):N,F=S.invert(D),V=typeof k=="function"?k.apply(this,arguments):k;return n(m(E(S,V),D,F),M,i)},N,C)},_.translateBy=function(y,k,N,C){_.transform(y,function(){return n(this.__zoom.translate(typeof k=="function"?k.apply(this,arguments):k,typeof N=="function"?N.apply(this,arguments):N),t.apply(this,arguments),i)},null,C)},_.translateTo=function(y,k,N,C,M){_.transform(y,function(){var S=t.apply(this,arguments),D=this.__zoom,F=C==null?w(S):typeof C=="function"?C.apply(this,arguments):C;return n(Gn.translate(F[0],F[1]).scale(D.k).translate(typeof k=="function"?-k.apply(this,arguments):-k,typeof N=="function"?-N.apply(this,arguments):-N),S,i)},C,M)};function E(y,k){return k=Math.max(s[0],Math.min(s[1],k)),k===y.k?y:new Te(k,y.x,y.y)}function m(y,k,N){var C=k[0]-N[0]*y.k,M=k[1]-N[1]*y.k;return C===y.x&&M===y.y?y:new Te(y.k,C,M)}function w(y){return[(+y[0][0]+ +y[1][0])/2,(+y[0][1]+ +y[1][1])/2]}function T(y,k,N,C){y.on("start.zoom",function(){$(this,arguments).event(C).start()}).on("interrupt.zoom end.zoom",function(){$(this,arguments).event(C).end()}).tween("zoom",function(){var M=this,S=arguments,D=$(M,S).event(C),F=t.apply(M,S),V=N==null?w(F):typeof N=="function"?N.apply(M,S):N,Y=Math.max(F[1][0]-F[0][0],F[1][1]-F[0][1]),U=M.__zoom,P=typeof k=="function"?k.apply(M,S):k,B=c(U.invert(V).concat(Y/U.k),P.invert(V).concat(Y/P.k));return function(z){if(z===1)z=P;else{var W=B(z),q=Y/W[2];z=new Te(q,V[0]-W[0]*q,V[1]-W[1]*q)}D.zoom(null,z)}})}function $(y,k,N){return!N&&y.__zooming||new I(y,k)}function I(y,k){this.that=y,this.args=k,this.active=0,this.sourceEvent=null,this.extent=t.apply(y,k),this.taps=0}I.prototype={event:function(y){return y&&(this.sourceEvent=y),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(y,k){return this.mouse&&y!=="mouse"&&(this.mouse[1]=k.invert(this.mouse[0])),this.touch0&&y!=="touch"&&(this.touch0[1]=k.invert(this.touch0[0])),this.touch1&&y!=="touch"&&(this.touch1[1]=k.invert(this.touch1[0])),this.that.__zoom=k,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(y){var k=fe(this.that).datum();l.call(y,this.that,new Am(y,{sourceEvent:this.sourceEvent,target:_,transform:this.that.__zoom,dispatch:l}),k)}};function R(y,...k){if(!e.apply(this,arguments))return;var N=$(this,k).event(y),C=this.__zoom,M=Math.max(s[0],Math.min(s[1],C.k*Math.pow(2,r.apply(this,arguments)))),S=me(y);if(N.wheel)(N.mouse[0][0]!==S[0]||N.mouse[0][1]!==S[1])&&(N.mouse[1]=C.invert(N.mouse[0]=S)),clearTimeout(N.wheel);else{if(C.k===M)return;N.mouse=[S,C.invert(S)],En(this),N.start()}$t(y),N.wheel=setTimeout(D,g),N.zoom("mouse",n(m(E(C,M),N.mouse[0],N.mouse[1]),N.extent,i));function D(){N.wheel=null,N.end()}}function A(y,...k){if(u||!e.apply(this,arguments))return;var N=y.currentTarget,C=$(this,k,!0).event(y),M=fe(y.view).on("mousemove.zoom",V,!0).on("mouseup.zoom",Y,!0),S=me(y,N),D=y.clientX,F=y.clientY;Ma(y.view),gr(y),C.mouse=[S,this.__zoom.invert(S)],En(this),C.start();function V(U){if($t(U),!C.moved){var P=U.clientX-D,B=U.clientY-F;C.moved=P*P+B*B>x}C.event(U).zoom("mouse",n(m(C.that.__zoom,C.mouse[0]=me(U,N),C.mouse[1]),C.extent,i))}function Y(U){M.on("mousemove.zoom mouseup.zoom",null),$a(U.view,C.moved),$t(U),C.event(U).end()}}function j(y,...k){if(e.apply(this,arguments)){var N=this.__zoom,C=me(y.changedTouches?y.changedTouches[0]:y,this),M=N.invert(C),S=N.k*(y.shiftKey?.5:2),D=n(m(E(N,S),C,M),t.apply(this,k),i);$t(y),a>0?fe(this).transition().duration(a).call(T,D,C,y):fe(this).call(_.transform,D,C,y)}}function H(y,...k){if(e.apply(this,arguments)){var N=y.touches,C=N.length,M=$(this,k,y.changedTouches.length===C).event(y),S,D,F,V;for(gr(y),D=0;D<C;++D)F=N[D],V=me(F,this),V=[V,this.__zoom.invert(V),F.identifier],M.touch0?!M.touch1&&M.touch0[2]!==V[2]&&(M.touch1=V,M.taps=0):(M.touch0=V,S=!0,M.taps=1+!!d);d&&(d=clearTimeout(d)),S&&(M.taps<2&&(f=V[0],d=setTimeout(function(){d=null},h)),En(this),M.start())}}function L(y,...k){if(this.__zooming){var N=$(this,k).event(y),C=y.changedTouches,M=C.length,S,D,F,V;for($t(y),S=0;S<M;++S)D=C[S],F=me(D,this),N.touch0&&N.touch0[2]===D.identifier?N.touch0[0]=F:N.touch1&&N.touch1[2]===D.identifier&&(N.touch1[0]=F);if(D=N.that.__zoom,N.touch1){var Y=N.touch0[0],U=N.touch0[1],P=N.touch1[0],B=N.touch1[1],z=(z=P[0]-Y[0])*z+(z=P[1]-Y[1])*z,W=(W=B[0]-U[0])*W+(W=B[1]-U[1])*W;D=E(D,Math.sqrt(z/W)),F=[(Y[0]+P[0])/2,(Y[1]+P[1])/2],V=[(U[0]+B[0])/2,(U[1]+B[1])/2]}else if(N.touch0)F=N.touch0[0],V=N.touch0[1];else return;N.zoom("touch",n(m(D,F,V),N.extent,i))}}function O(y,...k){if(this.__zooming){var N=$(this,k).event(y),C=y.changedTouches,M=C.length,S,D;for(gr(y),u&&clearTimeout(u),u=setTimeout(function(){u=null},h),S=0;S<M;++S)D=C[S],N.touch0&&N.touch0[2]===D.identifier?delete N.touch0:N.touch1&&N.touch1[2]===D.identifier&&delete N.touch1;if(N.touch1&&!N.touch0&&(N.touch0=N.touch1,delete N.touch1),N.touch0)N.touch0[1]=this.__zoom.invert(N.touch0[0]);else if(N.end(),N.taps===2&&(D=me(D,this),Math.hypot(f[0]-D[0],f[1]-D[1])<b)){var F=fe(this).on("dblclick.zoom");F&&F.apply(this,arguments)}}}return _.wheelDelta=function(y){return arguments.length?(r=typeof y=="function"?y:pn(+y),_):r},_.filter=function(y){return arguments.length?(e=typeof y=="function"?y:pn(!!y),_):e},_.touchable=function(y){return arguments.length?(o=typeof y=="function"?y:pn(!!y),_):o},_.extent=function(y){return arguments.length?(t=typeof y=="function"?y:pn([[+y[0][0],+y[0][1]],[+y[1][0],+y[1][1]]]),_):t},_.scaleExtent=function(y){return arguments.length?(s[0]=+y[0],s[1]=+y[1],_):[s[0],s[1]]},_.translateExtent=function(y){return arguments.length?(i[0][0]=+y[0][0],i[1][0]=+y[1][0],i[0][1]=+y[0][1],i[1][1]=+y[1][1],_):[[i[0][0],i[0][1]],[i[1][0],i[1][1]]]},_.constrain=function(y){return arguments.length?(n=y,_):n},_.duration=function(y){return arguments.length?(a=+y,_):a},_.interpolate=function(y){return arguments.length?(c=y,_):c},_.on=function(){var y=l.on.apply(l,arguments);return y===l?_:y},_.clickDistance=function(y){return arguments.length?(x=(y=+y)*y,_):Math.sqrt(x)},_.tapDistance=function(y){return arguments.length?(b=+y,_):b},_}const Se={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,{id:t,sourceHandle:n,targetHandle:r})=>`Couldn't create edge for ${e} handle id: "${e==="source"?n:r}", edge id: ${t}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(e="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},Wt=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],Ga=["Enter"," ","Escape"];var xt;(function(e){e.Strict="strict",e.Loose="loose"})(xt||(xt={}));var Je;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(Je||(Je={}));var Yt;(function(e){e.Partial="partial",e.Full="full"})(Yt||(Yt={}));const qa={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null};var Fe;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(Fe||(Fe={}));var jn;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(jn||(jn={}));var X;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(X||(X={}));const Ss={[X.Left]:X.Right,[X.Right]:X.Left,[X.Top]:X.Bottom,[X.Bottom]:X.Top};function Ka(e){return e===null?null:e?"valid":"invalid"}const Za=e=>"id"in e&&"source"in e&&"target"in e,Lm=e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e),Eo=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e),Jt=(e,t=[0,0])=>{const{width:n,height:r}=je(e),o=e.origin??t,s=n*o[0],i=r*o[1];return{x:e.position.x-s,y:e.position.y-i}},Hm=(e,t={nodeOrigin:[0,0],nodeLookup:void 0})=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((r,o)=>{const s=typeof o=="string";let i=!t.nodeLookup&&!s?o:void 0;t.nodeLookup&&(i=s?t.nodeLookup.get(o):Eo(o)?o:t.nodeLookup.get(o.id));const a=i?Rn(i,t.nodeOrigin):{x:0,y:0,x2:0,y2:0};return qn(r,a)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return Kn(n)},Qt=(e,t={})=>{if(e.size===0)return{x:0,y:0,width:0,height:0};let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0};return e.forEach(r=>{if(t.filter===void 0||t.filter(r)){const o=Rn(r);n=qn(n,o)}}),Kn(n)},Ja=(e,t,[n,r,o]=[0,0,1],s=!1,i=!1)=>{const a={...en(t,[n,r,o]),width:t.width/o,height:t.height/o},c=[];for(const l of e.values()){const{measured:d,selectable:f=!0,hidden:u=!1}=l;if(i&&!f||u)continue;const h=d.width??l.width??l.initialWidth??null,g=d.height??l.height??l.initialHeight??null,x=Ut(a,_t(l)),b=(h??0)*(g??0),_=s&&x>0;(!l.internals.handleBounds||_||x>=b||l.dragging)&&c.push(l)}return c},Fm=(e,t)=>{const n=new Set;return e.forEach(r=>{n.add(r.id)}),t.filter(r=>n.has(r.source)||n.has(r.target))};function zm(e,t){const n=new Map,r=t!=null&&t.nodes?new Set(t.nodes.map(o=>o.id)):null;return e.forEach(o=>{o.measured.width&&o.measured.height&&((t==null?void 0:t.includeHiddenNodes)||!o.hidden)&&(!r||r.has(o.id))&&n.set(o.id,o)}),n}async function Bm({nodes:e,width:t,height:n,panZoom:r,minZoom:o,maxZoom:s},i){if(e.size===0)return Promise.resolve(!0);const a=zm(e,i),c=Qt(a),l=No(c,t,n,(i==null?void 0:i.minZoom)??o,(i==null?void 0:i.maxZoom)??s,(i==null?void 0:i.padding)??.1);return await r.setViewport(l,{duration:i==null?void 0:i.duration}),Promise.resolve(!0)}function Qa({nodeId:e,nextPosition:t,nodeLookup:n,nodeOrigin:r=[0,0],nodeExtent:o,onError:s}){const i=n.get(e),a=i.parentId?n.get(i.parentId):void 0,{x:c,y:l}=a?a.internals.positionAbsolute:{x:0,y:0},d=i.origin??r;let f=o;if(i.extent==="parent"&&!i.expandParent)if(!a)s==null||s("005",Se.error005());else{const h=a.measured.width,g=a.measured.height;h&&g&&(f=[[c,l],[c+h,l+g]])}else a&&bt(i.extent)&&(f=[[i.extent[0][0]+c,i.extent[0][1]+l],[i.extent[1][0]+c,i.extent[1][1]+l]]);const u=bt(f)?nt(t,f,i.measured):t;return(i.measured.width===void 0||i.measured.height===void 0)&&(s==null||s("015",Se.error015())),{position:{x:u.x-c+(i.measured.width??0)*d[0],y:u.y-l+(i.measured.height??0)*d[1]},positionAbsolute:u}}async function Vm({nodesToRemove:e=[],edgesToRemove:t=[],nodes:n,edges:r,onBeforeDelete:o}){const s=new Set(e.map(u=>u.id)),i=[];for(const u of n){if(u.deletable===!1)continue;const h=s.has(u.id),g=!h&&u.parentId&&i.find(x=>x.id===u.parentId);(h||g)&&i.push(u)}const a=new Set(t.map(u=>u.id)),c=r.filter(u=>u.deletable!==!1),d=Fm(i,c);for(const u of c)a.has(u.id)&&!d.find(g=>g.id===u.id)&&d.push(u);if(!o)return{edges:d,nodes:i};const f=await o({nodes:i,edges:d});return typeof f=="boolean"?f?{edges:d,nodes:i}:{edges:[],nodes:[]}:f}const wt=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),nt=(e={x:0,y:0},t,n)=>({x:wt(e.x,t[0][0],t[1][0]-((n==null?void 0:n.width)??0)),y:wt(e.y,t[0][1],t[1][1]-((n==null?void 0:n.height)??0))});function ec(e,t,n){const{width:r,height:o}=je(n),{x:s,y:i}=n.internals.positionAbsolute;return nt(e,[[s,i],[s+r,i+o]],t)}const Cs=(e,t,n)=>e<t?wt(Math.abs(e-t),1,t)/t:e>n?-wt(Math.abs(e-n),1,t)/t:0,tc=(e,t,n=15,r=40)=>{const o=Cs(e.x,r,t.width-r)*n,s=Cs(e.y,r,t.height-r)*n;return[o,s]},qn=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),Ur=({x:e,y:t,width:n,height:r})=>({x:e,y:t,x2:e+n,y2:t+r}),Kn=({x:e,y:t,x2:n,y2:r})=>({x:e,y:t,width:n-e,height:r-t}),_t=(e,t=[0,0])=>{var o,s;const{x:n,y:r}=Eo(e)?e.internals.positionAbsolute:Jt(e,t);return{x:n,y:r,width:((o=e.measured)==null?void 0:o.width)??e.width??e.initialWidth??0,height:((s=e.measured)==null?void 0:s.height)??e.height??e.initialHeight??0}},Rn=(e,t=[0,0])=>{var o,s;const{x:n,y:r}=Eo(e)?e.internals.positionAbsolute:Jt(e,t);return{x:n,y:r,x2:n+(((o=e.measured)==null?void 0:o.width)??e.width??e.initialWidth??0),y2:r+(((s=e.measured)==null?void 0:s.height)??e.height??e.initialHeight??0)}},nc=(e,t)=>Kn(qn(Ur(e),Ur(t))),Ut=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),r=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*r)},ks=e=>_e(e.width)&&_e(e.height)&&_e(e.x)&&_e(e.y),_e=e=>!isNaN(e)&&isFinite(e),Wm=(e,t)=>{},Zn=(e,t=[1,1])=>({x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}),en=({x:e,y:t},[n,r,o],s=!1,i=[1,1])=>{const a={x:(e-n)/o,y:(t-r)/o};return s?Zn(a,i):a},Pn=({x:e,y:t},[n,r,o])=>({x:e*o+n,y:t*o+r});function at(e,t){if(typeof e=="number")return Math.floor(t-t/(1+e));if(typeof e=="string"&&e.endsWith("px")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(n)}if(typeof e=="string"&&e.endsWith("%")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(t*n*.01)}return console.error(`[React Flow] The padding value "${e}" is invalid. Please provide a number or a string with a valid unit (px or %).`),0}function Ym(e,t,n){if(typeof e=="string"||typeof e=="number"){const r=at(e,n),o=at(e,t);return{top:r,right:o,bottom:r,left:o,x:o*2,y:r*2}}if(typeof e=="object"){const r=at(e.top??e.y??0,n),o=at(e.bottom??e.y??0,n),s=at(e.left??e.x??0,t),i=at(e.right??e.x??0,t);return{top:r,right:i,bottom:o,left:s,x:s+i,y:r+o}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}function Um(e,t,n,r,o,s){const{x:i,y:a}=Pn(e,[t,n,r]),{x:c,y:l}=Pn({x:e.x+e.width,y:e.y+e.height},[t,n,r]),d=o-c,f=s-l;return{left:Math.floor(i),top:Math.floor(a),right:Math.floor(d),bottom:Math.floor(f)}}const No=(e,t,n,r,o,s)=>{const i=Ym(s,t,n),a=(t-i.x)/e.width,c=(n-i.y)/e.height,l=Math.min(a,c),d=wt(l,r,o),f=e.x+e.width/2,u=e.y+e.height/2,h=t/2-f*d,g=n/2-u*d,x=Um(e,h,g,d,t,n),b={left:Math.min(x.left-i.left,0),top:Math.min(x.top-i.top,0),right:Math.min(x.right-i.right,0),bottom:Math.min(x.bottom-i.bottom,0)};return{x:h-b.left+b.right,y:g-b.top+b.bottom,zoom:d}},On=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0};function bt(e){return e!==void 0&&e!=="parent"}function je(e){var t,n;return{width:((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth??0,height:((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight??0}}function rc(e){var t,n;return(((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth)!==void 0&&(((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight)!==void 0}function oc(e,t={width:0,height:0},n,r,o){const s={...e},i=r.get(n);if(i){const a=i.origin||o;s.x+=i.internals.positionAbsolute.x-(t.width??0)*a[0],s.y+=i.internals.positionAbsolute.y-(t.height??0)*a[1]}return s}function Is(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function Ot(e,{snapGrid:t=[0,0],snapToGrid:n=!1,transform:r,containerBounds:o}){const{x:s,y:i}=$e(e),a=en({x:s-((o==null?void 0:o.left)??0),y:i-((o==null?void 0:o.top)??0)},r),{x:c,y:l}=n?Zn(a,t):a;return{xSnapped:c,ySnapped:l,...a}}const So=e=>({width:e.offsetWidth,height:e.offsetHeight}),sc=e=>{var t;return((t=e==null?void 0:e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},Xm=["INPUT","SELECT","TEXTAREA"];function ic(e){var r,o;const t=((o=(r=e.composedPath)==null?void 0:r.call(e))==null?void 0:o[0])||e.target;return(t==null?void 0:t.nodeType)!==1?!1:Xm.includes(t.nodeName)||t.hasAttribute("contenteditable")||!!t.closest(".nokey")}const ac=e=>"clientX"in e,$e=(e,t)=>{var s,i;const n=ac(e),r=n?e.clientX:(s=e.touches)==null?void 0:s[0].clientX,o=n?e.clientY:(i=e.touches)==null?void 0:i[0].clientY;return{x:r-((t==null?void 0:t.left)??0),y:o-((t==null?void 0:t.top)??0)}},Ts=(e,t,n,r,o)=>{const s=t.querySelectorAll(`.${e}`);return!s||!s.length?null:Array.from(s).map(i=>{const a=i.getBoundingClientRect();return{id:i.getAttribute("data-handleid"),type:e,nodeId:o,position:i.getAttribute("data-handlepos"),x:(a.left-n.left)/r,y:(a.top-n.top)/r,...So(i)}})};function cc({sourceX:e,sourceY:t,targetX:n,targetY:r,sourceControlX:o,sourceControlY:s,targetControlX:i,targetControlY:a}){const c=e*.125+o*.375+i*.375+n*.125,l=t*.125+s*.375+a*.375+r*.125,d=Math.abs(c-e),f=Math.abs(l-t);return[c,l,d,f]}function gn(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function Ms({pos:e,x1:t,y1:n,x2:r,y2:o,c:s}){switch(e){case X.Left:return[t-gn(t-r,s),n];case X.Right:return[t+gn(r-t,s),n];case X.Top:return[t,n-gn(n-o,s)];case X.Bottom:return[t,n+gn(o-n,s)]}}function lc({sourceX:e,sourceY:t,sourcePosition:n=X.Bottom,targetX:r,targetY:o,targetPosition:s=X.Top,curvature:i=.25}){const[a,c]=Ms({pos:n,x1:e,y1:t,x2:r,y2:o,c:i}),[l,d]=Ms({pos:s,x1:r,y1:o,x2:e,y2:t,c:i}),[f,u,h,g]=cc({sourceX:e,sourceY:t,targetX:r,targetY:o,sourceControlX:a,sourceControlY:c,targetControlX:l,targetControlY:d});return[`M${e},${t} C${a},${c} ${l},${d} ${r},${o}`,f,u,h,g]}function uc({sourceX:e,sourceY:t,targetX:n,targetY:r}){const o=Math.abs(n-e)/2,s=n<e?n+o:n-o,i=Math.abs(r-t)/2,a=r<t?r+i:r-i;return[s,a,o,i]}function Gm({sourceNode:e,targetNode:t,selected:n=!1,zIndex:r=0,elevateOnSelect:o=!1}){if(!o)return r;const s=n||t.selected||e.selected,i=Math.max(e.internals.z||0,t.internals.z||0,1e3);return r+(s?i:0)}function qm({sourceNode:e,targetNode:t,width:n,height:r,transform:o}){const s=qn(Rn(e),Rn(t));s.x===s.x2&&(s.x2+=1),s.y===s.y2&&(s.y2+=1);const i={x:-o[0]/o[2],y:-o[1]/o[2],width:n/o[2],height:r/o[2]};return Ut(i,Kn(s))>0}const Km=({source:e,sourceHandle:t,target:n,targetHandle:r})=>`xy-edge__${e}${t||""}-${n}${r||""}`,Zm=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),dc=(e,t)=>{if(!e.source||!e.target)return t;let n;return Za(e)?n={...e}:n={...e,id:Km(e)},Zm(n,t)?t:(n.sourceHandle===null&&delete n.sourceHandle,n.targetHandle===null&&delete n.targetHandle,t.concat(n))};function fc({sourceX:e,sourceY:t,targetX:n,targetY:r}){const[o,s,i,a]=uc({sourceX:e,sourceY:t,targetX:n,targetY:r});return[`M ${e},${t}L ${n},${r}`,o,s,i,a]}const $s={[X.Left]:{x:-1,y:0},[X.Right]:{x:1,y:0},[X.Top]:{x:0,y:-1},[X.Bottom]:{x:0,y:1}},Jm=({source:e,sourcePosition:t=X.Bottom,target:n})=>t===X.Left||t===X.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},As=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function Qm({source:e,sourcePosition:t=X.Bottom,target:n,targetPosition:r=X.Top,center:o,offset:s}){const i=$s[t],a=$s[r],c={x:e.x+i.x*s,y:e.y+i.y*s},l={x:n.x+a.x*s,y:n.y+a.y*s},d=Jm({source:c,sourcePosition:t,target:l}),f=d.x!==0?"x":"y",u=d[f];let h=[],g,x;const b={x:0,y:0},_={x:0,y:0},[E,m,w,T]=uc({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(i[f]*a[f]===-1){g=o.x??E,x=o.y??m;const I=[{x:g,y:c.y},{x:g,y:l.y}],R=[{x:c.x,y:x},{x:l.x,y:x}];i[f]===u?h=f==="x"?I:R:h=f==="x"?R:I}else{const I=[{x:c.x,y:l.y}],R=[{x:l.x,y:c.y}];if(f==="x"?h=i.x===u?R:I:h=i.y===u?I:R,t===r){const O=Math.abs(e[f]-n[f]);if(O<=s){const y=Math.min(s-1,s-O);i[f]===u?b[f]=(c[f]>e[f]?-1:1)*y:_[f]=(l[f]>n[f]?-1:1)*y}}if(t!==r){const O=f==="x"?"y":"x",y=i[f]===a[O],k=c[O]>l[O],N=c[O]<l[O];(i[f]===1&&(!y&&k||y&&N)||i[f]!==1&&(!y&&N||y&&k))&&(h=f==="x"?I:R)}const A={x:c.x+b.x,y:c.y+b.y},j={x:l.x+_.x,y:l.y+_.y},H=Math.max(Math.abs(A.x-h[0].x),Math.abs(j.x-h[0].x)),L=Math.max(Math.abs(A.y-h[0].y),Math.abs(j.y-h[0].y));H>=L?(g=(A.x+j.x)/2,x=h[0].y):(g=h[0].x,x=(A.y+j.y)/2)}return[[e,{x:c.x+b.x,y:c.y+b.y},...h,{x:l.x+_.x,y:l.y+_.y},n],g,x,w,T]}function e0(e,t,n,r){const o=Math.min(As(e,t)/2,As(t,n)/2,r),{x:s,y:i}=t;if(e.x===s&&s===n.x||e.y===i&&i===n.y)return`L${s} ${i}`;if(e.y===i){const l=e.x<n.x?-1:1,d=e.y<n.y?1:-1;return`L ${s+o*l},${i}Q ${s},${i} ${s},${i+o*d}`}const a=e.x<n.x?1:-1,c=e.y<n.y?-1:1;return`L ${s},${i+o*c}Q ${s},${i} ${s+o*a},${i}`}function Xr({sourceX:e,sourceY:t,sourcePosition:n=X.Bottom,targetX:r,targetY:o,targetPosition:s=X.Top,borderRadius:i=5,centerX:a,centerY:c,offset:l=20}){const[d,f,u,h,g]=Qm({source:{x:e,y:t},sourcePosition:n,target:{x:r,y:o},targetPosition:s,center:{x:a,y:c},offset:l});return[d.reduce((b,_,E)=>{let m="";return E>0&&E<d.length-1?m=e0(d[E-1],_,d[E+1],i):m=`${E===0?"M":"L"}${_.x} ${_.y}`,b+=m,b},""),f,u,h,g]}function Ds(e){var t;return e&&!!(e.internals.handleBounds||(t=e.handles)!=null&&t.length)&&!!(e.measured.width||e.width||e.initialWidth)}function t0(e){var f;const{sourceNode:t,targetNode:n}=e;if(!Ds(t)||!Ds(n))return null;const r=t.internals.handleBounds||js(t.handles),o=n.internals.handleBounds||js(n.handles),s=Rs((r==null?void 0:r.source)??[],e.sourceHandle),i=Rs(e.connectionMode===xt.Strict?(o==null?void 0:o.target)??[]:((o==null?void 0:o.target)??[]).concat((o==null?void 0:o.source)??[]),e.targetHandle);if(!s||!i)return(f=e.onError)==null||f.call(e,"008",Se.error008(s?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;const a=(s==null?void 0:s.position)||X.Bottom,c=(i==null?void 0:i.position)||X.Top,l=Xt(t,s,a),d=Xt(n,i,c);return{sourceX:l.x,sourceY:l.y,targetX:d.x,targetY:d.y,sourcePosition:a,targetPosition:c}}function js(e){if(!e)return null;const t=[],n=[];for(const r of e)r.width=r.width??1,r.height=r.height??1,r.type==="source"?t.push(r):r.type==="target"&&n.push(r);return{source:t,target:n}}function Xt(e,t,n=X.Left,r=!1){const o=((t==null?void 0:t.x)??0)+e.internals.positionAbsolute.x,s=((t==null?void 0:t.y)??0)+e.internals.positionAbsolute.y,{width:i,height:a}=t??je(e);if(r)return{x:o+i/2,y:s+a/2};switch((t==null?void 0:t.position)??n){case X.Top:return{x:o+i/2,y:s};case X.Right:return{x:o+i,y:s+a/2};case X.Bottom:return{x:o+i/2,y:s+a};case X.Left:return{x:o,y:s+a/2}}}function Rs(e,t){return e&&(t?e.find(n=>n.id===t):e[0])||null}function Gr(e,t){return e?typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(r=>`${r}=${e[r]}`).join("&")}`:""}function n0(e,{id:t,defaultColor:n,defaultMarkerStart:r,defaultMarkerEnd:o}){const s=new Set;return e.reduce((i,a)=>([a.markerStart||r,a.markerEnd||o].forEach(c=>{if(c&&typeof c=="object"){const l=Gr(c,t);s.has(l)||(i.push({id:l,color:c.color||n,...c}),s.add(l))}}),i),[]).sort((i,a)=>i.id.localeCompare(a.id))}const Co={nodeOrigin:[0,0],nodeExtent:Wt,elevateNodesOnSelect:!0,defaults:{}},r0={...Co,checkEquality:!0};function ko(e,t){const n={...e};for(const r in t)t[r]!==void 0&&(n[r]=t[r]);return n}function o0(e,t,n){const r=ko(Co,n);for(const o of e.values())if(o.parentId)Io(o,e,t,r);else{const s=Jt(o,r.nodeOrigin),i=bt(o.extent)?o.extent:r.nodeExtent,a=nt(s,i,je(o));o.internals.positionAbsolute=a}}function qr(e,t,n,r){var c,l;const o=ko(r0,r);let s=!0;const i=new Map(t),a=o!=null&&o.elevateNodesOnSelect?1e3:0;t.clear(),n.clear();for(const d of e){let f=i.get(d.id);if(o.checkEquality&&d===(f==null?void 0:f.internals.userNode))t.set(d.id,f);else{const u=Jt(d,o.nodeOrigin),h=bt(d.extent)?d.extent:o.nodeExtent,g=nt(u,h,je(d));f={...o.defaults,...d,measured:{width:(c=d.measured)==null?void 0:c.width,height:(l=d.measured)==null?void 0:l.height},internals:{positionAbsolute:g,handleBounds:d.measured?f==null?void 0:f.internals.handleBounds:void 0,z:hc(d,a),userNode:d}},t.set(d.id,f)}(!f.measured||!f.measured.width||!f.measured.height)&&!f.hidden&&(s=!1),d.parentId&&Io(f,t,n,r)}return s}function s0(e,t){if(!e.parentId)return;const n=t.get(e.parentId);n?n.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}function Io(e,t,n,r){const{elevateNodesOnSelect:o,nodeOrigin:s,nodeExtent:i}=ko(Co,r),a=e.parentId,c=t.get(a);if(!c){console.warn(`Parent node ${a} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}s0(e,n);const l=o?1e3:0,{x:d,y:f,z:u}=i0(e,c,s,i,l),{positionAbsolute:h}=e.internals,g=d!==h.x||f!==h.y;(g||u!==e.internals.z)&&t.set(e.id,{...e,internals:{...e.internals,positionAbsolute:g?{x:d,y:f}:h,z:u}})}function hc(e,t){return(_e(e.zIndex)?e.zIndex:0)+(e.selected?t:0)}function i0(e,t,n,r,o){const{x:s,y:i}=t.internals.positionAbsolute,a=je(e),c=Jt(e,n),l=bt(e.extent)?nt(c,e.extent,a):c;let d=nt({x:s+l.x,y:i+l.y},r,a);e.extent==="parent"&&(d=ec(d,a,t));const f=hc(e,o),u=t.internals.z??0;return{x:d.x,y:d.y,z:u>f?u:f}}function To(e,t,n,r=[0,0]){var i;const o=[],s=new Map;for(const a of e){const c=t.get(a.parentId);if(!c)continue;const l=((i=s.get(a.parentId))==null?void 0:i.expandedRect)??_t(c),d=nc(l,a.rect);s.set(a.parentId,{expandedRect:d,parent:c})}return s.size>0&&s.forEach(({expandedRect:a,parent:c},l)=>{var m;const d=c.internals.positionAbsolute,f=je(c),u=c.origin??r,h=a.x<d.x?Math.round(Math.abs(d.x-a.x)):0,g=a.y<d.y?Math.round(Math.abs(d.y-a.y)):0,x=Math.max(f.width,Math.round(a.width)),b=Math.max(f.height,Math.round(a.height)),_=(x-f.width)*u[0],E=(b-f.height)*u[1];(h>0||g>0||_||E)&&(o.push({id:l,type:"position",position:{x:c.position.x-h+_,y:c.position.y-g+E}}),(m=n.get(l))==null||m.forEach(w=>{e.some(T=>T.id===w.id)||o.push({id:w.id,type:"position",position:{x:w.position.x+h,y:w.position.y+g}})})),(f.width<a.width||f.height<a.height||h||g)&&o.push({id:l,type:"dimensions",setAttributes:!0,dimensions:{width:x+(h?u[0]*h-_:0),height:b+(g?u[1]*g-E:0)}})}),o}function a0(e,t,n,r,o,s){const i=r==null?void 0:r.querySelector(".xyflow__viewport");let a=!1;if(!i)return{changes:[],updatedInternals:a};const c=[],l=window.getComputedStyle(i),{m22:d}=new window.DOMMatrixReadOnly(l.transform),f=[];for(const u of e.values()){const h=t.get(u.id);if(!h)continue;if(h.hidden){t.set(h.id,{...h,internals:{...h.internals,handleBounds:void 0}}),a=!0;continue}const g=So(u.nodeElement),x=h.measured.width!==g.width||h.measured.height!==g.height;if(!!(g.width&&g.height&&(x||!h.internals.handleBounds||u.force))){const _=u.nodeElement.getBoundingClientRect(),E=bt(h.extent)?h.extent:s;let{positionAbsolute:m}=h.internals;h.parentId&&h.extent==="parent"?m=ec(m,g,t.get(h.parentId)):E&&(m=nt(m,E,g));const w={...h,measured:g,internals:{...h.internals,positionAbsolute:m,handleBounds:{source:Ts("source",u.nodeElement,_,d,h.id),target:Ts("target",u.nodeElement,_,d,h.id)}}};t.set(h.id,w),h.parentId&&Io(w,t,n,{nodeOrigin:o}),a=!0,x&&(c.push({id:h.id,type:"dimensions",dimensions:g}),h.expandParent&&h.parentId&&f.push({id:h.id,parentId:h.parentId,rect:_t(w,o)}))}}if(f.length>0){const u=To(f,t,n,o);c.push(...u)}return{changes:c,updatedInternals:a}}async function c0({delta:e,panZoom:t,transform:n,translateExtent:r,width:o,height:s}){if(!t||!e.x&&!e.y)return Promise.resolve(!1);const i=await t.setViewportConstrained({x:n[0]+e.x,y:n[1]+e.y,zoom:n[2]},[[0,0],[o,s]],r),a=!!i&&(i.x!==n[0]||i.y!==n[1]||i.k!==n[2]);return Promise.resolve(a)}function Ps(e,t,n,r,o,s){let i=o;const a=r.get(i)||new Map;r.set(i,a.set(n,t)),i=`${o}-${e}`;const c=r.get(i)||new Map;if(r.set(i,c.set(n,t)),s){i=`${o}-${e}-${s}`;const l=r.get(i)||new Map;r.set(i,l.set(n,t))}}function pc(e,t,n){e.clear(),t.clear();for(const r of n){const{source:o,target:s,sourceHandle:i=null,targetHandle:a=null}=r,c={edgeId:r.id,source:o,target:s,sourceHandle:i,targetHandle:a},l=`${o}-${i}--${s}-${a}`,d=`${s}-${a}--${o}-${i}`;Ps("source",c,d,e,o,i),Ps("target",c,l,e,s,a),t.set(r.id,r)}}function gc(e,t){if(!e.parentId)return!1;const n=t.get(e.parentId);return n?n.selected?!0:gc(n,t):!1}function Os(e,t,n){var o;let r=e;do{if((o=r==null?void 0:r.matches)!=null&&o.call(r,t))return!0;if(r===n)return!1;r=r==null?void 0:r.parentElement}while(r);return!1}function l0(e,t,n,r){const o=new Map;for(const[s,i]of e)if((i.selected||i.id===r)&&(!i.parentId||!gc(i,e))&&(i.draggable||t&&typeof i.draggable>"u")){const a=e.get(s);a&&o.set(s,{id:s,position:a.position||{x:0,y:0},distance:{x:n.x-a.internals.positionAbsolute.x,y:n.y-a.internals.positionAbsolute.y},extent:a.extent,parentId:a.parentId,origin:a.origin,expandParent:a.expandParent,internals:{positionAbsolute:a.internals.positionAbsolute||{x:0,y:0}},measured:{width:a.measured.width??0,height:a.measured.height??0}})}return o}function mr({nodeId:e,dragItems:t,nodeLookup:n,dragging:r=!0}){var i,a,c;const o=[];for(const[l,d]of t){const f=(i=n.get(l))==null?void 0:i.internals.userNode;f&&o.push({...f,position:d.position,dragging:r})}if(!e)return[o[0],o];const s=(a=n.get(e))==null?void 0:a.internals.userNode;return[s?{...s,position:((c=t.get(e))==null?void 0:c.position)||s.position,dragging:r}:o[0],o]}function u0({onNodeMouseDown:e,getStoreItems:t,onDragStart:n,onDrag:r,onDragStop:o}){let s={x:null,y:null},i=0,a=new Map,c=!1,l={x:0,y:0},d=null,f=!1,u=null,h=!1;function g({noDragClassName:b,handleSelector:_,domNode:E,isSelectable:m,nodeId:w,nodeClickDistance:T=0}){u=fe(E);function $({x:j,y:H},L){const{nodeLookup:O,nodeExtent:y,snapGrid:k,snapToGrid:N,nodeOrigin:C,onNodeDrag:M,onSelectionDrag:S,onError:D,updateNodePositions:F}=t();s={x:j,y:H};let V=!1,Y={x:0,y:0,x2:0,y2:0};if(a.size>1&&y){const U=Qt(a);Y=Ur(U)}for(const[U,P]of a){if(!O.has(U))continue;let B={x:j-P.distance.x,y:H-P.distance.y};N&&(B=Zn(B,k));let z=[[y[0][0],y[0][1]],[y[1][0],y[1][1]]];if(a.size>1&&y&&!P.extent){const{positionAbsolute:Q}=P.internals,K=Q.x-Y.x+y[0][0],G=Q.x+P.measured.width-Y.x2+y[1][0],ne=Q.y-Y.y+y[0][1],J=Q.y+P.measured.height-Y.y2+y[1][1];z=[[K,ne],[G,J]]}const{position:W,positionAbsolute:q}=Qa({nodeId:U,nextPosition:B,nodeLookup:O,nodeExtent:z,nodeOrigin:C,onError:D});V=V||P.position.x!==W.x||P.position.y!==W.y,P.position=W,P.internals.positionAbsolute=q}if(V&&(F(a,!0),L&&(r||M||!w&&S))){const[U,P]=mr({nodeId:w,dragItems:a,nodeLookup:O});r==null||r(L,a,U,P),M==null||M(L,U,P),w||S==null||S(L,P)}}async function I(){if(!d)return;const{transform:j,panBy:H,autoPanSpeed:L,autoPanOnNodeDrag:O}=t();if(!O){c=!1,cancelAnimationFrame(i);return}const[y,k]=tc(l,d,L);(y!==0||k!==0)&&(s.x=(s.x??0)-y/j[2],s.y=(s.y??0)-k/j[2],await H({x:y,y:k})&&$(s,null)),i=requestAnimationFrame(I)}function R(j){var V;const{nodeLookup:H,multiSelectionActive:L,nodesDraggable:O,transform:y,snapGrid:k,snapToGrid:N,selectNodesOnDrag:C,onNodeDragStart:M,onSelectionDragStart:S,unselectNodesAndEdges:D}=t();f=!0,(!C||!m)&&!L&&w&&((V=H.get(w))!=null&&V.selected||D()),m&&C&&w&&(e==null||e(w));const F=Ot(j.sourceEvent,{transform:y,snapGrid:k,snapToGrid:N,containerBounds:d});if(s=F,a=l0(H,O,F,w),a.size>0&&(n||M||!w&&S)){const[Y,U]=mr({nodeId:w,dragItems:a,nodeLookup:H});n==null||n(j.sourceEvent,a,Y,U),M==null||M(j.sourceEvent,Y,U),w||S==null||S(j.sourceEvent,U)}}const A=Aa().clickDistance(T).on("start",j=>{const{domNode:H,nodeDragThreshold:L,transform:O,snapGrid:y,snapToGrid:k}=t();d=(H==null?void 0:H.getBoundingClientRect())||null,h=!1,L===0&&R(j),s=Ot(j.sourceEvent,{transform:O,snapGrid:y,snapToGrid:k,containerBounds:d}),l=$e(j.sourceEvent,d)}).on("drag",j=>{const{autoPanOnNodeDrag:H,transform:L,snapGrid:O,snapToGrid:y,nodeDragThreshold:k,nodeLookup:N}=t(),C=Ot(j.sourceEvent,{transform:L,snapGrid:O,snapToGrid:y,containerBounds:d});if((j.sourceEvent.type==="touchmove"&&j.sourceEvent.touches.length>1||w&&!N.has(w))&&(h=!0),!h){if(!c&&H&&f&&(c=!0,I()),!f){const M=C.xSnapped-(s.x??0),S=C.ySnapped-(s.y??0);Math.sqrt(M*M+S*S)>k&&R(j)}(s.x!==C.xSnapped||s.y!==C.ySnapped)&&a&&f&&(l=$e(j.sourceEvent,d),$(C,j.sourceEvent))}}).on("end",j=>{if(!(!f||h)&&(c=!1,f=!1,cancelAnimationFrame(i),a.size>0)){const{nodeLookup:H,updateNodePositions:L,onNodeDragStop:O,onSelectionDragStop:y}=t();if(L(a,!1),o||O||!w&&y){const[k,N]=mr({nodeId:w,dragItems:a,nodeLookup:H,dragging:!1});o==null||o(j.sourceEvent,a,k,N),O==null||O(j.sourceEvent,k,N),w||y==null||y(j.sourceEvent,N)}}}).filter(j=>{const H=j.target;return!j.button&&(!b||!Os(H,`.${b}`,E))&&(!_||Os(H,_,E))});u.call(A)}function x(){u==null||u.on(".drag",null)}return{update:g,destroy:x}}function d0(e,t,n){const r=[],o={x:e.x-n,y:e.y-n,width:n*2,height:n*2};for(const s of t.values())Ut(o,_t(s))>0&&r.push(s);return r}const f0=250;function h0(e,t,n,r){var a,c;let o=[],s=1/0;const i=d0(e,n,t+f0);for(const l of i){const d=[...((a=l.internals.handleBounds)==null?void 0:a.source)??[],...((c=l.internals.handleBounds)==null?void 0:c.target)??[]];for(const f of d){if(r.nodeId===f.nodeId&&r.type===f.type&&r.id===f.id)continue;const{x:u,y:h}=Xt(l,f,f.position,!0),g=Math.sqrt(Math.pow(u-e.x,2)+Math.pow(h-e.y,2));g>t||(g<s?(o=[{...f,x:u,y:h}],s=g):g===s&&o.push({...f,x:u,y:h}))}}if(!o.length)return null;if(o.length>1){const l=r.type==="source"?"target":"source";return o.find(d=>d.type===l)??o[0]}return o[0]}function mc(e,t,n,r,o,s=!1){var l,d,f;const i=r.get(e);if(!i)return null;const a=o==="strict"?(l=i.internals.handleBounds)==null?void 0:l[t]:[...((d=i.internals.handleBounds)==null?void 0:d.source)??[],...((f=i.internals.handleBounds)==null?void 0:f.target)??[]],c=(n?a==null?void 0:a.find(u=>u.id===n):a==null?void 0:a[0])??null;return c&&s?{...c,...Xt(i,c,c.position,!0)}:c}function yc(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function p0(e,t){let n=null;return t?n=!0:e&&!t&&(n=!1),n}const xc=()=>!0;function g0(e,{connectionMode:t,connectionRadius:n,handleId:r,nodeId:o,edgeUpdaterType:s,isTarget:i,domNode:a,nodeLookup:c,lib:l,autoPanOnConnect:d,flowId:f,panBy:u,cancelConnection:h,onConnectStart:g,onConnect:x,onConnectEnd:b,isValidConnection:_=xc,onReconnectEnd:E,updateConnection:m,getTransform:w,getFromHandle:T,autoPanSpeed:$}){const I=sc(e.target);let R=0,A;const{x:j,y:H}=$e(e),L=I==null?void 0:I.elementFromPoint(j,H),O=yc(s,L),y=a==null?void 0:a.getBoundingClientRect();if(!y||!O)return;const k=mc(o,O,r,c,t);if(!k)return;let N=$e(e,y),C=!1,M=null,S=!1,D=null;function F(){if(!d||!y)return;const[q,Q]=tc(N,y,$);u({x:q,y:Q}),R=requestAnimationFrame(F)}const V={...k,nodeId:o,type:O,position:k.position},Y=c.get(o),P={inProgress:!0,isValid:null,from:Xt(Y,V,X.Left,!0),fromHandle:V,fromPosition:V.position,fromNode:Y,to:N,toHandle:null,toPosition:Ss[V.position],toNode:null};m(P);let B=P;g==null||g(e,{nodeId:o,handleId:r,handleType:O});function z(q){if(!T()||!V){W(q);return}const Q=w();N=$e(q,y),A=h0(en(N,Q,!1,[1,1]),n,c,V),C||(F(),C=!0);const K=wc(q,{handle:A,connectionMode:t,fromNodeId:o,fromHandleId:r,fromType:i?"target":"source",isValidConnection:_,doc:I,lib:l,flowId:f,nodeLookup:c});D=K.handleDomNode,M=K.connection,S=p0(!!A,K.isValid);const G={...B,isValid:S,to:A&&S?Pn({x:A.x,y:A.y},Q):N,toHandle:K.toHandle,toPosition:S&&K.toHandle?K.toHandle.position:Ss[V.position],toNode:K.toHandle?c.get(K.toHandle.nodeId):null};S&&A&&B.toHandle&&G.toHandle&&B.toHandle.type===G.toHandle.type&&B.toHandle.nodeId===G.toHandle.nodeId&&B.toHandle.id===G.toHandle.id&&B.to.x===G.to.x&&B.to.y===G.to.y||(m(G),B=G)}function W(q){(A||D)&&M&&S&&(x==null||x(M));const{inProgress:Q,...K}=B,G={...K,toPosition:B.toHandle?B.toPosition:null};b==null||b(q,G),s&&(E==null||E(q,G)),h(),cancelAnimationFrame(R),C=!1,S=!1,M=null,D=null,I.removeEventListener("mousemove",z),I.removeEventListener("mouseup",W),I.removeEventListener("touchmove",z),I.removeEventListener("touchend",W)}I.addEventListener("mousemove",z),I.addEventListener("mouseup",W),I.addEventListener("touchmove",z),I.addEventListener("touchend",W)}function wc(e,{handle:t,connectionMode:n,fromNodeId:r,fromHandleId:o,fromType:s,doc:i,lib:a,flowId:c,isValidConnection:l=xc,nodeLookup:d}){const f=s==="target",u=t?i.querySelector(`.${a}-flow__handle[data-id="${c}-${t==null?void 0:t.nodeId}-${t==null?void 0:t.id}-${t==null?void 0:t.type}"]`):null,{x:h,y:g}=$e(e),x=i.elementFromPoint(h,g),b=x!=null&&x.classList.contains(`${a}-flow__handle`)?x:u,_={handleDomNode:b,isValid:!1,connection:null,toHandle:null};if(b){const E=yc(void 0,b),m=b.getAttribute("data-nodeid"),w=b.getAttribute("data-handleid"),T=b.classList.contains("connectable"),$=b.classList.contains("connectableend");if(!m||!E)return _;const I={source:f?m:r,sourceHandle:f?w:o,target:f?r:m,targetHandle:f?o:w};_.connection=I;const A=T&&$&&(n===xt.Strict?f&&E==="source"||!f&&E==="target":m!==r||w!==o);_.isValid=A&&l(I),_.toHandle=mc(m,E,w,d,n,!1)}return _}const Kr={onPointerDown:g0,isValid:wc};function m0({domNode:e,panZoom:t,getTransform:n,getViewScale:r}){const o=fe(e);function s({translateExtent:a,width:c,height:l,zoomStep:d=10,pannable:f=!0,zoomable:u=!0,inversePan:h=!1}){const g=m=>{const w=n();if(m.sourceEvent.type!=="wheel"||!t)return;const T=-m.sourceEvent.deltaY*(m.sourceEvent.deltaMode===1?.05:m.sourceEvent.deltaMode?1:.002)*d,$=w[2]*Math.pow(2,T);t.scaleTo($)};let x=[0,0];const b=m=>{(m.sourceEvent.type==="mousedown"||m.sourceEvent.type==="touchstart")&&(x=[m.sourceEvent.clientX??m.sourceEvent.touches[0].clientX,m.sourceEvent.clientY??m.sourceEvent.touches[0].clientY])},_=m=>{const w=n();if(m.sourceEvent.type!=="mousemove"&&m.sourceEvent.type!=="touchmove"||!t)return;const T=[m.sourceEvent.clientX??m.sourceEvent.touches[0].clientX,m.sourceEvent.clientY??m.sourceEvent.touches[0].clientY],$=[T[0]-x[0],T[1]-x[1]];x=T;const I=r()*Math.max(w[2],Math.log(w[2]))*(h?-1:1),R={x:w[0]-$[0]*I,y:w[1]-$[1]*I},A=[[0,0],[c,l]];t.setViewportConstrained({x:R.x,y:R.y,zoom:w[2]},A,a)},E=Xa().on("start",b).on("zoom",f?_:null).on("zoom.wheel",u?g:null);o.call(E,{})}function i(){o.on("zoom",null)}return{update:s,destroy:i,pointer:me}}const y0=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,Jn=e=>({x:e.x,y:e.y,zoom:e.k}),yr=({x:e,y:t,zoom:n})=>Gn.translate(e,t).scale(n),ut=(e,t)=>e.target.closest(`.${t}`),_c=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),xr=(e,t=0,n=()=>{})=>{const r=typeof t=="number"&&t>0;return r||n(),r?e.transition().duration(t).on("end",n):e},bc=e=>{const t=e.ctrlKey&&On()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t};function x0({zoomPanValues:e,noWheelClassName:t,d3Selection:n,d3Zoom:r,panOnScrollMode:o,panOnScrollSpeed:s,zoomOnPinch:i,onPanZoomStart:a,onPanZoom:c,onPanZoomEnd:l}){return d=>{if(ut(d,t))return!1;d.preventDefault(),d.stopImmediatePropagation();const f=n.property("__zoom").k||1;if(d.ctrlKey&&i){const b=me(d),_=bc(d),E=f*Math.pow(2,_);r.scaleTo(n,E,b,d);return}const u=d.deltaMode===1?20:1;let h=o===Je.Vertical?0:d.deltaX*u,g=o===Je.Horizontal?0:d.deltaY*u;!On()&&d.shiftKey&&o!==Je.Vertical&&(h=d.deltaY*u,g=0),r.translateBy(n,-(h/f)*s,-(g/f)*s,{internal:!0});const x=Jn(n.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling||(e.isPanScrolling=!0,a==null||a(d,x)),e.isPanScrolling&&(c==null||c(d,x),e.panScrollTimeout=setTimeout(()=>{l==null||l(d,x),e.isPanScrolling=!1},150))}}function w0({noWheelClassName:e,preventScrolling:t,d3ZoomHandler:n}){return function(r,o){if(!t&&r.type==="wheel"&&!r.ctrlKey||ut(r,e))return null;r.preventDefault(),n.call(this,r,o)}}function _0({zoomPanValues:e,onDraggingChange:t,onPanZoomStart:n}){return r=>{var s,i,a;if((s=r.sourceEvent)!=null&&s.internal)return;const o=Jn(r.transform);e.mouseButton=((i=r.sourceEvent)==null?void 0:i.button)||0,e.isZoomingOrPanning=!0,e.prevViewport=o,((a=r.sourceEvent)==null?void 0:a.type)==="mousedown"&&t(!0),n&&(n==null||n(r.sourceEvent,o))}}function b0({zoomPanValues:e,panOnDrag:t,onPaneContextMenu:n,onTransformChange:r,onPanZoom:o}){return s=>{var i,a;e.usedRightMouseButton=!!(n&&_c(t,e.mouseButton??0)),(i=s.sourceEvent)!=null&&i.sync||r([s.transform.x,s.transform.y,s.transform.k]),o&&!((a=s.sourceEvent)!=null&&a.internal)&&(o==null||o(s.sourceEvent,Jn(s.transform)))}}function v0({zoomPanValues:e,panOnDrag:t,panOnScroll:n,onDraggingChange:r,onPanZoomEnd:o,onPaneContextMenu:s}){return i=>{var a;if(!((a=i.sourceEvent)!=null&&a.internal)&&(e.isZoomingOrPanning=!1,s&&_c(t,e.mouseButton??0)&&!e.usedRightMouseButton&&i.sourceEvent&&s(i.sourceEvent),e.usedRightMouseButton=!1,r(!1),o&&y0(e.prevViewport,i.transform))){const c=Jn(i.transform);e.prevViewport=c,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{o==null||o(i.sourceEvent,c)},n?150:0)}}}function E0({zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:n,panOnDrag:r,panOnScroll:o,zoomOnDoubleClick:s,userSelectionActive:i,noWheelClassName:a,noPanClassName:c,lib:l}){return d=>{var g;const f=e||t,u=n&&d.ctrlKey;if(d.button===1&&d.type==="mousedown"&&(ut(d,`${l}-flow__node`)||ut(d,`${l}-flow__edge`)))return!0;if(!r&&!f&&!o&&!s&&!n||i||ut(d,a)&&d.type==="wheel"||ut(d,c)&&(d.type!=="wheel"||o&&d.type==="wheel"&&!e)||!n&&d.ctrlKey&&d.type==="wheel")return!1;if(!n&&d.type==="touchstart"&&((g=d.touches)==null?void 0:g.length)>1)return d.preventDefault(),!1;if(!f&&!o&&!u&&d.type==="wheel"||!r&&(d.type==="mousedown"||d.type==="touchstart")||Array.isArray(r)&&!r.includes(d.button)&&d.type==="mousedown")return!1;const h=Array.isArray(r)&&r.includes(d.button)||!d.button||d.button<=1;return(!d.ctrlKey||d.type==="wheel")&&h}}function N0({domNode:e,minZoom:t,maxZoom:n,paneClickDistance:r,translateExtent:o,viewport:s,onPanZoom:i,onPanZoomStart:a,onPanZoomEnd:c,onDraggingChange:l}){const d={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{x:0,y:0,zoom:0},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},f=e.getBoundingClientRect(),u=Xa().clickDistance(!_e(r)||r<0?0:r).scaleExtent([t,n]).translateExtent(o),h=fe(e).call(u);m({x:s.x,y:s.y,zoom:wt(s.zoom,t,n)},[[0,0],[f.width,f.height]],o);const g=h.on("wheel.zoom"),x=h.on("dblclick.zoom");u.wheelDelta(bc);function b(L,O){return h?new Promise(y=>{u==null||u.transform(xr(h,O==null?void 0:O.duration,()=>y(!0)),L)}):Promise.resolve(!1)}function _({noWheelClassName:L,noPanClassName:O,onPaneContextMenu:y,userSelectionActive:k,panOnScroll:N,panOnDrag:C,panOnScrollMode:M,panOnScrollSpeed:S,preventScrolling:D,zoomOnPinch:F,zoomOnScroll:V,zoomOnDoubleClick:Y,zoomActivationKeyPressed:U,lib:P,onTransformChange:B}){k&&!d.isZoomingOrPanning&&E();const W=N&&!U&&!k?x0({zoomPanValues:d,noWheelClassName:L,d3Selection:h,d3Zoom:u,panOnScrollMode:M,panOnScrollSpeed:S,zoomOnPinch:F,onPanZoomStart:a,onPanZoom:i,onPanZoomEnd:c}):w0({noWheelClassName:L,preventScrolling:D,d3ZoomHandler:g});if(h.on("wheel.zoom",W,{passive:!1}),!k){const Q=_0({zoomPanValues:d,onDraggingChange:l,onPanZoomStart:a});u.on("start",Q);const K=b0({zoomPanValues:d,panOnDrag:C,onPaneContextMenu:!!y,onPanZoom:i,onTransformChange:B});u.on("zoom",K);const G=v0({zoomPanValues:d,panOnDrag:C,panOnScroll:N,onPaneContextMenu:y,onPanZoomEnd:c,onDraggingChange:l});u.on("end",G)}const q=E0({zoomActivationKeyPressed:U,panOnDrag:C,zoomOnScroll:V,panOnScroll:N,zoomOnDoubleClick:Y,zoomOnPinch:F,userSelectionActive:k,noPanClassName:O,noWheelClassName:L,lib:P});u.filter(q),Y?h.on("dblclick.zoom",x):h.on("dblclick.zoom",null)}function E(){u.on("zoom",null)}async function m(L,O,y){const k=yr(L),N=u==null?void 0:u.constrain()(k,O,y);return N&&await b(N),new Promise(C=>C(N))}async function w(L,O){const y=yr(L);return await b(y,O),new Promise(k=>k(y))}function T(L){if(h){const O=yr(L),y=h.property("__zoom");(y.k!==L.zoom||y.x!==L.x||y.y!==L.y)&&(u==null||u.transform(h,O,null,{sync:!0}))}}function $(){const L=h?Ua(h.node()):{x:0,y:0,k:1};return{x:L.x,y:L.y,zoom:L.k}}function I(L,O){return h?new Promise(y=>{u==null||u.scaleTo(xr(h,O==null?void 0:O.duration,()=>y(!0)),L)}):Promise.resolve(!1)}function R(L,O){return h?new Promise(y=>{u==null||u.scaleBy(xr(h,O==null?void 0:O.duration,()=>y(!0)),L)}):Promise.resolve(!1)}function A(L){u==null||u.scaleExtent(L)}function j(L){u==null||u.translateExtent(L)}function H(L){const O=!_e(L)||L<0?0:L;u==null||u.clickDistance(O)}return{update:_,destroy:E,setViewport:w,setViewportConstrained:m,getViewport:$,scaleTo:I,scaleBy:R,setScaleExtent:A,setTranslateExtent:j,syncViewport:T,setClickDistance:H}}var Lt;(function(e){e.Line="line",e.Handle="handle"})(Lt||(Lt={}));function S0({width:e,prevWidth:t,height:n,prevHeight:r,affectsX:o,affectsY:s}){const i=e-t,a=n-r,c=[i>0?1:i<0?-1:0,a>0?1:a<0?-1:0];return i&&o&&(c[0]=c[0]*-1),a&&s&&(c[1]=c[1]*-1),c}function C0(e){const t=e.includes("right")||e.includes("left"),n=e.includes("bottom")||e.includes("top"),r=e.includes("left"),o=e.includes("top");return{isHorizontal:t,isVertical:n,affectsX:r,affectsY:o}}function Re(e,t){return Math.max(0,t-e)}function Pe(e,t){return Math.max(0,e-t)}function mn(e,t,n){return Math.max(0,t-e,e-n)}function Ls(e,t){return e?!t:t}function k0(e,t,n,r,o,s,i,a){let{affectsX:c,affectsY:l}=t;const{isHorizontal:d,isVertical:f}=t,u=d&&f,{xSnapped:h,ySnapped:g}=n,{minWidth:x,maxWidth:b,minHeight:_,maxHeight:E}=r,{x:m,y:w,width:T,height:$,aspectRatio:I}=e;let R=Math.floor(d?h-e.pointerX:0),A=Math.floor(f?g-e.pointerY:0);const j=T+(c?-R:R),H=$+(l?-A:A),L=-s[0]*T,O=-s[1]*$;let y=mn(j,x,b),k=mn(H,_,E);if(i){let M=0,S=0;c&&R<0?M=Re(m+R+L,i[0][0]):!c&&R>0&&(M=Pe(m+j+L,i[1][0])),l&&A<0?S=Re(w+A+O,i[0][1]):!l&&A>0&&(S=Pe(w+H+O,i[1][1])),y=Math.max(y,M),k=Math.max(k,S)}if(a){let M=0,S=0;c&&R>0?M=Pe(m+R,a[0][0]):!c&&R<0&&(M=Re(m+j,a[1][0])),l&&A>0?S=Pe(w+A,a[0][1]):!l&&A<0&&(S=Re(w+H,a[1][1])),y=Math.max(y,M),k=Math.max(k,S)}if(o){if(d){const M=mn(j/I,_,E)*I;if(y=Math.max(y,M),i){let S=0;!c&&!l||c&&!l&&u?S=Pe(w+O+j/I,i[1][1])*I:S=Re(w+O+(c?R:-R)/I,i[0][1])*I,y=Math.max(y,S)}if(a){let S=0;!c&&!l||c&&!l&&u?S=Re(w+j/I,a[1][1])*I:S=Pe(w+(c?R:-R)/I,a[0][1])*I,y=Math.max(y,S)}}if(f){const M=mn(H*I,x,b)/I;if(k=Math.max(k,M),i){let S=0;!c&&!l||l&&!c&&u?S=Pe(m+H*I+L,i[1][0])/I:S=Re(m+(l?A:-A)*I+L,i[0][0])/I,k=Math.max(k,S)}if(a){let S=0;!c&&!l||l&&!c&&u?S=Re(m+H*I,a[1][0])/I:S=Pe(m+(l?A:-A)*I,a[0][0])/I,k=Math.max(k,S)}}}A=A+(A<0?k:-k),R=R+(R<0?y:-y),o&&(u?j>H*I?A=(Ls(c,l)?-R:R)/I:R=(Ls(c,l)?-A:A)*I:d?(A=R/I,l=c):(R=A*I,c=l));const N=c?m+R:m,C=l?w+A:w;return{width:T+(c?-R:R),height:$+(l?-A:A),x:s[0]*R*(c?-1:1)+N,y:s[1]*A*(l?-1:1)+C}}const vc={width:0,height:0,x:0,y:0},I0={...vc,pointerX:0,pointerY:0,aspectRatio:1};function T0(e){return[[0,0],[e.measured.width,e.measured.height]]}function M0(e,t,n){const r=t.position.x+e.position.x,o=t.position.y+e.position.y,s=e.measured.width??0,i=e.measured.height??0,a=n[0]*s,c=n[1]*i;return[[r-a,o-c],[r+s-a,o+i-c]]}function $0({domNode:e,nodeId:t,getStoreItems:n,onChange:r,onEnd:o}){const s=fe(e);function i({controlPosition:c,boundaries:l,keepAspectRatio:d,onResizeStart:f,onResize:u,onResizeEnd:h,shouldResize:g}){let x={...vc},b={...I0};const _=C0(c);let E,m=null,w=[],T,$,I;const R=Aa().on("start",A=>{const{nodeLookup:j,transform:H,snapGrid:L,snapToGrid:O,nodeOrigin:y,paneDomNode:k}=n();if(E=j.get(t),!E)return;m=(k==null?void 0:k.getBoundingClientRect())??null;const{xSnapped:N,ySnapped:C}=Ot(A.sourceEvent,{transform:H,snapGrid:L,snapToGrid:O,containerBounds:m});x={width:E.measured.width??0,height:E.measured.height??0,x:E.position.x??0,y:E.position.y??0},b={...x,pointerX:N,pointerY:C,aspectRatio:x.width/x.height},T=void 0,E.parentId&&(E.extent==="parent"||E.expandParent)&&(T=j.get(E.parentId),$=T&&E.extent==="parent"?T0(T):void 0),w=[],I=void 0;for(const[M,S]of j)if(S.parentId===t&&(w.push({id:M,position:{...S.position},extent:S.extent}),S.extent==="parent"||S.expandParent)){const D=M0(S,E,S.origin??y);I?I=[[Math.min(D[0][0],I[0][0]),Math.min(D[0][1],I[0][1])],[Math.max(D[1][0],I[1][0]),Math.max(D[1][1],I[1][1])]]:I=D}f==null||f(A,{...x})}).on("drag",A=>{const{transform:j,snapGrid:H,snapToGrid:L,nodeOrigin:O}=n(),y=Ot(A.sourceEvent,{transform:j,snapGrid:H,snapToGrid:L,containerBounds:m}),k=[];if(!E)return;const{x:N,y:C,width:M,height:S}=x,D={},F=E.origin??O,{width:V,height:Y,x:U,y:P}=k0(b,_,y,l,d,F,$,I),B=V!==M,z=Y!==S,W=U!==N&&B,q=P!==C&&z;if(!W&&!q&&!B&&!z)return;if((W||q||F[0]===1||F[1]===1)&&(D.x=W?U:x.x,D.y=q?P:x.y,x.x=D.x,x.y=D.y,w.length>0)){const ne=U-N,J=P-C;for(const ae of w)ae.position={x:ae.position.x-ne+F[0]*(V-M),y:ae.position.y-J+F[1]*(Y-S)},k.push(ae)}if((B||z)&&(D.width=B?V:x.width,D.height=z?Y:x.height,x.width=D.width,x.height=D.height),T&&E.expandParent){const ne=F[0]*(D.width??0);D.x&&D.x<ne&&(x.x=ne,b.x=b.x-(D.x-ne));const J=F[1]*(D.height??0);D.y&&D.y<J&&(x.y=J,b.y=b.y-(D.y-J))}const Q=S0({width:x.width,prevWidth:M,height:x.height,prevHeight:S,affectsX:_.affectsX,affectsY:_.affectsY}),K={...x,direction:Q};(g==null?void 0:g(A,K))!==!1&&(u==null||u(A,K),r(D,k))}).on("end",A=>{h==null||h(A,{...x}),o==null||o()});s.call(R)}function a(){s.on(".drag",null)}return{update:i,destroy:a}}const A0={},Hs=e=>{let t;const n=new Set,r=(d,f)=>{const u=typeof d=="function"?d(t):d;if(!Object.is(u,t)){const h=t;t=f??(typeof u!="object"||u===null)?u:Object.assign({},t,u),n.forEach(g=>g(t,h))}},o=()=>t,c={setState:r,getState:o,getInitialState:()=>l,subscribe:d=>(n.add(d),()=>n.delete(d)),destroy:()=>{(A0?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},l=t=e(r,o,c);return c},D0=e=>e?Hs(e):Hs,{useDebugValue:j0}=br,{useSyncExternalStoreWithSelector:R0}=cu,P0=e=>e;function Ec(e,t=P0,n){const r=R0(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return j0(r),r}const Fs=(e,t)=>{const n=D0(e),r=(o,s=t)=>Ec(n,o,s);return Object.assign(r,n),r},O0=(e,t)=>e?Fs(e,t):Fs;function oe(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[r,o]of e)if(!Object.is(o,t.get(r)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const r of n)if(!Object.prototype.hasOwnProperty.call(t,r)||!Object.is(e[r],t[r]))return!1;return!0}const Qn=v.createContext(null),L0=Qn.Provider,Nc=Se.error001();function Z(e,t){const n=v.useContext(Qn);if(n===null)throw new Error(Nc);return Ec(n,e,t)}function re(){const e=v.useContext(Qn);if(e===null)throw new Error(Nc);return v.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe}),[e])}const zs={display:"none"},H0={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},Sc="react-flow__node-desc",Cc="react-flow__edge-desc",F0="react-flow__aria-live",z0=e=>e.ariaLiveMessage;function B0({rfId:e}){const t=Z(z0);return p.jsx("div",{id:`${F0}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:H0,children:t})}function V0({rfId:e,disableKeyboardA11y:t}){return p.jsxs(p.Fragment,{children:[p.jsxs("div",{id:`${Sc}-${e}`,style:zs,children:["Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "]}),p.jsx("div",{id:`${Cc}-${e}`,style:zs,children:"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."}),!t&&p.jsx(B0,{rfId:e})]})}const W0=e=>e.userSelectionActive?"none":"all",er=v.forwardRef(({position:e="top-left",children:t,className:n,style:r,...o},s)=>{const i=Z(W0),a=`${e}`.split("-");return p.jsx("div",{className:se(["react-flow__panel",n,...a]),style:{...r,pointerEvents:i},ref:s,...o,children:t})});er.displayName="Panel";function Y0({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:p.jsx(er,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:p.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const U0=e=>{const t=[],n=[];for(const[,r]of e.nodeLookup)r.selected&&t.push(r.internals.userNode);for(const[,r]of e.edgeLookup)r.selected&&n.push(r);return{selectedNodes:t,selectedEdges:n}},yn=e=>e.id;function X0(e,t){return oe(e.selectedNodes.map(yn),t.selectedNodes.map(yn))&&oe(e.selectedEdges.map(yn),t.selectedEdges.map(yn))}function G0({onSelectionChange:e}){const t=re(),{selectedNodes:n,selectedEdges:r}=Z(U0,X0);return v.useEffect(()=>{const o={nodes:n,edges:r};e==null||e(o),t.getState().onSelectionChangeHandlers.forEach(s=>s(o))},[n,r,e]),null}const q0=e=>!!e.onSelectionChangeHandlers;function K0({onSelectionChange:e}){const t=Z(q0);return e||t?p.jsx(G0,{onSelectionChange:e}):null}const kc=[0,0],Z0={x:0,y:0,zoom:1},J0=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","onBeforeDelete","debug","autoPanSpeed","paneClickDistance"],Bs=[...J0,"rfId"],Q0=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setPaneClickDistance:e.setPaneClickDistance}),Vs={translateExtent:Wt,nodeOrigin:kc,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1",paneClickDistance:0};function ey(e){const{setNodes:t,setEdges:n,setMinZoom:r,setMaxZoom:o,setTranslateExtent:s,setNodeExtent:i,reset:a,setDefaultNodesAndEdges:c,setPaneClickDistance:l}=Z(Q0,oe),d=re();v.useEffect(()=>(c(e.defaultNodes,e.defaultEdges),()=>{f.current=Vs,a()}),[]);const f=v.useRef(Vs);return v.useEffect(()=>{for(const u of Bs){const h=e[u],g=f.current[u];h!==g&&(typeof e[u]>"u"||(u==="nodes"?t(h):u==="edges"?n(h):u==="minZoom"?r(h):u==="maxZoom"?o(h):u==="translateExtent"?s(h):u==="nodeExtent"?i(h):u==="paneClickDistance"?l(h):u==="fitView"?d.setState({fitViewQueued:h}):u==="fitViewOptions"?d.setState({fitViewOptions:h}):d.setState({[u]:h})))}f.current=e},Bs.map(u=>e[u])),null}function Ws(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function ty(e){var r;const[t,n]=v.useState(e==="system"?null:e);return v.useEffect(()=>{if(e!=="system"){n(e);return}const o=Ws(),s=()=>n(o!=null&&o.matches?"dark":"light");return s(),o==null||o.addEventListener("change",s),()=>{o==null||o.removeEventListener("change",s)}},[e]),t!==null?t:(r=Ws())!=null&&r.matches?"dark":"light"}const Ys=typeof document<"u"?document:null;function Gt(e=null,t={target:Ys,actInsideInputWithModifier:!0}){const[n,r]=v.useState(!1),o=v.useRef(!1),s=v.useRef(new Set([])),[i,a]=v.useMemo(()=>{if(e!==null){const l=(Array.isArray(e)?e:[e]).filter(f=>typeof f=="string").map(f=>f.replace("+",`
`).replace(`

`,`
+`).split(`
`)),d=l.reduce((f,u)=>f.concat(...u),[]);return[l,d]}return[[],[]]},[e]);return v.useEffect(()=>{const c=(t==null?void 0:t.target)||Ys;if(e!==null){const l=u=>{var x,b;if(o.current=u.ctrlKey||u.metaKey||u.shiftKey||u.altKey,(!o.current||o.current&&!t.actInsideInputWithModifier)&&ic(u))return!1;const g=Xs(u.code,a);if(s.current.add(u[g]),Us(i,s.current,!1)){const _=((b=(x=u.composedPath)==null?void 0:x.call(u))==null?void 0:b[0])||u.target,E=(_==null?void 0:_.nodeName)==="BUTTON"||(_==null?void 0:_.nodeName)==="A";t.preventDefault!==!1&&(o.current||!E)&&u.preventDefault(),r(!0)}},d=u=>{const h=Xs(u.code,a);Us(i,s.current,!0)?(r(!1),s.current.clear()):s.current.delete(u[h]),u.key==="Meta"&&s.current.clear(),o.current=!1},f=()=>{s.current.clear(),r(!1)};return c==null||c.addEventListener("keydown",l),c==null||c.addEventListener("keyup",d),window.addEventListener("blur",f),window.addEventListener("contextmenu",f),()=>{c==null||c.removeEventListener("keydown",l),c==null||c.removeEventListener("keyup",d),window.removeEventListener("blur",f),window.removeEventListener("contextmenu",f)}}},[e,r]),n}function Us(e,t,n){return e.filter(r=>n||r.length===t.size).some(r=>r.every(o=>t.has(o)))}function Xs(e,t){return t.includes(e)?"code":"key"}const ny=()=>{const e=re();return v.useMemo(()=>({zoomIn:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomOut:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1/1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomTo:(t,n)=>{const{panZoom:r}=e.getState();return r?r.scaleTo(t,{duration:n==null?void 0:n.duration}):Promise.resolve(!1)},getZoom:()=>e.getState().transform[2],setViewport:async(t,n)=>{const{transform:[r,o,s],panZoom:i}=e.getState();return i?(await i.setViewport({x:t.x??r,y:t.y??o,zoom:t.zoom??s},{duration:n==null?void 0:n.duration}),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[t,n,r]=e.getState().transform;return{x:t,y:n,zoom:r}},setCenter:async(t,n,r)=>{const{width:o,height:s,maxZoom:i,panZoom:a}=e.getState(),c=typeof(r==null?void 0:r.zoom)<"u"?r.zoom:i,l=o/2-t*c,d=s/2-n*c;return a?(await a.setViewport({x:l,y:d,zoom:c},{duration:r==null?void 0:r.duration}),Promise.resolve(!0)):Promise.resolve(!1)},fitBounds:async(t,n)=>{const{width:r,height:o,minZoom:s,maxZoom:i,panZoom:a}=e.getState(),c=No(t,r,o,s,i,(n==null?void 0:n.padding)??.1);return a?(await a.setViewport(c,{duration:n==null?void 0:n.duration}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(t,n={})=>{const{transform:r,snapGrid:o,snapToGrid:s,domNode:i}=e.getState();if(!i)return t;const{x:a,y:c}=i.getBoundingClientRect(),l={x:t.x-a,y:t.y-c},d=n.snapGrid??o,f=n.snapToGrid??s;return en(l,r,f,d)},flowToScreenPosition:t=>{const{transform:n,domNode:r}=e.getState();if(!r)return t;const{x:o,y:s}=r.getBoundingClientRect(),i=Pn(t,n);return{x:i.x+o,y:i.y+s}}}),[])};function Ic(e,t){const n=[],r=new Map,o=[];for(const s of e)if(s.type==="add"){o.push(s);continue}else if(s.type==="remove"||s.type==="replace")r.set(s.id,[s]);else{const i=r.get(s.id);i?i.push(s):r.set(s.id,[s])}for(const s of t){const i=r.get(s.id);if(!i){n.push(s);continue}if(i[0].type==="remove")continue;if(i[0].type==="replace"){n.push({...i[0].item});continue}const a={...s};for(const c of i)ry(c,a);n.push(a)}return o.length&&o.forEach(s=>{s.index!==void 0?n.splice(s.index,0,{...s.item}):n.push({...s.item})}),n}function ry(e,t){switch(e.type){case"select":{t.selected=e.selected;break}case"position":{typeof e.position<"u"&&(t.position=e.position),typeof e.dragging<"u"&&(t.dragging=e.dragging);break}case"dimensions":{typeof e.dimensions<"u"&&(t.measured??(t.measured={}),t.measured.width=e.dimensions.width,t.measured.height=e.dimensions.height,e.setAttributes&&(t.width=e.dimensions.width,t.height=e.dimensions.height)),typeof e.resizing=="boolean"&&(t.resizing=e.resizing);break}}}function Tc(e,t){return Ic(e,t)}function Mc(e,t){return Ic(e,t)}function Xe(e,t){return{id:e,type:"select",selected:t}}function dt(e,t=new Set,n=!1){const r=[];for(const[o,s]of e){const i=t.has(o);!(s.selected===void 0&&!i)&&s.selected!==i&&(n&&(s.selected=i),r.push(Xe(s.id,i)))}return r}function Gs({items:e=[],lookup:t}){var o;const n=[],r=new Map(e.map(s=>[s.id,s]));for(const[s,i]of e.entries()){const a=t.get(i.id),c=((o=a==null?void 0:a.internals)==null?void 0:o.userNode)??a;c!==void 0&&c!==i&&n.push({id:i.id,item:i,type:"replace"}),c===void 0&&n.push({item:i,type:"add",index:s})}for(const[s]of t)r.get(s)===void 0&&n.push({id:s,type:"remove"});return n}function qs(e){return{id:e.id,type:"remove"}}const Ks=e=>Lm(e),oy=e=>Za(e);function $c(e){return v.forwardRef(e)}const sy=typeof window<"u"?v.useLayoutEffect:v.useEffect;function Zs(e){const[t,n]=v.useState(BigInt(0)),[r]=v.useState(()=>iy(()=>n(o=>o+BigInt(1))));return sy(()=>{const o=r.get();o.length&&(e(o),r.reset())},[t]),r}function iy(e){let t=[];return{get:()=>t,reset:()=>{t=[]},push:n=>{t.push(n),e()}}}const Ac=v.createContext(null);function ay({children:e}){const t=re(),n=v.useCallback(a=>{const{nodes:c=[],setNodes:l,hasDefaultNodes:d,onNodesChange:f,nodeLookup:u}=t.getState();let h=c;for(const g of a)h=typeof g=="function"?g(h):g;d?l(h):f&&f(Gs({items:h,lookup:u}))},[]),r=Zs(n),o=v.useCallback(a=>{const{edges:c=[],setEdges:l,hasDefaultEdges:d,onEdgesChange:f,edgeLookup:u}=t.getState();let h=c;for(const g of a)h=typeof g=="function"?g(h):g;d?l(h):f&&f(Gs({items:h,lookup:u}))},[]),s=Zs(o),i=v.useMemo(()=>({nodeQueue:r,edgeQueue:s}),[]);return p.jsx(Ac.Provider,{value:i,children:e})}function cy(){const e=v.useContext(Ac);if(!e)throw new Error("useBatchContext must be used within a BatchProvider");return e}const ly=e=>!!e.panZoom;function Mo(){const e=ny(),t=re(),n=cy(),r=Z(ly),o=v.useMemo(()=>{const s=f=>t.getState().nodeLookup.get(f),i=f=>{n.nodeQueue.push(f)},a=f=>{n.edgeQueue.push(f)},c=f=>{var _,E;const{nodeLookup:u,nodeOrigin:h}=t.getState(),g=Ks(f)?f:u.get(f.id),x=g.parentId?oc(g.position,g.measured,g.parentId,u,h):g.position,b={...g,position:x,width:((_=g.measured)==null?void 0:_.width)??g.width,height:((E=g.measured)==null?void 0:E.height)??g.height};return _t(b)},l=(f,u,h={replace:!1})=>{i(g=>g.map(x=>{if(x.id===f){const b=typeof u=="function"?u(x):u;return h.replace&&Ks(b)?b:{...x,...b}}return x}))},d=(f,u,h={replace:!1})=>{a(g=>g.map(x=>{if(x.id===f){const b=typeof u=="function"?u(x):u;return h.replace&&oy(b)?b:{...x,...b}}return x}))};return{getNodes:()=>t.getState().nodes.map(f=>({...f})),getNode:f=>{var u;return(u=s(f))==null?void 0:u.internals.userNode},getInternalNode:s,getEdges:()=>{const{edges:f=[]}=t.getState();return f.map(u=>({...u}))},getEdge:f=>t.getState().edgeLookup.get(f),setNodes:i,setEdges:a,addNodes:f=>{const u=Array.isArray(f)?f:[f];n.nodeQueue.push(h=>[...h,...u])},addEdges:f=>{const u=Array.isArray(f)?f:[f];n.edgeQueue.push(h=>[...h,...u])},toObject:()=>{const{nodes:f=[],edges:u=[],transform:h}=t.getState(),[g,x,b]=h;return{nodes:f.map(_=>({..._})),edges:u.map(_=>({..._})),viewport:{x:g,y:x,zoom:b}}},deleteElements:async({nodes:f=[],edges:u=[]})=>{const{nodes:h,edges:g,onNodesDelete:x,onEdgesDelete:b,triggerNodeChanges:_,triggerEdgeChanges:E,onDelete:m,onBeforeDelete:w}=t.getState(),{nodes:T,edges:$}=await Vm({nodesToRemove:f,edgesToRemove:u,nodes:h,edges:g,onBeforeDelete:w}),I=$.length>0,R=T.length>0;if(I){const A=$.map(qs);b==null||b($),E(A)}if(R){const A=T.map(qs);x==null||x(T),_(A)}return(R||I)&&(m==null||m({nodes:T,edges:$})),{deletedNodes:T,deletedEdges:$}},getIntersectingNodes:(f,u=!0,h)=>{const g=ks(f),x=g?f:c(f),b=h!==void 0;return x?(h||t.getState().nodes).filter(_=>{const E=t.getState().nodeLookup.get(_.id);if(E&&!g&&(_.id===f.id||!E.internals.positionAbsolute))return!1;const m=_t(b?_:E),w=Ut(m,x);return u&&w>0||w>=x.width*x.height}):[]},isNodeIntersecting:(f,u,h=!0)=>{const x=ks(f)?f:c(f);if(!x)return!1;const b=Ut(x,u);return h&&b>0||b>=x.width*x.height},updateNode:l,updateNodeData:(f,u,h={replace:!1})=>{l(f,g=>{const x=typeof u=="function"?u(g):u;return h.replace?{...g,data:x}:{...g,data:{...g.data,...x}}},h)},updateEdge:d,updateEdgeData:(f,u,h={replace:!1})=>{d(f,g=>{const x=typeof u=="function"?u(g):u;return h.replace?{...g,data:x}:{...g,data:{...g.data,...x}}},h)},getNodesBounds:f=>{const{nodeLookup:u,nodeOrigin:h}=t.getState();return Hm(f,{nodeLookup:u,nodeOrigin:h})},getHandleConnections:({type:f,id:u,nodeId:h})=>{var g;return Array.from(((g=t.getState().connectionLookup.get(`${h}-${f}${u?`-${u}`:""}`))==null?void 0:g.values())??[])},getNodeConnections:({type:f,handleId:u,nodeId:h})=>{var g;return Array.from(((g=t.getState().connectionLookup.get(`${h}${f?u?`-${f}-${u}`:`-${f}`:""}`))==null?void 0:g.values())??[])},fitView:async f=>{const u=t.getState().fitViewResolver??Promise.withResolvers();return t.setState({fitViewQueued:!0,fitViewOptions:f,fitViewResolver:u}),n.nodeQueue.push(h=>[...h]),u.promise}}},[]);return v.useMemo(()=>({...o,...e,viewportInitialized:r}),[r])}const Js=e=>e.selected,uy={actInsideInputWithModifier:!1},dy=typeof window<"u"?window:void 0;function fy({deleteKeyCode:e,multiSelectionKeyCode:t}){const n=re(),{deleteElements:r}=Mo(),o=Gt(e,uy),s=Gt(t,{target:dy});v.useEffect(()=>{if(o){const{edges:i,nodes:a}=n.getState();r({nodes:a.filter(Js),edges:i.filter(Js)}),n.setState({nodesSelectionActive:!1})}},[o]),v.useEffect(()=>{n.setState({multiSelectionActive:s})},[s])}function hy(e){const t=re();v.useEffect(()=>{const n=()=>{var o,s;if(!e.current)return!1;const r=So(e.current);(r.height===0||r.width===0)&&((s=(o=t.getState()).onError)==null||s.call(o,"004",Se.error004())),t.setState({width:r.width||500,height:r.height||500})};if(e.current){n(),window.addEventListener("resize",n);const r=new ResizeObserver(()=>n());return r.observe(e.current),()=>{window.removeEventListener("resize",n),r&&e.current&&r.unobserve(e.current)}}},[])}const tr={position:"absolute",width:"100%",height:"100%",top:0,left:0},py=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib});function gy({onPaneContextMenu:e,zoomOnScroll:t=!0,zoomOnPinch:n=!0,panOnScroll:r=!1,panOnScrollSpeed:o=.5,panOnScrollMode:s=Je.Free,zoomOnDoubleClick:i=!0,panOnDrag:a=!0,defaultViewport:c,translateExtent:l,minZoom:d,maxZoom:f,zoomActivationKeyCode:u,preventScrolling:h=!0,children:g,noWheelClassName:x,noPanClassName:b,onViewportChange:_,isControlledViewport:E,paneClickDistance:m}){const w=re(),T=v.useRef(null),{userSelectionActive:$,lib:I}=Z(py,oe),R=Gt(u),A=v.useRef();hy(T);const j=v.useCallback(H=>{_==null||_({x:H[0],y:H[1],zoom:H[2]}),E||w.setState({transform:H})},[_,E]);return v.useEffect(()=>{if(T.current){A.current=N0({domNode:T.current,minZoom:d,maxZoom:f,translateExtent:l,viewport:c,paneClickDistance:m,onDraggingChange:y=>w.setState({paneDragging:y}),onPanZoomStart:(y,k)=>{const{onViewportChangeStart:N,onMoveStart:C}=w.getState();C==null||C(y,k),N==null||N(k)},onPanZoom:(y,k)=>{const{onViewportChange:N,onMove:C}=w.getState();C==null||C(y,k),N==null||N(k)},onPanZoomEnd:(y,k)=>{const{onViewportChangeEnd:N,onMoveEnd:C}=w.getState();C==null||C(y,k),N==null||N(k)}});const{x:H,y:L,zoom:O}=A.current.getViewport();return w.setState({panZoom:A.current,transform:[H,L,O],domNode:T.current.closest(".react-flow")}),()=>{var y;(y=A.current)==null||y.destroy()}}},[]),v.useEffect(()=>{var H;(H=A.current)==null||H.update({onPaneContextMenu:e,zoomOnScroll:t,zoomOnPinch:n,panOnScroll:r,panOnScrollSpeed:o,panOnScrollMode:s,zoomOnDoubleClick:i,panOnDrag:a,zoomActivationKeyPressed:R,preventScrolling:h,noPanClassName:b,userSelectionActive:$,noWheelClassName:x,lib:I,onTransformChange:j})},[e,t,n,r,o,s,i,a,R,h,b,$,x,I,j]),p.jsx("div",{className:"react-flow__renderer",ref:T,style:tr,children:g})}const my=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function yy(){const{userSelectionActive:e,userSelectionRect:t}=Z(my,oe);return e&&t?p.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}const wr=(e,t)=>n=>{n.target===t.current&&(e==null||e(n))},xy=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,connectionInProgress:e.connection.inProgress,dragging:e.paneDragging});function wy({isSelecting:e,selectionKeyPressed:t,selectionMode:n=Yt.Full,panOnDrag:r,selectionOnDrag:o,onSelectionStart:s,onSelectionEnd:i,onPaneClick:a,onPaneContextMenu:c,onPaneScroll:l,onPaneMouseEnter:d,onPaneMouseMove:f,onPaneMouseLeave:u,children:h}){const g=re(),{userSelectionActive:x,elementsSelectable:b,dragging:_,connectionInProgress:E}=Z(xy,oe),m=b&&(e||x),w=v.useRef(null),T=v.useRef(),$=v.useRef(new Set),I=v.useRef(new Set),R=v.useRef(!1),A=v.useRef(!1),j=C=>{if(R.current||E){R.current=!1;return}a==null||a(C),g.getState().resetSelectedElements(),g.setState({nodesSelectionActive:!1})},H=C=>{if(Array.isArray(r)&&(r!=null&&r.includes(2))){C.preventDefault();return}c==null||c(C)},L=l?C=>l(C):void 0,O=C=>{var V,Y;const{resetSelectedElements:M,domNode:S}=g.getState();if(T.current=S==null?void 0:S.getBoundingClientRect(),!b||!e||C.button!==0||C.target!==w.current||!T.current)return;(Y=(V=C.target)==null?void 0:V.setPointerCapture)==null||Y.call(V,C.pointerId),A.current=!0,R.current=!1;const{x:D,y:F}=$e(C.nativeEvent,T.current);M(),g.setState({userSelectionRect:{width:0,height:0,startX:D,startY:F,x:D,y:F}}),s==null||s(C)},y=C=>{const{userSelectionRect:M,transform:S,nodeLookup:D,edgeLookup:F,connectionLookup:V,triggerNodeChanges:Y,triggerEdgeChanges:U,defaultEdgeOptions:P}=g.getState();if(!T.current||!M)return;R.current=!0;const{x:B,y:z}=$e(C.nativeEvent,T.current),{startX:W,startY:q}=M,Q={startX:W,startY:q,x:B<W?B:W,y:z<q?z:q,width:Math.abs(B-W),height:Math.abs(z-q)},K=$.current,G=I.current;$.current=new Set(Ja(D,Q,S,n===Yt.Partial,!0).map(J=>J.id)),I.current=new Set;const ne=(P==null?void 0:P.selectable)??!0;for(const J of $.current){const ae=V.get(J);if(ae)for(const{edgeId:ge}of ae.values()){const it=F.get(ge);it&&(it.selectable??ne)&&I.current.add(ge)}}if(!Is(K,$.current)){const J=dt(D,$.current,!0);Y(J)}if(!Is(G,I.current)){const J=dt(F,I.current);U(J)}g.setState({userSelectionRect:Q,userSelectionActive:!0,nodesSelectionActive:!1})},k=C=>{var S,D;if(C.button!==0||!A.current)return;(D=(S=C.target)==null?void 0:S.releasePointerCapture)==null||D.call(S,C.pointerId);const{userSelectionRect:M}=g.getState();!x&&M&&C.target===w.current&&(j==null||j(C)),g.setState({userSelectionActive:!1,userSelectionRect:null,nodesSelectionActive:$.current.size>0}),i==null||i(C),(t||o)&&(R.current=!1),A.current=!1},N=r===!0||Array.isArray(r)&&r.includes(0);return p.jsxs("div",{className:se(["react-flow__pane",{draggable:N,dragging:_,selection:e}]),onClick:m?void 0:wr(j,w),onContextMenu:wr(H,w),onWheel:wr(L,w),onPointerEnter:m?void 0:d,onPointerDown:m?O:f,onPointerMove:m?y:f,onPointerUp:m?k:void 0,onPointerLeave:u,ref:w,style:tr,children:[h,p.jsx(yy,{})]})}function Zr({id:e,store:t,unselect:n=!1,nodeRef:r}){const{addSelectedNodes:o,unselectNodesAndEdges:s,multiSelectionActive:i,nodeLookup:a,onError:c}=t.getState(),l=a.get(e);if(!l){c==null||c("012",Se.error012(e));return}t.setState({nodesSelectionActive:!1}),l.selected?(n||l.selected&&i)&&(s({nodes:[l],edges:[]}),requestAnimationFrame(()=>{var d;return(d=r==null?void 0:r.current)==null?void 0:d.blur()})):o([e])}function Dc({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:r,nodeId:o,isSelectable:s,nodeClickDistance:i}){const a=re(),[c,l]=v.useState(!1),d=v.useRef();return v.useEffect(()=>{d.current=u0({getStoreItems:()=>a.getState(),onNodeMouseDown:f=>{Zr({id:f,store:a,nodeRef:e})},onDragStart:()=>{l(!0)},onDragStop:()=>{l(!1)}})},[]),v.useEffect(()=>{var f,u;if(t)(f=d.current)==null||f.destroy();else if(e.current)return(u=d.current)==null||u.update({noDragClassName:n,handleSelector:r,domNode:e.current,isSelectable:s,nodeId:o,nodeClickDistance:i}),()=>{var h;(h=d.current)==null||h.destroy()}},[n,r,t,s,e,o]),c}const _y=e=>t=>t.selected&&(t.draggable||e&&typeof t.draggable>"u");function jc(){const e=re();return v.useCallback(n=>{const{nodeExtent:r,snapToGrid:o,snapGrid:s,nodesDraggable:i,onError:a,updateNodePositions:c,nodeLookup:l,nodeOrigin:d}=e.getState(),f=new Map,u=_y(i),h=o?s[0]:5,g=o?s[1]:5,x=n.direction.x*h*n.factor,b=n.direction.y*g*n.factor;for(const[,_]of l){if(!u(_))continue;let E={x:_.internals.positionAbsolute.x+x,y:_.internals.positionAbsolute.y+b};o&&(E=Zn(E,s));const{position:m,positionAbsolute:w}=Qa({nodeId:_.id,nextPosition:E,nodeLookup:l,nodeExtent:r,nodeOrigin:d,onError:a});_.position=m,_.internals.positionAbsolute=w,f.set(_.id,_)}c(f)},[])}const $o=v.createContext(null),by=$o.Provider;$o.Consumer;const Rc=()=>v.useContext($o),vy=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId}),Ey=(e,t,n)=>r=>{const{connectionClickStartHandle:o,connectionMode:s,connection:i}=r,{fromHandle:a,toHandle:c,isValid:l}=i,d=(c==null?void 0:c.nodeId)===e&&(c==null?void 0:c.id)===t&&(c==null?void 0:c.type)===n;return{connectingFrom:(a==null?void 0:a.nodeId)===e&&(a==null?void 0:a.id)===t&&(a==null?void 0:a.type)===n,connectingTo:d,clickConnecting:(o==null?void 0:o.nodeId)===e&&(o==null?void 0:o.id)===t&&(o==null?void 0:o.type)===n,isPossibleEndHandle:s===xt.Strict?(a==null?void 0:a.type)!==n:e!==(a==null?void 0:a.nodeId)||t!==(a==null?void 0:a.id),connectionInProcess:!!a,clickConnectionInProcess:!!o,valid:d&&l}};function Ny({type:e="source",position:t=X.Top,isValidConnection:n,isConnectable:r=!0,isConnectableStart:o=!0,isConnectableEnd:s=!0,id:i,onConnect:a,children:c,className:l,onMouseDown:d,onTouchStart:f,...u},h){var k,N;const g=i||null,x=e==="target",b=re(),_=Rc(),{connectOnClick:E,noPanClassName:m,rfId:w}=Z(vy,oe),{connectingFrom:T,connectingTo:$,clickConnecting:I,isPossibleEndHandle:R,connectionInProcess:A,clickConnectionInProcess:j,valid:H}=Z(Ey(_,g,e),oe);_||(N=(k=b.getState()).onError)==null||N.call(k,"010",Se.error010());const L=C=>{const{defaultEdgeOptions:M,onConnect:S,hasDefaultEdges:D}=b.getState(),F={...M,...C};if(D){const{edges:V,setEdges:Y}=b.getState();Y(dc(F,V))}S==null||S(F),a==null||a(F)},O=C=>{if(!_)return;const M=ac(C.nativeEvent);if(o&&(M&&C.button===0||!M)){const S=b.getState();Kr.onPointerDown(C.nativeEvent,{autoPanOnConnect:S.autoPanOnConnect,connectionMode:S.connectionMode,connectionRadius:S.connectionRadius,domNode:S.domNode,nodeLookup:S.nodeLookup,lib:S.lib,isTarget:x,handleId:g,nodeId:_,flowId:S.rfId,panBy:S.panBy,cancelConnection:S.cancelConnection,onConnectStart:S.onConnectStart,onConnectEnd:S.onConnectEnd,updateConnection:S.updateConnection,onConnect:L,isValidConnection:n||S.isValidConnection,getTransform:()=>b.getState().transform,getFromHandle:()=>b.getState().connection.fromHandle,autoPanSpeed:S.autoPanSpeed})}M?d==null||d(C):f==null||f(C)},y=C=>{const{onClickConnectStart:M,onClickConnectEnd:S,connectionClickStartHandle:D,connectionMode:F,isValidConnection:V,lib:Y,rfId:U,nodeLookup:P,connection:B}=b.getState();if(!_||!D&&!o)return;if(!D){M==null||M(C.nativeEvent,{nodeId:_,handleId:g,handleType:e}),b.setState({connectionClickStartHandle:{nodeId:_,type:e,id:g}});return}const z=sc(C.target),W=n||V,{connection:q,isValid:Q}=Kr.isValid(C.nativeEvent,{handle:{nodeId:_,id:g,type:e},connectionMode:F,fromNodeId:D.nodeId,fromHandleId:D.id||null,fromType:D.type,isValidConnection:W,flowId:U,doc:z,lib:Y,nodeLookup:P});Q&&q&&L(q);const K=structuredClone(B);delete K.inProgress,K.toPosition=K.toHandle?K.toHandle.position:null,S==null||S(C,K),b.setState({connectionClickStartHandle:null})};return p.jsx("div",{"data-handleid":g,"data-nodeid":_,"data-handlepos":t,"data-id":`${w}-${_}-${g}-${e}`,className:se(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",m,l,{source:!x,target:x,connectable:r,connectablestart:o,connectableend:s,clickconnecting:I,connectingfrom:T,connectingto:$,valid:H,connectionindicator:r&&(!A||R)&&(A||j?s:o)}]),onMouseDown:O,onTouchStart:O,onClick:E?y:void 0,ref:h,...u,children:c})}const vt=v.memo($c(Ny));function Sy({data:e,isConnectable:t,sourcePosition:n=X.Bottom}){return p.jsxs(p.Fragment,{children:[e==null?void 0:e.label,p.jsx(vt,{type:"source",position:n,isConnectable:t})]})}function Cy({data:e,isConnectable:t,targetPosition:n=X.Top,sourcePosition:r=X.Bottom}){return p.jsxs(p.Fragment,{children:[p.jsx(vt,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label,p.jsx(vt,{type:"source",position:r,isConnectable:t})]})}function ky(){return null}function Iy({data:e,isConnectable:t,targetPosition:n=X.Top}){return p.jsxs(p.Fragment,{children:[p.jsx(vt,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label]})}const Ln={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},Qs={input:Sy,default:Cy,output:Iy,group:ky};function Ty(e){var t,n,r,o;return e.internals.handleBounds===void 0?{width:e.width??e.initialWidth??((t=e.style)==null?void 0:t.width),height:e.height??e.initialHeight??((n=e.style)==null?void 0:n.height)}:{width:e.width??((r=e.style)==null?void 0:r.width),height:e.height??((o=e.style)==null?void 0:o.height)}}const My=e=>{const{width:t,height:n,x:r,y:o}=Qt(e.nodeLookup,{filter:s=>!!s.selected});return{width:_e(t)?t:null,height:_e(n)?n:null,userSelectionActive:e.userSelectionActive,transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${r}px,${o}px)`}};function $y({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const r=re(),{width:o,height:s,transformString:i,userSelectionActive:a}=Z(My,oe),c=jc(),l=v.useRef(null);if(v.useEffect(()=>{var u;n||(u=l.current)==null||u.focus({preventScroll:!0})},[n]),Dc({nodeRef:l}),a||!o||!s)return null;const d=e?u=>{const h=r.getState().nodes.filter(g=>g.selected);e(u,h)}:void 0,f=u=>{Object.prototype.hasOwnProperty.call(Ln,u.key)&&(u.preventDefault(),c({direction:Ln[u.key],factor:u.shiftKey?4:1}))};return p.jsx("div",{className:se(["react-flow__nodesselection","react-flow__container",t]),style:{transform:i},children:p.jsx("div",{ref:l,className:"react-flow__nodesselection-rect",onContextMenu:d,tabIndex:n?void 0:-1,onKeyDown:n?void 0:f,style:{width:o,height:s}})})}const ei=typeof window<"u"?window:void 0,Ay=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function Pc({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:o,onPaneContextMenu:s,onPaneScroll:i,paneClickDistance:a,deleteKeyCode:c,selectionKeyCode:l,selectionOnDrag:d,selectionMode:f,onSelectionStart:u,onSelectionEnd:h,multiSelectionKeyCode:g,panActivationKeyCode:x,zoomActivationKeyCode:b,elementsSelectable:_,zoomOnScroll:E,zoomOnPinch:m,panOnScroll:w,panOnScrollSpeed:T,panOnScrollMode:$,zoomOnDoubleClick:I,panOnDrag:R,defaultViewport:A,translateExtent:j,minZoom:H,maxZoom:L,preventScrolling:O,onSelectionContextMenu:y,noWheelClassName:k,noPanClassName:N,disableKeyboardA11y:C,onViewportChange:M,isControlledViewport:S}){const{nodesSelectionActive:D,userSelectionActive:F}=Z(Ay),V=Gt(l,{target:ei}),Y=Gt(x,{target:ei}),U=Y||R,P=Y||w,B=d&&U!==!0,z=V||F||B;return fy({deleteKeyCode:c,multiSelectionKeyCode:g}),p.jsx(gy,{onPaneContextMenu:s,elementsSelectable:_,zoomOnScroll:E,zoomOnPinch:m,panOnScroll:P,panOnScrollSpeed:T,panOnScrollMode:$,zoomOnDoubleClick:I,panOnDrag:!V&&U,defaultViewport:A,translateExtent:j,minZoom:H,maxZoom:L,zoomActivationKeyCode:b,preventScrolling:O,noWheelClassName:k,noPanClassName:N,onViewportChange:M,isControlledViewport:S,paneClickDistance:a,children:p.jsxs(wy,{onSelectionStart:u,onSelectionEnd:h,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:o,onPaneContextMenu:s,onPaneScroll:i,panOnDrag:U,isSelecting:!!z,selectionMode:f,selectionKeyPressed:V,selectionOnDrag:B,children:[e,D&&p.jsx($y,{onSelectionContextMenu:y,noPanClassName:N,disableKeyboardA11y:C})]})})}Pc.displayName="FlowRenderer";const Dy=v.memo(Pc),jy=e=>t=>e?Ja(t.nodeLookup,{x:0,y:0,width:t.width,height:t.height},t.transform,!0).map(n=>n.id):Array.from(t.nodeLookup.keys());function Ry(e){return Z(v.useCallback(jy(e),[e]),oe)}const Py=e=>e.updateNodeInternals;function Oy(){const e=Z(Py),[t]=v.useState(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(n=>{const r=new Map;n.forEach(o=>{const s=o.target.getAttribute("data-id");r.set(s,{id:s,nodeElement:o.target,force:!0})}),e(r)}));return v.useEffect(()=>()=>{t==null||t.disconnect()},[t]),t}function Ly({node:e,nodeType:t,hasDimensions:n,resizeObserver:r}){const o=re(),s=v.useRef(null),i=v.useRef(null),a=v.useRef(e.sourcePosition),c=v.useRef(e.targetPosition),l=v.useRef(t),d=n&&!!e.internals.handleBounds;return v.useEffect(()=>{s.current&&!e.hidden&&(!d||i.current!==s.current)&&(i.current&&(r==null||r.unobserve(i.current)),r==null||r.observe(s.current),i.current=s.current)},[d,e.hidden]),v.useEffect(()=>()=>{i.current&&(r==null||r.unobserve(i.current),i.current=null)},[]),v.useEffect(()=>{if(s.current){const f=l.current!==t,u=a.current!==e.sourcePosition,h=c.current!==e.targetPosition;(f||u||h)&&(l.current=t,a.current=e.sourcePosition,c.current=e.targetPosition,o.getState().updateNodeInternals(new Map([[e.id,{id:e.id,nodeElement:s.current,force:!0}]])))}},[e.id,t,e.sourcePosition,e.targetPosition]),s}function Hy({id:e,onClick:t,onMouseEnter:n,onMouseMove:r,onMouseLeave:o,onContextMenu:s,onDoubleClick:i,nodesDraggable:a,elementsSelectable:c,nodesConnectable:l,nodesFocusable:d,resizeObserver:f,noDragClassName:u,noPanClassName:h,disableKeyboardA11y:g,rfId:x,nodeTypes:b,nodeClickDistance:_,onError:E}){const{node:m,internals:w,isParent:T}=Z(z=>{const W=z.nodeLookup.get(e),q=z.parentLookup.has(e);return{node:W,internals:W.internals,isParent:q}},oe);let $=m.type||"default",I=(b==null?void 0:b[$])||Qs[$];I===void 0&&(E==null||E("003",Se.error003($)),$="default",I=Qs.default);const R=!!(m.draggable||a&&typeof m.draggable>"u"),A=!!(m.selectable||c&&typeof m.selectable>"u"),j=!!(m.connectable||l&&typeof m.connectable>"u"),H=!!(m.focusable||d&&typeof m.focusable>"u"),L=re(),O=rc(m),y=Ly({node:m,nodeType:$,hasDimensions:O,resizeObserver:f}),k=Dc({nodeRef:y,disabled:m.hidden||!R,noDragClassName:u,handleSelector:m.dragHandle,nodeId:e,isSelectable:A,nodeClickDistance:_}),N=jc();if(m.hidden)return null;const C=je(m),M=Ty(m),S=A||R||t||n||r||o,D=n?z=>n(z,{...w.userNode}):void 0,F=r?z=>r(z,{...w.userNode}):void 0,V=o?z=>o(z,{...w.userNode}):void 0,Y=s?z=>s(z,{...w.userNode}):void 0,U=i?z=>i(z,{...w.userNode}):void 0,P=z=>{const{selectNodesOnDrag:W,nodeDragThreshold:q}=L.getState();A&&(!W||!R||q>0)&&Zr({id:e,store:L,nodeRef:y}),t&&t(z,{...w.userNode})},B=z=>{if(!(ic(z.nativeEvent)||g))if(Ga.includes(z.key)&&A){const W=z.key==="Escape";Zr({id:e,store:L,unselect:W,nodeRef:y})}else R&&m.selected&&Object.prototype.hasOwnProperty.call(Ln,z.key)&&(z.preventDefault(),L.setState({ariaLiveMessage:`Moved selected node ${z.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~w.positionAbsolute.x}, y: ${~~w.positionAbsolute.y}`}),N({direction:Ln[z.key],factor:z.shiftKey?4:1}))};return p.jsx("div",{className:se(["react-flow__node",`react-flow__node-${$}`,{[h]:R},m.className,{selected:m.selected,selectable:A,parent:T,draggable:R,dragging:k}]),ref:y,style:{zIndex:w.z,transform:`translate(${w.positionAbsolute.x}px,${w.positionAbsolute.y}px)`,pointerEvents:S?"all":"none",visibility:O?"visible":"hidden",...m.style,...M},"data-id":e,"data-testid":`rf__node-${e}`,onMouseEnter:D,onMouseMove:F,onMouseLeave:V,onContextMenu:Y,onClick:P,onDoubleClick:U,onKeyDown:H?B:void 0,tabIndex:H?0:void 0,role:H?"button":void 0,"aria-describedby":g?void 0:`${Sc}-${x}`,"aria-label":m.ariaLabel,children:p.jsx(by,{value:e,children:p.jsx(I,{id:e,data:m.data,type:$,positionAbsoluteX:w.positionAbsolute.x,positionAbsoluteY:w.positionAbsolute.y,selected:m.selected??!1,selectable:A,draggable:R,deletable:m.deletable??!0,isConnectable:j,sourcePosition:m.sourcePosition,targetPosition:m.targetPosition,dragging:k,dragHandle:m.dragHandle,zIndex:w.z,parentId:m.parentId,...C})})})}const Fy=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function Oc(e){const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:o,onError:s}=Z(Fy,oe),i=Ry(e.onlyRenderVisibleElements),a=Oy();return p.jsx("div",{className:"react-flow__nodes",style:tr,children:i.map(c=>p.jsx(Hy,{id:c,nodeTypes:e.nodeTypes,nodeExtent:e.nodeExtent,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,resizeObserver:a,nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:o,nodeClickDistance:e.nodeClickDistance,onError:s},c))})}Oc.displayName="NodeRenderer";const zy=v.memo(Oc);function By(e){return Z(v.useCallback(n=>{if(!e)return n.edges.map(o=>o.id);const r=[];if(n.width&&n.height)for(const o of n.edges){const s=n.nodeLookup.get(o.source),i=n.nodeLookup.get(o.target);s&&i&&qm({sourceNode:s,targetNode:i,width:n.width,height:n.height,transform:n.transform})&&r.push(o.id)}return r},[e]),oe)}const Vy=({color:e="none",strokeWidth:t=1})=>p.jsx("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),Wy=({color:e="none",strokeWidth:t=1})=>p.jsx("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),ti={[jn.Arrow]:Vy,[jn.ArrowClosed]:Wy};function Yy(e){const t=re();return v.useMemo(()=>{var o,s;return Object.prototype.hasOwnProperty.call(ti,e)?ti[e]:((s=(o=t.getState()).onError)==null||s.call(o,"009",Se.error009(e)),null)},[e])}const Uy=({id:e,type:t,color:n,width:r=12.5,height:o=12.5,markerUnits:s="strokeWidth",strokeWidth:i,orient:a="auto-start-reverse"})=>{const c=Yy(t);return c?p.jsx("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${r}`,markerHeight:`${o}`,viewBox:"-10 -10 20 20",markerUnits:s,orient:a,refX:"0",refY:"0",children:p.jsx(c,{color:n,strokeWidth:i})}):null},Lc=({defaultColor:e,rfId:t})=>{const n=Z(s=>s.edges),r=Z(s=>s.defaultEdgeOptions),o=v.useMemo(()=>n0(n,{id:t,defaultColor:e,defaultMarkerStart:r==null?void 0:r.markerStart,defaultMarkerEnd:r==null?void 0:r.markerEnd}),[n,r,t,e]);return o.length?p.jsx("svg",{className:"react-flow__marker",children:p.jsx("defs",{children:o.map(s=>p.jsx(Uy,{id:s.id,type:s.type,color:s.color,width:s.width,height:s.height,markerUnits:s.markerUnits,strokeWidth:s.strokeWidth,orient:s.orient},s.id))})}):null};Lc.displayName="MarkerDefinitions";var Xy=v.memo(Lc);function Hc({x:e,y:t,label:n,labelStyle:r,labelShowBg:o=!0,labelBgStyle:s,labelBgPadding:i=[2,4],labelBgBorderRadius:a=2,children:c,className:l,...d}){const[f,u]=v.useState({x:1,y:0,width:0,height:0}),h=se(["react-flow__edge-textwrapper",l]),g=v.useRef(null);return v.useEffect(()=>{if(g.current){const x=g.current.getBBox();u({x:x.x,y:x.y,width:x.width,height:x.height})}},[n]),n?p.jsxs("g",{transform:`translate(${e-f.width/2} ${t-f.height/2})`,className:h,visibility:f.width?"visible":"hidden",...d,children:[o&&p.jsx("rect",{width:f.width+2*i[0],x:-i[0],y:-i[1],height:f.height+2*i[1],className:"react-flow__edge-textbg",style:s,rx:a,ry:a}),p.jsx("text",{className:"react-flow__edge-text",y:f.height/2,dy:"0.3em",ref:g,style:r,children:n}),c]}):null}Hc.displayName="EdgeText";const Gy=v.memo(Hc);function nr({path:e,labelX:t,labelY:n,label:r,labelStyle:o,labelShowBg:s,labelBgStyle:i,labelBgPadding:a,labelBgBorderRadius:c,interactionWidth:l=20,...d}){return p.jsxs(p.Fragment,{children:[p.jsx("path",{...d,d:e,fill:"none",className:se(["react-flow__edge-path",d.className])}),l&&p.jsx("path",{d:e,fill:"none",strokeOpacity:0,strokeWidth:l,className:"react-flow__edge-interaction"}),r&&_e(t)&&_e(n)?p.jsx(Gy,{x:t,y:n,label:r,labelStyle:o,labelShowBg:s,labelBgStyle:i,labelBgPadding:a,labelBgBorderRadius:c}):null]})}function ni({pos:e,x1:t,y1:n,x2:r,y2:o}){return e===X.Left||e===X.Right?[.5*(t+r),n]:[t,.5*(n+o)]}function Fc({sourceX:e,sourceY:t,sourcePosition:n=X.Bottom,targetX:r,targetY:o,targetPosition:s=X.Top}){const[i,a]=ni({pos:n,x1:e,y1:t,x2:r,y2:o}),[c,l]=ni({pos:s,x1:r,y1:o,x2:e,y2:t}),[d,f,u,h]=cc({sourceX:e,sourceY:t,targetX:r,targetY:o,sourceControlX:i,sourceControlY:a,targetControlX:c,targetControlY:l});return[`M${e},${t} C${i},${a} ${c},${l} ${r},${o}`,d,f,u,h]}function zc(e){return v.memo(({id:t,sourceX:n,sourceY:r,targetX:o,targetY:s,sourcePosition:i=X.Bottom,targetPosition:a=X.Top,label:c,labelStyle:l,labelShowBg:d,labelBgStyle:f,labelBgPadding:u,labelBgBorderRadius:h,style:g,markerEnd:x,markerStart:b,interactionWidth:_})=>{const[E,m,w]=Fc({sourceX:n,sourceY:r,sourcePosition:i,targetX:o,targetY:s,targetPosition:a}),T=e.isInternal?void 0:t;return p.jsx(nr,{id:T,path:E,labelX:m,labelY:w,label:c,labelStyle:l,labelShowBg:d,labelBgStyle:f,labelBgPadding:u,labelBgBorderRadius:h,style:g,markerEnd:x,markerStart:b,interactionWidth:_})})}const qy=zc({isInternal:!1}),Bc=zc({isInternal:!0});qy.displayName="SimpleBezierEdge";Bc.displayName="SimpleBezierEdgeInternal";function Vc(e){return v.memo(({id:t,sourceX:n,sourceY:r,targetX:o,targetY:s,label:i,labelStyle:a,labelShowBg:c,labelBgStyle:l,labelBgPadding:d,labelBgBorderRadius:f,style:u,sourcePosition:h=X.Bottom,targetPosition:g=X.Top,markerEnd:x,markerStart:b,pathOptions:_,interactionWidth:E})=>{const[m,w,T]=Xr({sourceX:n,sourceY:r,sourcePosition:h,targetX:o,targetY:s,targetPosition:g,borderRadius:_==null?void 0:_.borderRadius,offset:_==null?void 0:_.offset}),$=e.isInternal?void 0:t;return p.jsx(nr,{id:$,path:m,labelX:w,labelY:T,label:i,labelStyle:a,labelShowBg:c,labelBgStyle:l,labelBgPadding:d,labelBgBorderRadius:f,style:u,markerEnd:x,markerStart:b,interactionWidth:E})})}const Wc=Vc({isInternal:!1}),Yc=Vc({isInternal:!0});Wc.displayName="SmoothStepEdge";Yc.displayName="SmoothStepEdgeInternal";function Uc(e){return v.memo(({id:t,...n})=>{var o;const r=e.isInternal?void 0:t;return p.jsx(Wc,{...n,id:r,pathOptions:v.useMemo(()=>{var s;return{borderRadius:0,offset:(s=n.pathOptions)==null?void 0:s.offset}},[(o=n.pathOptions)==null?void 0:o.offset])})})}const Ky=Uc({isInternal:!1}),Xc=Uc({isInternal:!0});Ky.displayName="StepEdge";Xc.displayName="StepEdgeInternal";function Gc(e){return v.memo(({id:t,sourceX:n,sourceY:r,targetX:o,targetY:s,label:i,labelStyle:a,labelShowBg:c,labelBgStyle:l,labelBgPadding:d,labelBgBorderRadius:f,style:u,markerEnd:h,markerStart:g,interactionWidth:x})=>{const[b,_,E]=fc({sourceX:n,sourceY:r,targetX:o,targetY:s}),m=e.isInternal?void 0:t;return p.jsx(nr,{id:m,path:b,labelX:_,labelY:E,label:i,labelStyle:a,labelShowBg:c,labelBgStyle:l,labelBgPadding:d,labelBgBorderRadius:f,style:u,markerEnd:h,markerStart:g,interactionWidth:x})})}const Zy=Gc({isInternal:!1}),qc=Gc({isInternal:!0});Zy.displayName="StraightEdge";qc.displayName="StraightEdgeInternal";function Kc(e){return v.memo(({id:t,sourceX:n,sourceY:r,targetX:o,targetY:s,sourcePosition:i=X.Bottom,targetPosition:a=X.Top,label:c,labelStyle:l,labelShowBg:d,labelBgStyle:f,labelBgPadding:u,labelBgBorderRadius:h,style:g,markerEnd:x,markerStart:b,pathOptions:_,interactionWidth:E})=>{const[m,w,T]=lc({sourceX:n,sourceY:r,sourcePosition:i,targetX:o,targetY:s,targetPosition:a,curvature:_==null?void 0:_.curvature}),$=e.isInternal?void 0:t;return p.jsx(nr,{id:$,path:m,labelX:w,labelY:T,label:c,labelStyle:l,labelShowBg:d,labelBgStyle:f,labelBgPadding:u,labelBgBorderRadius:h,style:g,markerEnd:x,markerStart:b,interactionWidth:E})})}const Jy=Kc({isInternal:!1}),Zc=Kc({isInternal:!0});Jy.displayName="BezierEdge";Zc.displayName="BezierEdgeInternal";const ri={default:Zc,straight:qc,step:Xc,smoothstep:Yc,simplebezier:Bc},oi={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},Qy=(e,t,n)=>n===X.Left?e-t:n===X.Right?e+t:e,ex=(e,t,n)=>n===X.Top?e-t:n===X.Bottom?e+t:e,si="react-flow__edgeupdater";function ii({position:e,centerX:t,centerY:n,radius:r=10,onMouseDown:o,onMouseEnter:s,onMouseOut:i,type:a}){return p.jsx("circle",{onMouseDown:o,onMouseEnter:s,onMouseOut:i,className:se([si,`${si}-${a}`]),cx:Qy(t,r,e),cy:ex(n,r,e),r,stroke:"transparent",fill:"transparent"})}function tx({isReconnectable:e,reconnectRadius:t,edge:n,sourceX:r,sourceY:o,targetX:s,targetY:i,sourcePosition:a,targetPosition:c,onReconnect:l,onReconnectStart:d,onReconnectEnd:f,setReconnecting:u,setUpdateHover:h}){const g=re(),x=(w,T)=>{if(w.button!==0)return;const{autoPanOnConnect:$,domNode:I,isValidConnection:R,connectionMode:A,connectionRadius:j,lib:H,onConnectStart:L,onConnectEnd:O,cancelConnection:y,nodeLookup:k,rfId:N,panBy:C,updateConnection:M}=g.getState(),S=T.type==="target";u(!0),d==null||d(w,n,T.type);const D=(V,Y)=>{u(!1),f==null||f(V,n,T.type,Y)},F=V=>l==null?void 0:l(n,V);Kr.onPointerDown(w.nativeEvent,{autoPanOnConnect:$,connectionMode:A,connectionRadius:j,domNode:I,handleId:T.id,nodeId:T.nodeId,nodeLookup:k,isTarget:S,edgeUpdaterType:T.type,lib:H,flowId:N,cancelConnection:y,panBy:C,isValidConnection:R,onConnect:F,onConnectStart:L,onConnectEnd:O,onReconnectEnd:D,updateConnection:M,getTransform:()=>g.getState().transform,getFromHandle:()=>g.getState().connection.fromHandle})},b=w=>x(w,{nodeId:n.target,id:n.targetHandle??null,type:"target"}),_=w=>x(w,{nodeId:n.source,id:n.sourceHandle??null,type:"source"}),E=()=>h(!0),m=()=>h(!1);return p.jsxs(p.Fragment,{children:[(e===!0||e==="source")&&p.jsx(ii,{position:a,centerX:r,centerY:o,radius:t,onMouseDown:b,onMouseEnter:E,onMouseOut:m,type:"source"}),(e===!0||e==="target")&&p.jsx(ii,{position:c,centerX:s,centerY:i,radius:t,onMouseDown:_,onMouseEnter:E,onMouseOut:m,type:"target"})]})}function nx({id:e,edgesFocusable:t,edgesReconnectable:n,elementsSelectable:r,onClick:o,onDoubleClick:s,onContextMenu:i,onMouseEnter:a,onMouseMove:c,onMouseLeave:l,reconnectRadius:d,onReconnect:f,onReconnectStart:u,onReconnectEnd:h,rfId:g,edgeTypes:x,noPanClassName:b,onError:_,disableKeyboardA11y:E}){let m=Z(G=>G.edgeLookup.get(e));const w=Z(G=>G.defaultEdgeOptions);m=w?{...w,...m}:m;let T=m.type||"default",$=(x==null?void 0:x[T])||ri[T];$===void 0&&(_==null||_("011",Se.error011(T)),T="default",$=ri.default);const I=!!(m.focusable||t&&typeof m.focusable>"u"),R=typeof f<"u"&&(m.reconnectable||n&&typeof m.reconnectable>"u"),A=!!(m.selectable||r&&typeof m.selectable>"u"),j=v.useRef(null),[H,L]=v.useState(!1),[O,y]=v.useState(!1),k=re(),{zIndex:N,sourceX:C,sourceY:M,targetX:S,targetY:D,sourcePosition:F,targetPosition:V}=Z(v.useCallback(G=>{const ne=G.nodeLookup.get(m.source),J=G.nodeLookup.get(m.target);if(!ne||!J)return{zIndex:m.zIndex,...oi};const ae=t0({id:e,sourceNode:ne,targetNode:J,sourceHandle:m.sourceHandle||null,targetHandle:m.targetHandle||null,connectionMode:G.connectionMode,onError:_});return{zIndex:Gm({selected:m.selected,zIndex:m.zIndex,sourceNode:ne,targetNode:J,elevateOnSelect:G.elevateEdgesOnSelect}),...ae||oi}},[m.source,m.target,m.sourceHandle,m.targetHandle,m.selected,m.zIndex]),oe),Y=v.useMemo(()=>m.markerStart?`url('#${Gr(m.markerStart,g)}')`:void 0,[m.markerStart,g]),U=v.useMemo(()=>m.markerEnd?`url('#${Gr(m.markerEnd,g)}')`:void 0,[m.markerEnd,g]);if(m.hidden||C===null||M===null||S===null||D===null)return null;const P=G=>{var ge;const{addSelectedEdges:ne,unselectNodesAndEdges:J,multiSelectionActive:ae}=k.getState();A&&(k.setState({nodesSelectionActive:!1}),m.selected&&ae?(J({nodes:[],edges:[m]}),(ge=j.current)==null||ge.blur()):ne([e])),o&&o(G,m)},B=s?G=>{s(G,{...m})}:void 0,z=i?G=>{i(G,{...m})}:void 0,W=a?G=>{a(G,{...m})}:void 0,q=c?G=>{c(G,{...m})}:void 0,Q=l?G=>{l(G,{...m})}:void 0,K=G=>{var ne;if(!E&&Ga.includes(G.key)&&A){const{unselectNodesAndEdges:J,addSelectedEdges:ae}=k.getState();G.key==="Escape"?((ne=j.current)==null||ne.blur(),J({edges:[m]})):ae([e])}};return p.jsx("svg",{style:{zIndex:N},children:p.jsxs("g",{className:se(["react-flow__edge",`react-flow__edge-${T}`,m.className,b,{selected:m.selected,animated:m.animated,inactive:!A&&!o,updating:H,selectable:A}]),onClick:P,onDoubleClick:B,onContextMenu:z,onMouseEnter:W,onMouseMove:q,onMouseLeave:Q,onKeyDown:I?K:void 0,tabIndex:I?0:void 0,role:I?"button":"img","data-id":e,"data-testid":`rf__edge-${e}`,"aria-label":m.ariaLabel===null?void 0:m.ariaLabel||`Edge from ${m.source} to ${m.target}`,"aria-describedby":I?`${Cc}-${g}`:void 0,ref:j,children:[!O&&p.jsx($,{id:e,source:m.source,target:m.target,type:m.type,selected:m.selected,animated:m.animated,selectable:A,deletable:m.deletable??!0,label:m.label,labelStyle:m.labelStyle,labelShowBg:m.labelShowBg,labelBgStyle:m.labelBgStyle,labelBgPadding:m.labelBgPadding,labelBgBorderRadius:m.labelBgBorderRadius,sourceX:C,sourceY:M,targetX:S,targetY:D,sourcePosition:F,targetPosition:V,data:m.data,style:m.style,sourceHandleId:m.sourceHandle,targetHandleId:m.targetHandle,markerStart:Y,markerEnd:U,pathOptions:"pathOptions"in m?m.pathOptions:void 0,interactionWidth:m.interactionWidth}),R&&p.jsx(tx,{edge:m,isReconnectable:R,reconnectRadius:d,onReconnect:f,onReconnectStart:u,onReconnectEnd:h,sourceX:C,sourceY:M,targetX:S,targetY:D,sourcePosition:F,targetPosition:V,setUpdateHover:L,setReconnecting:y})]})})}const rx=e=>({edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function Jc({defaultMarkerColor:e,onlyRenderVisibleElements:t,rfId:n,edgeTypes:r,noPanClassName:o,onReconnect:s,onEdgeContextMenu:i,onEdgeMouseEnter:a,onEdgeMouseMove:c,onEdgeMouseLeave:l,onEdgeClick:d,reconnectRadius:f,onEdgeDoubleClick:u,onReconnectStart:h,onReconnectEnd:g,disableKeyboardA11y:x}){const{edgesFocusable:b,edgesReconnectable:_,elementsSelectable:E,onError:m}=Z(rx,oe),w=By(t);return p.jsxs("div",{className:"react-flow__edges",children:[p.jsx(Xy,{defaultColor:e,rfId:n}),w.map(T=>p.jsx(nx,{id:T,edgesFocusable:b,edgesReconnectable:_,elementsSelectable:E,noPanClassName:o,onReconnect:s,onContextMenu:i,onMouseEnter:a,onMouseMove:c,onMouseLeave:l,onClick:d,reconnectRadius:f,onDoubleClick:u,onReconnectStart:h,onReconnectEnd:g,rfId:n,onError:m,edgeTypes:r,disableKeyboardA11y:x},T))]})}Jc.displayName="EdgeRenderer";const ox=v.memo(Jc),sx=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function ix({children:e}){const t=Z(sx);return p.jsx("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:t},children:e})}function ax(e){const t=Mo(),n=v.useRef(!1);v.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const cx=e=>{var t;return(t=e.panZoom)==null?void 0:t.syncViewport};function lx(e){const t=Z(cx),n=re();return v.useEffect(()=>{e&&(t==null||t(e),n.setState({transform:[e.x,e.y,e.zoom]}))},[e,t]),null}function ux(e){return e.connection.inProgress?{...e.connection,to:en(e.connection.to,e.transform)}:{...e.connection}}function dx(e){return ux}function fx(e){const t=dx();return Z(t,oe)}const hx=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function px({containerStyle:e,style:t,type:n,component:r}){const{nodesConnectable:o,width:s,height:i,isValid:a,inProgress:c}=Z(hx,oe);return!(s&&o&&c)?null:p.jsx("svg",{style:e,width:s,height:i,className:"react-flow__connectionline react-flow__container",children:p.jsx("g",{className:se(["react-flow__connection",Ka(a)]),children:p.jsx(Qc,{style:t,type:n,CustomComponent:r,isValid:a})})})}const Qc=({style:e,type:t=Fe.Bezier,CustomComponent:n,isValid:r})=>{const{inProgress:o,from:s,fromNode:i,fromHandle:a,fromPosition:c,to:l,toNode:d,toHandle:f,toPosition:u}=fx();if(!o)return;if(n)return p.jsx(n,{connectionLineType:t,connectionLineStyle:e,fromNode:i,fromHandle:a,fromX:s.x,fromY:s.y,toX:l.x,toY:l.y,fromPosition:c,toPosition:u,connectionStatus:Ka(r),toNode:d,toHandle:f});let h="";const g={sourceX:s.x,sourceY:s.y,sourcePosition:c,targetX:l.x,targetY:l.y,targetPosition:u};switch(t){case Fe.Bezier:[h]=lc(g);break;case Fe.SimpleBezier:[h]=Fc(g);break;case Fe.Step:[h]=Xr({...g,borderRadius:0});break;case Fe.SmoothStep:[h]=Xr(g);break;default:[h]=fc(g)}return p.jsx("path",{d:h,fill:"none",className:"react-flow__connection-path",style:e})};Qc.displayName="ConnectionLine";const gx={};function ai(e=gx){v.useRef(e),re(),v.useEffect(()=>{},[e])}function mx(){re(),v.useRef(!1),v.useEffect(()=>{},[])}function el({nodeTypes:e,edgeTypes:t,onInit:n,onNodeClick:r,onEdgeClick:o,onNodeDoubleClick:s,onEdgeDoubleClick:i,onNodeMouseEnter:a,onNodeMouseMove:c,onNodeMouseLeave:l,onNodeContextMenu:d,onSelectionContextMenu:f,onSelectionStart:u,onSelectionEnd:h,connectionLineType:g,connectionLineStyle:x,connectionLineComponent:b,connectionLineContainerStyle:_,selectionKeyCode:E,selectionOnDrag:m,selectionMode:w,multiSelectionKeyCode:T,panActivationKeyCode:$,zoomActivationKeyCode:I,deleteKeyCode:R,onlyRenderVisibleElements:A,elementsSelectable:j,defaultViewport:H,translateExtent:L,minZoom:O,maxZoom:y,preventScrolling:k,defaultMarkerColor:N,zoomOnScroll:C,zoomOnPinch:M,panOnScroll:S,panOnScrollSpeed:D,panOnScrollMode:F,zoomOnDoubleClick:V,panOnDrag:Y,onPaneClick:U,onPaneMouseEnter:P,onPaneMouseMove:B,onPaneMouseLeave:z,onPaneScroll:W,onPaneContextMenu:q,paneClickDistance:Q,nodeClickDistance:K,onEdgeContextMenu:G,onEdgeMouseEnter:ne,onEdgeMouseMove:J,onEdgeMouseLeave:ae,reconnectRadius:ge,onReconnect:it,onReconnectStart:rr,onReconnectEnd:or,noDragClassName:Nt,noWheelClassName:sr,noPanClassName:St,disableKeyboardA11y:Ct,nodeExtent:ir,rfId:kt,viewport:It,onViewportChange:tn}){return ai(e),ai(t),mx(),ax(n),lx(It),p.jsx(Dy,{onPaneClick:U,onPaneMouseEnter:P,onPaneMouseMove:B,onPaneMouseLeave:z,onPaneContextMenu:q,onPaneScroll:W,paneClickDistance:Q,deleteKeyCode:R,selectionKeyCode:E,selectionOnDrag:m,selectionMode:w,onSelectionStart:u,onSelectionEnd:h,multiSelectionKeyCode:T,panActivationKeyCode:$,zoomActivationKeyCode:I,elementsSelectable:j,zoomOnScroll:C,zoomOnPinch:M,zoomOnDoubleClick:V,panOnScroll:S,panOnScrollSpeed:D,panOnScrollMode:F,panOnDrag:Y,defaultViewport:H,translateExtent:L,minZoom:O,maxZoom:y,onSelectionContextMenu:f,preventScrolling:k,noDragClassName:Nt,noWheelClassName:sr,noPanClassName:St,disableKeyboardA11y:Ct,onViewportChange:tn,isControlledViewport:!!It,children:p.jsxs(ix,{children:[p.jsx(ox,{edgeTypes:t,onEdgeClick:o,onEdgeDoubleClick:i,onReconnect:it,onReconnectStart:rr,onReconnectEnd:or,onlyRenderVisibleElements:A,onEdgeContextMenu:G,onEdgeMouseEnter:ne,onEdgeMouseMove:J,onEdgeMouseLeave:ae,reconnectRadius:ge,defaultMarkerColor:N,noPanClassName:St,disableKeyboardA11y:Ct,rfId:kt}),p.jsx(px,{style:x,type:g,component:b,containerStyle:_}),p.jsx("div",{className:"react-flow__edgelabel-renderer"}),p.jsx(zy,{nodeTypes:e,onNodeClick:r,onNodeDoubleClick:s,onNodeMouseEnter:a,onNodeMouseMove:c,onNodeMouseLeave:l,onNodeContextMenu:d,nodeClickDistance:K,onlyRenderVisibleElements:A,noPanClassName:St,noDragClassName:Nt,disableKeyboardA11y:Ct,nodeExtent:ir,rfId:kt}),p.jsx("div",{className:"react-flow__viewport-portal"})]})})}el.displayName="GraphView";const yx=v.memo(el),ci=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:o,height:s,fitView:i,nodeOrigin:a,nodeExtent:c}={})=>{const l=new Map,d=new Map,f=new Map,u=new Map,h=r??t??[],g=n??e??[],x=a??[0,0],b=c??Wt;pc(f,u,h),qr(g,l,d,{nodeOrigin:x,nodeExtent:b,elevateNodesOnSelect:!1});let _=[0,0,1];if(i&&o&&s){const E=Qt(l,{filter:$=>!!(($.width||$.initialWidth)&&($.height||$.initialHeight))}),{x:m,y:w,zoom:T}=No(E,o,s,.5,2,.1);_=[m,w,T]}return{rfId:"1",width:0,height:0,transform:_,nodes:g,nodeLookup:l,parentLookup:d,edges:h,edgeLookup:u,connectionLookup:f,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:n!==void 0,hasDefaultEdges:r!==void 0,panZoom:null,minZoom:.5,maxZoom:2,translateExtent:Wt,nodeExtent:b,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:xt.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:x,nodeDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!1,selectNodesOnDrag:!0,multiSelectionActive:!1,fitViewQueued:i??!1,fitViewOptions:void 0,fitViewResolver:null,connection:{...qa},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanSpeed:15,connectionRadius:20,onError:Wm,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1}},xx=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:o,height:s,fitView:i,nodeOrigin:a,nodeExtent:c})=>O0((l,d)=>{async function f(){const{nodeLookup:u,panZoom:h,fitViewOptions:g,fitViewResolver:x,width:b,height:_,minZoom:E,maxZoom:m}=d();h&&(await Bm({nodes:u,width:b,height:_,panZoom:h,minZoom:E,maxZoom:m},g),x==null||x.resolve(!0),l({fitViewResolver:null}))}return{...ci({nodes:e,edges:t,width:o,height:s,fitView:i,nodeOrigin:a,nodeExtent:c,defaultNodes:n,defaultEdges:r}),setNodes:u=>{const{nodeLookup:h,parentLookup:g,nodeOrigin:x,elevateNodesOnSelect:b,fitViewQueued:_}=d(),E=qr(u,h,g,{nodeOrigin:x,nodeExtent:c,elevateNodesOnSelect:b,checkEquality:!0});_&&E?(f(),l({nodes:u,fitViewQueued:!1,fitViewOptions:void 0})):l({nodes:u})},setEdges:u=>{const{connectionLookup:h,edgeLookup:g}=d();pc(h,g,u),l({edges:u})},setDefaultNodesAndEdges:(u,h)=>{if(u){const{setNodes:g}=d();g(u),l({hasDefaultNodes:!0})}if(h){const{setEdges:g}=d();g(h),l({hasDefaultEdges:!0})}},updateNodeInternals:u=>{const{triggerNodeChanges:h,nodeLookup:g,parentLookup:x,domNode:b,nodeOrigin:_,nodeExtent:E,debug:m,fitViewQueued:w}=d(),{changes:T,updatedInternals:$}=a0(u,g,x,b,_,E);$&&(o0(g,x,{nodeOrigin:_,nodeExtent:E}),w?(f(),l({fitViewQueued:!1,fitViewOptions:void 0})):l({}),(T==null?void 0:T.length)>0&&(m&&console.log("React Flow: trigger node changes",T),h==null||h(T)))},updateNodePositions:(u,h=!1)=>{const g=[],x=[],{nodeLookup:b,triggerNodeChanges:_}=d();for(const[E,m]of u){const w=b.get(E),T=!!(w!=null&&w.expandParent&&(w!=null&&w.parentId)&&(m!=null&&m.position)),$={id:E,type:"position",position:T?{x:Math.max(0,m.position.x),y:Math.max(0,m.position.y)}:m.position,dragging:h};T&&w.parentId&&g.push({id:E,parentId:w.parentId,rect:{...m.internals.positionAbsolute,width:m.measured.width??0,height:m.measured.height??0}}),x.push($)}if(g.length>0){const{parentLookup:E,nodeOrigin:m}=d(),w=To(g,b,E,m);x.push(...w)}_(x)},triggerNodeChanges:u=>{const{onNodesChange:h,setNodes:g,nodes:x,hasDefaultNodes:b,debug:_}=d();if(u!=null&&u.length){if(b){const E=Tc(u,x);g(E)}_&&console.log("React Flow: trigger node changes",u),h==null||h(u)}},triggerEdgeChanges:u=>{const{onEdgesChange:h,setEdges:g,edges:x,hasDefaultEdges:b,debug:_}=d();if(u!=null&&u.length){if(b){const E=Mc(u,x);g(E)}_&&console.log("React Flow: trigger edge changes",u),h==null||h(u)}},addSelectedNodes:u=>{const{multiSelectionActive:h,edgeLookup:g,nodeLookup:x,triggerNodeChanges:b,triggerEdgeChanges:_}=d();if(h){const E=u.map(m=>Xe(m,!0));b(E);return}b(dt(x,new Set([...u]),!0)),_(dt(g))},addSelectedEdges:u=>{const{multiSelectionActive:h,edgeLookup:g,nodeLookup:x,triggerNodeChanges:b,triggerEdgeChanges:_}=d();if(h){const E=u.map(m=>Xe(m,!0));_(E);return}_(dt(g,new Set([...u]))),b(dt(x,new Set,!0))},unselectNodesAndEdges:({nodes:u,edges:h}={})=>{const{edges:g,nodes:x,nodeLookup:b,triggerNodeChanges:_,triggerEdgeChanges:E}=d(),m=u||x,w=h||g,T=m.map(I=>{const R=b.get(I.id);return R&&(R.selected=!1),Xe(I.id,!1)}),$=w.map(I=>Xe(I.id,!1));_(T),E($)},setMinZoom:u=>{const{panZoom:h,maxZoom:g}=d();h==null||h.setScaleExtent([u,g]),l({minZoom:u})},setMaxZoom:u=>{const{panZoom:h,minZoom:g}=d();h==null||h.setScaleExtent([g,u]),l({maxZoom:u})},setTranslateExtent:u=>{var h;(h=d().panZoom)==null||h.setTranslateExtent(u),l({translateExtent:u})},setPaneClickDistance:u=>{var h;(h=d().panZoom)==null||h.setClickDistance(u)},resetSelectedElements:()=>{const{edges:u,nodes:h,triggerNodeChanges:g,triggerEdgeChanges:x}=d(),b=h.reduce((E,m)=>m.selected?[...E,Xe(m.id,!1)]:E,[]),_=u.reduce((E,m)=>m.selected?[...E,Xe(m.id,!1)]:E,[]);g(b),x(_)},setNodeExtent:u=>{const{nodes:h,nodeLookup:g,parentLookup:x,nodeOrigin:b,elevateNodesOnSelect:_,nodeExtent:E}=d();u[0][0]===E[0][0]&&u[0][1]===E[0][1]&&u[1][0]===E[1][0]&&u[1][1]===E[1][1]||(qr(h,g,x,{nodeOrigin:b,nodeExtent:u,elevateNodesOnSelect:_,checkEquality:!1}),l({nodeExtent:u}))},panBy:u=>{const{transform:h,width:g,height:x,panZoom:b,translateExtent:_}=d();return c0({delta:u,panZoom:b,transform:h,translateExtent:_,width:g,height:x})},cancelConnection:()=>{l({connection:{...qa}})},updateConnection:u=>{l({connection:u})},reset:()=>l({...ci()})}},Object.is);function wx({initialNodes:e,initialEdges:t,defaultNodes:n,defaultEdges:r,initialWidth:o,initialHeight:s,fitView:i,nodeOrigin:a,nodeExtent:c,children:l}){const[d]=v.useState(()=>xx({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:o,height:s,fitView:i,nodeOrigin:a,nodeExtent:c}));return p.jsx(L0,{value:d,children:p.jsx(ay,{children:l})})}function _x({children:e,nodes:t,edges:n,defaultNodes:r,defaultEdges:o,width:s,height:i,fitView:a,nodeOrigin:c,nodeExtent:l}){return v.useContext(Qn)?p.jsx(p.Fragment,{children:e}):p.jsx(wx,{initialNodes:t,initialEdges:n,defaultNodes:r,defaultEdges:o,initialWidth:s,initialHeight:i,fitView:a,nodeOrigin:c,nodeExtent:l,children:e})}const bx={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function vx({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,className:o,nodeTypes:s,edgeTypes:i,onNodeClick:a,onEdgeClick:c,onInit:l,onMove:d,onMoveStart:f,onMoveEnd:u,onConnect:h,onConnectStart:g,onConnectEnd:x,onClickConnectStart:b,onClickConnectEnd:_,onNodeMouseEnter:E,onNodeMouseMove:m,onNodeMouseLeave:w,onNodeContextMenu:T,onNodeDoubleClick:$,onNodeDragStart:I,onNodeDrag:R,onNodeDragStop:A,onNodesDelete:j,onEdgesDelete:H,onDelete:L,onSelectionChange:O,onSelectionDragStart:y,onSelectionDrag:k,onSelectionDragStop:N,onSelectionContextMenu:C,onSelectionStart:M,onSelectionEnd:S,onBeforeDelete:D,connectionMode:F,connectionLineType:V=Fe.Bezier,connectionLineStyle:Y,connectionLineComponent:U,connectionLineContainerStyle:P,deleteKeyCode:B="Backspace",selectionKeyCode:z="Shift",selectionOnDrag:W=!1,selectionMode:q=Yt.Full,panActivationKeyCode:Q="Space",multiSelectionKeyCode:K=On()?"Meta":"Control",zoomActivationKeyCode:G=On()?"Meta":"Control",snapToGrid:ne,snapGrid:J,onlyRenderVisibleElements:ae=!1,selectNodesOnDrag:ge,nodesDraggable:it,nodesConnectable:rr,nodesFocusable:or,nodeOrigin:Nt=kc,edgesFocusable:sr,edgesReconnectable:St,elementsSelectable:Ct=!0,defaultViewport:ir=Z0,minZoom:kt=.5,maxZoom:It=2,translateExtent:tn=Wt,preventScrolling:il=!0,nodeExtent:ar,defaultMarkerColor:al="#b1b1b7",zoomOnScroll:cl=!0,zoomOnPinch:ll=!0,panOnScroll:ul=!1,panOnScrollSpeed:dl=.5,panOnScrollMode:fl=Je.Free,zoomOnDoubleClick:hl=!0,panOnDrag:pl=!0,onPaneClick:gl,onPaneMouseEnter:ml,onPaneMouseMove:yl,onPaneMouseLeave:xl,onPaneScroll:wl,onPaneContextMenu:_l,paneClickDistance:Ao=0,nodeClickDistance:bl=0,children:vl,onReconnect:El,onReconnectStart:Nl,onReconnectEnd:Sl,onEdgeContextMenu:Cl,onEdgeDoubleClick:kl,onEdgeMouseEnter:Il,onEdgeMouseMove:Tl,onEdgeMouseLeave:Ml,reconnectRadius:$l=10,onNodesChange:Al,onEdgesChange:Dl,noDragClassName:jl="nodrag",noWheelClassName:Rl="nowheel",noPanClassName:Do="nopan",fitView:jo,fitViewOptions:Pl,connectOnClick:Ol,attributionPosition:Ll,proOptions:Hl,defaultEdgeOptions:Fl,elevateNodesOnSelect:zl,elevateEdgesOnSelect:Bl,disableKeyboardA11y:Ro=!1,autoPanOnConnect:Vl,autoPanOnNodeDrag:Wl,autoPanSpeed:Yl,connectionRadius:Ul,isValidConnection:Xl,onError:Gl,style:ql,id:Po,nodeDragThreshold:Kl,viewport:Zl,onViewportChange:Jl,width:Ql,height:eu,colorMode:tu="light",debug:nu,onScroll:nn,...ru},ou){const cr=Po||"1",su=ty(tu),iu=v.useCallback(Oo=>{Oo.currentTarget.scrollTo({top:0,left:0,behavior:"instant"}),nn==null||nn(Oo)},[nn]);return p.jsx("div",{"data-testid":"rf__wrapper",...ru,onScroll:iu,style:{...ql,...bx},ref:ou,className:se(["react-flow",o,su]),id:Po,children:p.jsxs(_x,{nodes:e,edges:t,width:Ql,height:eu,fitView:jo,nodeOrigin:Nt,nodeExtent:ar,children:[p.jsx(yx,{onInit:l,onNodeClick:a,onEdgeClick:c,onNodeMouseEnter:E,onNodeMouseMove:m,onNodeMouseLeave:w,onNodeContextMenu:T,onNodeDoubleClick:$,nodeTypes:s,edgeTypes:i,connectionLineType:V,connectionLineStyle:Y,connectionLineComponent:U,connectionLineContainerStyle:P,selectionKeyCode:z,selectionOnDrag:W,selectionMode:q,deleteKeyCode:B,multiSelectionKeyCode:K,panActivationKeyCode:Q,zoomActivationKeyCode:G,onlyRenderVisibleElements:ae,defaultViewport:ir,translateExtent:tn,minZoom:kt,maxZoom:It,preventScrolling:il,zoomOnScroll:cl,zoomOnPinch:ll,zoomOnDoubleClick:hl,panOnScroll:ul,panOnScrollSpeed:dl,panOnScrollMode:fl,panOnDrag:pl,onPaneClick:gl,onPaneMouseEnter:ml,onPaneMouseMove:yl,onPaneMouseLeave:xl,onPaneScroll:wl,onPaneContextMenu:_l,paneClickDistance:Ao,nodeClickDistance:bl,onSelectionContextMenu:C,onSelectionStart:M,onSelectionEnd:S,onReconnect:El,onReconnectStart:Nl,onReconnectEnd:Sl,onEdgeContextMenu:Cl,onEdgeDoubleClick:kl,onEdgeMouseEnter:Il,onEdgeMouseMove:Tl,onEdgeMouseLeave:Ml,reconnectRadius:$l,defaultMarkerColor:al,noDragClassName:jl,noWheelClassName:Rl,noPanClassName:Do,rfId:cr,disableKeyboardA11y:Ro,nodeExtent:ar,viewport:Zl,onViewportChange:Jl}),p.jsx(ey,{nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:h,onConnectStart:g,onConnectEnd:x,onClickConnectStart:b,onClickConnectEnd:_,nodesDraggable:it,nodesConnectable:rr,nodesFocusable:or,edgesFocusable:sr,edgesReconnectable:St,elementsSelectable:Ct,elevateNodesOnSelect:zl,elevateEdgesOnSelect:Bl,minZoom:kt,maxZoom:It,nodeExtent:ar,onNodesChange:Al,onEdgesChange:Dl,snapToGrid:ne,snapGrid:J,connectionMode:F,translateExtent:tn,connectOnClick:Ol,defaultEdgeOptions:Fl,fitView:jo,fitViewOptions:Pl,onNodesDelete:j,onEdgesDelete:H,onDelete:L,onNodeDragStart:I,onNodeDrag:R,onNodeDragStop:A,onSelectionDrag:k,onSelectionDragStart:y,onSelectionDragStop:N,onMove:d,onMoveStart:f,onMoveEnd:u,noPanClassName:Do,nodeOrigin:Nt,rfId:cr,autoPanOnConnect:Vl,autoPanOnNodeDrag:Wl,autoPanSpeed:Yl,onError:Gl,connectionRadius:Ul,isValidConnection:Xl,selectNodesOnDrag:ge,nodeDragThreshold:Kl,onBeforeDelete:D,paneClickDistance:Ao,debug:nu}),p.jsx(K0,{onSelectionChange:O}),vl,p.jsx(Y0,{proOptions:Hl,position:Ll}),p.jsx(V0,{rfId:cr,disableKeyboardA11y:Ro})]})})}var Ex=$c(vx);function Nx(e){const[t,n]=v.useState(e),r=v.useCallback(o=>n(s=>Tc(o,s)),[]);return[t,n,r]}function Sx(e){const[t,n]=v.useState(e),r=v.useCallback(o=>n(s=>Mc(o,s)),[]);return[t,n,r]}function Cx({dimensions:e,lineWidth:t,variant:n,className:r}){return p.jsx("path",{strokeWidth:t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`,className:se(["react-flow__background-pattern",n,r])})}function kx({radius:e,className:t}){return p.jsx("circle",{cx:e,cy:e,r:e,className:se(["react-flow__background-pattern","dots",t])})}var ze;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(ze||(ze={}));const Ix={[ze.Dots]:1,[ze.Lines]:1,[ze.Cross]:6},Tx=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function tl({id:e,variant:t=ze.Dots,gap:n=20,size:r,lineWidth:o=1,offset:s=0,color:i,bgColor:a,style:c,className:l,patternClassName:d}){const f=v.useRef(null),{transform:u,patternId:h}=Z(Tx,oe),g=r||Ix[t],x=t===ze.Dots,b=t===ze.Cross,_=Array.isArray(n)?n:[n,n],E=[_[0]*u[2]||1,_[1]*u[2]||1],m=g*u[2],w=Array.isArray(s)?s:[s,s],T=b?[m,m]:E,$=[w[0]*u[2]||1+T[0]/2,w[1]*u[2]||1+T[1]/2],I=`${h}${e||""}`;return p.jsxs("svg",{className:se(["react-flow__background",l]),style:{...c,...tr,"--xy-background-color-props":a,"--xy-background-pattern-color-props":i},ref:f,"data-testid":"rf__background",children:[p.jsx("pattern",{id:I,x:u[0]%E[0],y:u[1]%E[1],width:E[0],height:E[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${$[0]},-${$[1]})`,children:x?p.jsx(kx,{radius:m/2,className:d}):p.jsx(Cx,{dimensions:T,lineWidth:o,variant:t,className:d})}),p.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${I})`})]})}tl.displayName="Background";const Mx=v.memo(tl);function $x(){return p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:p.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function Ax(){return p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:p.jsx("path",{d:"M0 0h32v4.2H0z"})})}function Dx(){return p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:p.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function jx(){return p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:p.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function Rx(){return p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:p.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function xn({children:e,className:t,...n}){return p.jsx("button",{type:"button",className:se(["react-flow__controls-button",t]),...n,children:e})}const Px=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom});function nl({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:r=!0,fitViewOptions:o,onZoomIn:s,onZoomOut:i,onFitView:a,onInteractiveChange:c,className:l,children:d,position:f="bottom-left",orientation:u="vertical","aria-label":h="React Flow controls"}){const g=re(),{isInteractive:x,minZoomReached:b,maxZoomReached:_}=Z(Px,oe),{zoomIn:E,zoomOut:m,fitView:w}=Mo(),T=()=>{E(),s==null||s()},$=()=>{m(),i==null||i()},I=()=>{w(o),a==null||a()},R=()=>{g.setState({nodesDraggable:!x,nodesConnectable:!x,elementsSelectable:!x}),c==null||c(!x)},A=u==="horizontal"?"horizontal":"vertical";return p.jsxs(er,{className:se(["react-flow__controls",A,l]),position:f,style:e,"data-testid":"rf__controls","aria-label":h,children:[t&&p.jsxs(p.Fragment,{children:[p.jsx(xn,{onClick:T,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:_,children:p.jsx($x,{})}),p.jsx(xn,{onClick:$,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:b,children:p.jsx(Ax,{})})]}),n&&p.jsx(xn,{className:"react-flow__controls-fitview",onClick:I,title:"fit view","aria-label":"fit view",children:p.jsx(Dx,{})}),r&&p.jsx(xn,{className:"react-flow__controls-interactive",onClick:R,title:"toggle interactivity","aria-label":"toggle interactivity",children:x?p.jsx(Rx,{}):p.jsx(jx,{})}),d]})}nl.displayName="Controls";const Ox=v.memo(nl);function Lx({id:e,x:t,y:n,width:r,height:o,style:s,color:i,strokeColor:a,strokeWidth:c,className:l,borderRadius:d,shapeRendering:f,selected:u,onClick:h}){const{background:g,backgroundColor:x}=s||{},b=i||g||x;return p.jsx("rect",{className:se(["react-flow__minimap-node",{selected:u},l]),x:t,y:n,rx:d,ry:d,width:r,height:o,style:{fill:b,stroke:a,strokeWidth:c},shapeRendering:f,onClick:h?_=>h(_,e):void 0})}const Hx=v.memo(Lx),Fx=e=>e.nodes.map(t=>t.id),_r=e=>e instanceof Function?e:()=>e;function zx({nodeStrokeColor:e,nodeColor:t,nodeClassName:n="",nodeBorderRadius:r=5,nodeStrokeWidth:o,nodeComponent:s=Hx,onClick:i}){const a=Z(Fx,oe),c=_r(t),l=_r(e),d=_r(n),f=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return p.jsx(p.Fragment,{children:a.map(u=>p.jsx(Vx,{id:u,nodeColorFunc:c,nodeStrokeColorFunc:l,nodeClassNameFunc:d,nodeBorderRadius:r,nodeStrokeWidth:o,NodeComponent:s,onClick:i,shapeRendering:f},u))})}function Bx({id:e,nodeColorFunc:t,nodeStrokeColorFunc:n,nodeClassNameFunc:r,nodeBorderRadius:o,nodeStrokeWidth:s,shapeRendering:i,NodeComponent:a,onClick:c}){const{node:l,x:d,y:f,width:u,height:h}=Z(g=>{const x=g.nodeLookup.get(e),{x:b,y:_}=x.internals.positionAbsolute,{width:E,height:m}=je(x);return{node:x,x:b,y:_,width:E,height:m}},oe);return!l||l.hidden||!rc(l)?null:p.jsx(a,{x:d,y:f,width:u,height:h,style:l.style,selected:!!l.selected,className:r(l),color:t(l),borderRadius:o,strokeColor:n(l),strokeWidth:s,shapeRendering:i,onClick:c,id:l.id})}const Vx=v.memo(Bx);var Wx=v.memo(zx);const Yx=200,Ux=150,Xx=e=>!e.hidden,Gx=e=>{const t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?nc(Qt(e.nodeLookup,{filter:Xx}),t):t,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height}},qx="react-flow__minimap-desc";function rl({style:e,className:t,nodeStrokeColor:n,nodeColor:r,nodeClassName:o="",nodeBorderRadius:s=5,nodeStrokeWidth:i,nodeComponent:a,bgColor:c,maskColor:l,maskStrokeColor:d,maskStrokeWidth:f,position:u="bottom-right",onClick:h,onNodeClick:g,pannable:x=!1,zoomable:b=!1,ariaLabel:_="React Flow mini map",inversePan:E,zoomStep:m=10,offsetScale:w=5}){const T=re(),$=v.useRef(null),{boundingRect:I,viewBB:R,rfId:A,panZoom:j,translateExtent:H,flowWidth:L,flowHeight:O}=Z(Gx,oe),y=(e==null?void 0:e.width)??Yx,k=(e==null?void 0:e.height)??Ux,N=I.width/y,C=I.height/k,M=Math.max(N,C),S=M*y,D=M*k,F=w*M,V=I.x-(S-I.width)/2-F,Y=I.y-(D-I.height)/2-F,U=S+F*2,P=D+F*2,B=`${qx}-${A}`,z=v.useRef(0),W=v.useRef();z.current=M,v.useEffect(()=>{if($.current&&j)return W.current=m0({domNode:$.current,panZoom:j,getTransform:()=>T.getState().transform,getViewScale:()=>z.current}),()=>{var K;(K=W.current)==null||K.destroy()}},[j]),v.useEffect(()=>{var K;(K=W.current)==null||K.update({translateExtent:H,width:L,height:O,inversePan:E,pannable:x,zoomStep:m,zoomable:b})},[x,b,E,m,H,L,O]);const q=h?K=>{var J;const[G,ne]=((J=W.current)==null?void 0:J.pointer(K))||[0,0];h(K,{x:G,y:ne})}:void 0,Q=g?v.useCallback((K,G)=>{const ne=T.getState().nodeLookup.get(G);g(K,ne)},[]):void 0;return p.jsx(er,{position:u,style:{...e,"--xy-minimap-background-color-props":typeof c=="string"?c:void 0,"--xy-minimap-mask-background-color-props":typeof l=="string"?l:void 0,"--xy-minimap-mask-stroke-color-props":typeof d=="string"?d:void 0,"--xy-minimap-mask-stroke-width-props":typeof f=="number"?f*M:void 0,"--xy-minimap-node-background-color-props":typeof r=="string"?r:void 0,"--xy-minimap-node-stroke-color-props":typeof n=="string"?n:void 0,"--xy-minimap-node-stroke-width-props":typeof i=="string"?i:void 0},className:se(["react-flow__minimap",t]),"data-testid":"rf__minimap",children:p.jsxs("svg",{width:y,height:k,viewBox:`${V} ${Y} ${U} ${P}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":B,ref:$,onClick:q,children:[_&&p.jsx("title",{id:B,children:_}),p.jsx(Wx,{onClick:Q,nodeColor:r,nodeStrokeColor:n,nodeBorderRadius:s,nodeClassName:o,nodeStrokeWidth:i,nodeComponent:a}),p.jsx("path",{className:"react-flow__minimap-mask",d:`M${V-F},${Y-F}h${U+F*2}v${P+F*2}h${-U-F*2}z
        M${R.x},${R.y}h${R.width}v${R.height}h${-R.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}rl.displayName="MiniMap";v.memo(rl);function Kx({nodeId:e,position:t,variant:n=Lt.Handle,className:r,style:o={},children:s,color:i,minWidth:a=10,minHeight:c=10,maxWidth:l=Number.MAX_VALUE,maxHeight:d=Number.MAX_VALUE,keepAspectRatio:f=!1,shouldResize:u,onResizeStart:h,onResize:g,onResizeEnd:x}){const b=Rc(),_=typeof e=="string"?e:b,E=re(),m=v.useRef(null),w=n===Lt.Line?"right":"bottom-right",T=t??w,$=v.useRef(null);v.useEffect(()=>{if(!(!m.current||!_))return $.current||($.current=$0({domNode:m.current,nodeId:_,getStoreItems:()=>{const{nodeLookup:j,transform:H,snapGrid:L,snapToGrid:O,nodeOrigin:y,domNode:k}=E.getState();return{nodeLookup:j,transform:H,snapGrid:L,snapToGrid:O,nodeOrigin:y,paneDomNode:k}},onChange:(j,H)=>{const{triggerNodeChanges:L,nodeLookup:O,parentLookup:y,nodeOrigin:k}=E.getState(),N=[],C={x:j.x,y:j.y},M=O.get(_);if(M&&M.expandParent&&M.parentId){const S=M.origin??k,D=j.width??M.measured.width??0,F=j.height??M.measured.height??0,V={id:M.id,parentId:M.parentId,rect:{width:D,height:F,...oc({x:j.x??M.position.x,y:j.y??M.position.y},{width:D,height:F},M.parentId,O,S)}},Y=To([V],O,y,k);N.push(...Y),C.x=j.x?Math.max(S[0]*D,j.x):void 0,C.y=j.y?Math.max(S[1]*F,j.y):void 0}if(C.x!==void 0&&C.y!==void 0){const S={id:_,type:"position",position:{...C}};N.push(S)}if(j.width!==void 0&&j.height!==void 0){const S={id:_,type:"dimensions",resizing:!0,setAttributes:!0,dimensions:{width:j.width,height:j.height}};N.push(S)}for(const S of H){const D={...S,type:"position"};N.push(D)}L(N)},onEnd:()=>{const j={id:_,type:"dimensions",resizing:!1};E.getState().triggerNodeChanges([j])}})),$.current.update({controlPosition:T,boundaries:{minWidth:a,minHeight:c,maxWidth:l,maxHeight:d},keepAspectRatio:f,onResizeStart:h,onResize:g,onResizeEnd:x,shouldResize:u}),()=>{var j;(j=$.current)==null||j.destroy()}},[T,a,c,l,d,f,h,g,x,u]);const I=T.split("-"),R=n===Lt.Line?"borderColor":"backgroundColor",A=i?{...o,[R]:i}:o;return p.jsx("div",{className:se(["react-flow__resize-control","nodrag",...I,n,r]),ref:m,style:A,children:s})}v.memo(Kx);const At={x:250,y:120},Zx=[{id:"start",type:"input",position:{x:100,y:100},data:{label:"Start"},style:{background:"#f7f7f7",border:"1px solid #ddd",borderRadius:"8px",padding:"10px",width:150}},{id:"application-1",type:"application",position:{x:100+At.x,y:100},data:{label:"CRM API",description:"Customer data source",icon:"database"}},{id:"tool-1",type:"tool",position:{x:100+At.x*2,y:100},data:{label:"Data Processor",description:"Transforms customer data",icon:"tool"}},{id:"agent-1",type:"agent",position:{x:100+At.x*2,y:100+At.y},data:{label:"AI Assistant",description:"Analyzes customer data",icon:"brain"}},{id:"end",type:"output",position:{x:100+At.x*3,y:100},data:{label:"End"},style:{background:"#f7f7f7",border:"1px solid #ddd",borderRadius:"8px",padding:"10px",width:150}}],Jx=[{id:"e-start-app1",source:"start",target:"application-1",animated:!0,style:{stroke:"#555",strokeWidth:2}},{id:"e-app1-tool1",source:"application-1",target:"tool-1",animated:!0,style:{stroke:"#555",strokeWidth:2}},{id:"e-tool1-agent1",source:"tool-1",target:"agent-1",animated:!0,style:{stroke:"#555",strokeWidth:2}},{id:"e-agent1-end",source:"agent-1",target:"end",animated:!0,style:{stroke:"#555",strokeWidth:2}}];function Qx({isOpen:e,setIsOpen:t,nodeId:n,nodeName:r,initialNote:o,onSave:s}){const[i,a]=br.useState(o);br.useEffect(()=>{e&&a(o)},[e,o]);const c=()=>{n&&(s(n,i),t(!1))};return p.jsx(li,{open:e,onOpenChange:t,children:p.jsxs(ui,{className:"sm:max-w-[500px]",children:[p.jsxs(di,{children:[p.jsxs(fi,{children:["Node Note: ",r]}),p.jsx(hi,{children:"Add a descriptive note to explain what this node does in your workflow."})]}),p.jsx("div",{className:"grid gap-4 py-4",children:p.jsxs("div",{className:"grid gap-2",children:[p.jsx(ct,{htmlFor:"note",children:"Note"}),p.jsx(vr,{id:"note",value:i,onChange:l=>a(l.target.value),placeholder:"Describe what this node does...",className:"min-h-[150px]"})]})}),p.jsxs(pi,{children:[p.jsx(ce,{type:"button",variant:"outline",onClick:()=>t(!1),children:"Cancel"}),p.jsx(ce,{type:"button",onClick:c,children:"Save"})]})]})})}function ew(){const[e,t,n]=Nx(Zx),[r,o,s]=Sx(Jx),[i,a]=v.useState(null),[c,l]=v.useState(null),[d,f]=v.useState({x:0,y:0}),[u,h]=v.useState(!1),[g,x]=v.useState(!1),[b,_]=v.useState(!1),[E,m]=v.useState(null),w=v.useRef(null),T=v.useCallback(P=>o(B=>dc({...P,animated:!0,style:{stroke:"#555",strokeWidth:2}},B)),[o]),$=v.useCallback((P,B)=>{l(B),x(!0)},[]),I=v.useCallback(()=>{l(null),x(!1)},[]),R=v.useCallback(P=>{P.preventDefault(),P.dataTransfer.dropEffect="move"},[]),A=v.useCallback((P,B)=>{if(P.preventDefault(),!B.current||!i)return;const z=B.current.getBoundingClientRect(),W=P.dataTransfer.getData("application/reactflow/type"),q=P.dataTransfer.getData("application/reactflow/label");if(!W||typeof W!="string")return;const Q=i.screenToFlowPosition({x:P.clientX-z.left,y:P.clientY-z.top}),K={id:`${W}-${Date.now()}`,type:W,position:Q,data:{label:q||`${W.charAt(0).toUpperCase()+W.slice(1)}`,onDelete:H,onClone:L,onSettings:O,onAddNote:y,onEditNote:k}};t(G=>G.concat(K))},[i,t]),j=v.useCallback(P=>{if(!w.current||!i)return;const B=w.current.getBoundingClientRect(),z=i.screenToFlowPosition({x:P.clientX-B.left,y:P.clientY-B.top});f(z),h(!0)},[i]),H=v.useCallback(P=>{t(B=>B.filter(z=>z.id!==P)),c&&c.id===P&&(l(null),x(!1)),ye.success("Node deleted")},[c,t]),L=v.useCallback(P=>{if(!P||!P.position)return;const B={x:P.position.x+50,y:P.position.y+50},z={...P,id:`${P.type}-${Date.now()}`,position:B,data:{...P.data,onDelete:H,onClone:L,onSettings:O,onAddNote:y,onEditNote:k}};t(W=>[...W,z]),ye.success("Node cloned")},[t]),O=v.useCallback(P=>{l(P),x(!0)},[]),y=v.useCallback(P=>{m(P.id),_(!0)},[]),k=v.useCallback(P=>{m(P),_(!0)},[]),N=v.useCallback((P,B)=>{t(z=>z.map(W=>W.id===P?{...W,data:{...W.data,note:B.trim()===""?void 0:B}}:W)),B.trim()===""?ye.success("Note removed"):ye.success("Note saved")},[t]),C=v.useCallback((P,B)=>{t(z=>z.map(W=>W.id===P.id?{...W,data:{...W.data,...B}}:W))},[t]),M=v.useCallback(()=>{x(!1)},[]),S=v.useCallback(()=>{if(!E)return{note:"",nodeName:""};const P=e.find(B=>B.id===E);return P?{note:typeof P.data.note=="string"?P.data.note:"",nodeName:typeof P.data.label=="string"?P.data.label:"Node"}:{note:"",nodeName:""}},[e,E]),D=v.useCallback((P,B)=>{if(!i)return;const z=i.screenToFlowPosition({x:window.innerWidth/2,y:window.innerHeight/2}),W={id:`${P}-${Date.now()}`,type:P,position:z,data:{label:B,onDelete:H,onClone:L,onSettings:O,onAddNote:y,onEditNote:k}};t(q=>q.concat(W))},[i,t,H,L,O,y,k]),F=v.useCallback((P,B)=>{const z={id:`${P}-${Date.now()}`,type:P,position:d,data:{label:B,onDelete:H,onClone:L,onSettings:O,onAddNote:y,onEditNote:k}};t(W=>W.concat(z)),h(!1)},[d,t,H,L,O,y,k]),V=v.useCallback(P=>P.trim()?!0:(ye.error("Please enter a workflow name"),!1),[]),Y=S(),U=p.jsx(Qx,{isOpen:b,setIsOpen:_,nodeId:E||"",nodeName:Y.nodeName,initialNote:Y.note,onSave:N});return{nodes:e,edges:r,onNodesChange:n,onEdgesChange:s,onConnect:T,onNodeClick:$,onPaneClick:I,onDragOver:R,onDrop:A,onAddNode:j,selectedNode:c,setSelectedNode:l,deleteNode:H,cloneNode:L,selectNodeForEditing:O,reactFlowInstance:i,setReactFlowInstance:a,isNodePickerOpen:u,setIsNodePickerOpen:h,nodePickerPosition:d,handleNodeAdd:F,handleAddNodeFromToolbar:D,saveWorkflow:V,reactFlowWrapper:w,setNodes:t,isNoteDialogOpen:b,setIsNoteDialogOpen:_,noteNodeId:E,openNoteDialog:y,openEditNoteDialog:k,saveNodeNote:N,noteDialogElement:U,isConfigPanelOpen:g,closeConfigPanel:M,saveNodeConfig:C}}const tw=[{type:"application",label:"Application",icon:Jr,description:"External API or service",color:"bg-yellow-100 border-yellow-300 hover:bg-yellow-200"},{type:"tool",label:"Tool",icon:Qr,description:"Process or transform data",color:"bg-blue-100 border-blue-300 hover:bg-blue-200"},{type:"agent",label:"Agent",icon:eo,description:"AI-powered assistant",color:"bg-pink-100 border-pink-300 hover:bg-pink-200"},{type:"task",label:"Task",icon:so,description:"Specific action to perform",color:"bg-green-100 border-green-300 hover:bg-green-200"},{type:"memory",label:"Memory",icon:to,description:"Store context information",color:"bg-purple-100 border-purple-300 hover:bg-purple-200"},{type:"reasoning",label:"Reasoning",icon:oo,description:"Decision-making logic",color:"bg-teal-100 border-teal-300 hover:bg-teal-200"},{type:"input",label:"Input",icon:no,description:"Starting point for data flow",color:"bg-gray-100 border-gray-300 hover:bg-gray-200"},{type:"output",label:"Output",icon:ro,description:"Final result or endpoint",color:"bg-gray-100 border-gray-300 hover:bg-gray-200"}];function nw({isOpen:e,setIsOpen:t,position:n,onSelect:r}){const o=v.useRef(null);v.useEffect(()=>{const i=a=>{o.current&&!o.current.contains(a.target)&&t(!1)};return document.addEventListener("mousedown",i),()=>{document.removeEventListener("mousedown",i)}},[t]);const s=(i,a)=>{r(i,a)};return p.jsxs("div",{ref:o,className:"absolute z-10 bg-white rounded-md shadow-lg border p-2 w-72",style:{left:`${n.x}px`,top:`${n.y}px`,transform:"translate(-50%, -50%)"},children:[p.jsx("div",{className:"text-sm font-medium p-2 border-b mb-2",children:"Add Node"}),p.jsx("div",{className:"grid grid-cols-2 gap-2 max-h-80 overflow-y-auto p-1",children:tw.map(i=>p.jsxs("div",{className:`cursor-pointer rounded-md border p-2 transition-colors ${i.color}`,onClick:()=>s(i.type,i.label),draggable:!0,onDragStart:a=>{a.dataTransfer.setData("application/reactflow/type",i.type),a.dataTransfer.setData("application/reactflow/label",i.label),a.dataTransfer.effectAllowed="move"},children:[p.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[p.jsx(i.icon,{className:"h-4 w-4"}),p.jsx("span",{className:"font-medium",children:i.label})]}),p.jsx("p",{className:"text-xs text-muted-foreground",children:i.description})]},i.type))})]})}function rw({workflowName:e,setWorkflowName:t,onBack:n,workflowId:r}){return p.jsxs("div",{className:"flex items-center gap-4",children:[p.jsx(ce,{variant:"ghost",onClick:n,className:"h-8 w-8 p-0",children:p.jsx(mu,{className:"h-4 w-4"})}),p.jsxs("div",{children:[p.jsx(Er,{value:e,onChange:o=>t(o.target.value),className:"font-medium text-lg border-none focus-visible:ring-0 focus-visible:ring-offset-0 h-8 p-0"}),r&&p.jsxs("p",{className:"text-muted-foreground text-sm",children:["Workflow: ",r]})]})]})}function ow({onViewCode:e,onRun:t,onSave:n,onSettings:r,isSaving:o,isRunning:s,isDeploying:i,onDeploy:a}){return p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsxs(ce,{size:"sm",variant:"outline",children:[p.jsx(gi,{className:"mr-1 h-3 w-3"})," View Code"]}),p.jsxs(ce,{variant:"outline",className:"gap-1 h-8",onClick:t,disabled:s,children:[s?p.jsx("span",{className:"h-3 w-3 animate-spin",children:""}):p.jsx(Tu,{className:"h-3 w-3"}),"Run"]}),p.jsxs(ce,{variant:"outline",className:"gap-1 h-8",onClick:a,disabled:i,children:[i?p.jsx("span",{className:"h-3 w-3 animate-spin",children:""}):p.jsx(Iu,{className:"h-3 w-3"}),"Deploy"]}),p.jsxs(ce,{className:"gap-1 h-8",onClick:n,disabled:o,children:[o?p.jsx("span",{className:"h-3 w-3 animate-spin",children:""}):p.jsx(yu,{className:"h-3 w-3"}),"Save"]}),p.jsx(ce,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:r,children:p.jsx(mi,{className:"h-4 w-4"})})]})}function sw({type:e,label:t,icon:n,color:r,onClick:o}){return p.jsxs(ce,{variant:"outline",className:`flex items-center gap-1 h-8 ${r} border`,onClick:()=>o(e,t),children:[p.jsx(n,{className:"h-3 w-3"}),p.jsx("span",{className:"text-xs font-medium",children:t})]})}function iw({onAddNode:e}){const t=[{type:"application",label:"Application",icon:Jr,color:"bg-yellow-100 hover:bg-yellow-200 border-yellow-300"},{type:"tool",label:"Tool",icon:Qr,color:"bg-blue-100 hover:bg-blue-200 border-blue-300"},{type:"agent",label:"Agent",icon:eo,color:"bg-pink-100 hover:bg-pink-200 border-pink-300"},{type:"task",label:"Task",icon:so,color:"bg-green-100 hover:bg-green-200 border-green-300"},{type:"memory",label:"Memory",icon:to,color:"bg-purple-100 hover:bg-purple-200 border-purple-300"},{type:"reasoning",label:"Reasoning",icon:oo,color:"bg-teal-100 hover:bg-teal-200 border-teal-300"},{type:"input",label:"Input",icon:no,color:"bg-gray-100 hover:bg-gray-200 border-gray-300"},{type:"output",label:"Output",icon:ro,color:"bg-gray-100 hover:bg-gray-200 border-gray-300"}];return p.jsx("div",{className:"p-4 border-t bg-gray-50 flex flex-wrap gap-2 overflow-x-auto",children:t.map(n=>p.jsx(sw,{type:n.type,label:n.label,icon:n.icon,color:n.color,onClick:e},n.type))})}function aw({workflowName:e,setWorkflowName:t,onViewCode:n,onSave:r,onRun:o,onSettings:s,onBack:i,workflowId:a,isSaving:c,isRunning:l,isDeploying:d,onDeploy:f,onAddNode:u}){const[h,g]=v.useState(!0);return p.jsxs(hu,{open:h,onOpenChange:g,className:"border-b bg-white transition-all",children:[p.jsxs("div",{className:"p-4 flex justify-between items-center",children:[p.jsx(rw,{workflowName:e,setWorkflowName:t,onBack:i,workflowId:a}),p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(ow,{onViewCode:n,onRun:o,onSave:r,onSettings:s,isSaving:c,isRunning:l,isDeploying:!1,onDeploy:()=>{}}),p.jsx(pu,{asChild:!0,children:p.jsx(ce,{variant:"ghost",size:"icon",className:"h-8 w-8",children:h?p.jsx(xu,{className:"h-4 w-4"}):p.jsx(wu,{className:"h-4 w-4"})})})]})]}),p.jsx(gu,{children:p.jsx(iw,{onAddNode:u})})]})}function cw({isOpen:e,setIsOpen:t,workflowName:n,setWorkflowName:r,workflowDescription:o,setWorkflowDescription:s}){return p.jsx(li,{open:e,onOpenChange:t,children:p.jsxs(ui,{className:"sm:max-w-md",children:[p.jsxs(di,{children:[p.jsx(fi,{children:"Workflow Settings"}),p.jsx(hi,{children:"Configure the settings for your workflow."})]}),p.jsxs("div",{className:"space-y-4 py-2",children:[p.jsxs("div",{className:"space-y-2",children:[p.jsx("label",{htmlFor:"name",className:"text-sm font-medium",children:"Workflow Name"}),p.jsx("input",{id:"name",value:n,onChange:i=>r(i.target.value),className:"w-full p-2 border rounded"})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx("label",{htmlFor:"description",className:"text-sm font-medium",children:"Description"}),p.jsx("textarea",{id:"description",value:o,onChange:i=>s(i.target.value),rows:3,className:"w-full p-2 border rounded"})]}),p.jsxs("div",{children:[p.jsx("h3",{className:"text-sm font-medium mb-2",children:"Export Options"}),p.jsxs("div",{className:"flex gap-2",children:[p.jsxs(ce,{variant:"outline",size:"sm",className:"flex-1",children:[p.jsx(_u,{className:"mr-1 h-3 w-3"})," Export JSON"]}),p.jsxs(ce,{variant:"outline",size:"sm",className:"flex-1",children:[p.jsx(gi,{className:"mr-1 h-3 w-3"})," Export Code"]})]})]})]}),p.jsxs(pi,{className:"justify-between sm:justify-between",children:[p.jsxs(ce,{type:"button",variant:"destructive",size:"sm",children:[p.jsx(yi,{className:"mr-1 h-3 w-3"})," Delete Workflow"]}),p.jsx(ce,{type:"button",onClick:()=>t(!1),children:"Close"})]})]})})}const lw=vu,uw=Eu,dw=v.forwardRef(({className:e,inset:t,children:n,...r},o)=>p.jsxs(bi,{ref:o,className:Ve("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground",t&&"pl-8",e),...r,children:[n,p.jsx(Su,{className:"ml-auto h-4 w-4"})]}));dw.displayName=bi.displayName;const fw=v.forwardRef(({className:e,...t},n)=>p.jsx(vi,{ref:n,className:Ve("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));fw.displayName=vi.displayName;const ol=v.forwardRef(({className:e,...t},n)=>p.jsx(Nu,{children:p.jsx(xi,{ref:n,className:Ve("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t})}));ol.displayName=xi.displayName;const Pt=v.forwardRef(({className:e,inset:t,...n},r)=>p.jsx(wi,{ref:r,className:Ve("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t&&"pl-8",e),...n}));Pt.displayName=wi.displayName;const hw=v.forwardRef(({className:e,children:t,checked:n,...r},o)=>p.jsxs(Ei,{ref:o,className:Ve("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:n,...r,children:[p.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:p.jsx(Ni,{children:p.jsx(Cu,{className:"h-4 w-4"})})}),t]}));hw.displayName=Ei.displayName;const pw=v.forwardRef(({className:e,children:t,...n},r)=>p.jsxs(Si,{ref:r,className:Ve("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...n,children:[p.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:p.jsx(Ni,{children:p.jsx(ku,{className:"h-2 w-2 fill-current"})})}),t]}));pw.displayName=Si.displayName;const gw=v.forwardRef(({className:e,inset:t,...n},r)=>p.jsx(Ci,{ref:r,className:Ve("px-2 py-1.5 text-sm font-semibold text-foreground",t&&"pl-8",e),...n}));gw.displayName=Ci.displayName;const sl=v.forwardRef(({className:e,...t},n)=>p.jsx(_i,{ref:n,className:Ve("-mx-1 my-1 h-px bg-border",e),...t}));sl.displayName=_i.displayName;function mw({children:e,node:t,onDelete:n,onClone:r,onSettings:o,onAddNote:s}){return p.jsxs(lw,{children:[p.jsx(uw,{asChild:!0,children:e}),p.jsxs(ol,{className:"w-48",children:[p.jsxs(Pt,{onClick:()=>o(t),className:"cursor-pointer",children:[p.jsx(mi,{className:"mr-2 h-4 w-4"}),p.jsx("span",{children:"Settings"})]}),p.jsxs(Pt,{onClick:()=>r(t),className:"cursor-pointer",children:[p.jsx(bu,{className:"mr-2 h-4 w-4"}),p.jsx("span",{children:"Clone"})]}),p.jsxs(Pt,{onClick:()=>s(t),className:"cursor-pointer",children:[p.jsx(ki,{className:"mr-2 h-4 w-4"}),p.jsx("span",{children:"Add/Edit Note"})]}),p.jsx(sl,{}),p.jsxs(Pt,{onClick:()=>n(t.id),className:"cursor-pointer text-destructive focus:text-destructive",children:[p.jsx(yi,{className:"mr-2 h-4 w-4"}),p.jsx("span",{children:"Delete"})]})]})]})}const Ye={application:Jr,tool:Qr,agent:eo,task:so,memory:to,reasoning:oo,input:no,output:ro},ue={application:{bg:"bg-yellow-50",border:"border-yellow-200"},tool:{bg:"bg-blue-50",border:"border-blue-200"},agent:{bg:"bg-pink-50",border:"border-pink-200"},task:{bg:"bg-green-50",border:"border-green-200"},memory:{bg:"bg-purple-50",border:"border-purple-200"},reasoning:{bg:"bg-teal-50",border:"border-teal-200"},input:{bg:"bg-gray-50",border:"border-gray-200"},output:{bg:"bg-gray-50",border:"border-gray-200"}},Ue=({data:e,icon:t,bgColor:n,borderColor:r,...o})=>{const s={id:o.id,type:o.type||"default",position:{x:o.positionAbsoluteX??0,y:o.positionAbsoluteY??0},data:e},i=p.jsxs("div",{className:`px-4 py-2 rounded-md shadow-sm ${n} ${r} border-2 min-w-[180px] relative`,children:[p.jsx(vt,{type:"target",position:X.Left,className:"w-3 h-3 rounded-full bg-gray-400 border-2 border-white"}),p.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[p.jsx(t,{className:"h-5 w-5"}),p.jsx("span",{className:"font-medium text-sm",children:e.label||"Node"}),e.note&&p.jsxs(Ii,{variant:"outline",className:"ml-auto cursor-pointer bg-white border-blue-400 hover:bg-blue-50",onClick:()=>e.onEditNote&&e.onEditNote(o.id),children:[p.jsx(ki,{className:"h-3 w-3 mr-1"})," Note"]})]}),e.description&&p.jsx("p",{className:"text-xs text-muted-foreground",children:String(e.description)}),p.jsx(vt,{type:"source",position:X.Right,className:"w-3 h-3 rounded-full bg-gray-400 border-2 border-white"})]});return e.onDelete&&e.onClone&&e.onSettings&&e.onAddNote?p.jsx(mw,{node:s,onDelete:e.onDelete,onClone:e.onClone,onSettings:e.onSettings,onAddNote:e.onAddNote,children:i}):i},yw=v.memo(e=>p.jsx(Ue,{...e,icon:Ye.application,bgColor:ue.application.bg,borderColor:ue.application.border})),xw=v.memo(e=>p.jsx(Ue,{...e,icon:Ye.tool,bgColor:ue.tool.bg,borderColor:ue.tool.border})),ww=v.memo(e=>p.jsx(Ue,{...e,icon:Ye.agent,bgColor:ue.agent.bg,borderColor:ue.agent.border})),_w=v.memo(e=>p.jsx(Ue,{...e,icon:Ye.task,bgColor:ue.task.bg,borderColor:ue.task.border})),bw=v.memo(e=>p.jsx(Ue,{...e,icon:Ye.memory,bgColor:ue.memory.bg,borderColor:ue.memory.border})),vw=v.memo(e=>p.jsx(Ue,{...e,icon:Ye.reasoning,bgColor:ue.reasoning.bg,borderColor:ue.reasoning.border})),Ew=v.memo(e=>p.jsx(Ue,{...e,icon:Ye.input,bgColor:ue.input.bg,borderColor:ue.input.border})),Nw=v.memo(e=>p.jsx(Ue,{...e,icon:Ye.output,bgColor:ue.output.bg,borderColor:ue.output.border})),Sw={application:yw,tool:xw,agent:ww,task:_w,memory:bw,reasoning:vw,input:Ew,output:Nw};function Cw({nodes:e,edges:t,onNodesChange:n,onEdgesChange:r,onConnect:o,onNodeClick:s,onPaneClick:i,setReactFlowInstance:a,onDrop:c,onDragOver:l,selectedNode:d,setNodes:f,onAddNode:u,reactFlowWrapper:h}){const g=v.useCallback(b=>{b.preventDefault()},[]),x=v.useCallback(b=>{c(b,h)},[c,h]);return p.jsx("div",{ref:h,className:"flex-1 h-full",onContextMenu:g,children:p.jsxs(Ex,{nodes:e,edges:t,onNodesChange:n,onEdgesChange:r,onConnect:o,onNodeClick:s,onPaneClick:i,onContextMenu:g,onInit:a,onDrop:x,onDragOver:l,fitView:!0,attributionPosition:"bottom-right",nodeTypes:Sw,children:[p.jsx(Mx,{gap:16,size:1}),p.jsx(Ox,{})]})})}function kw({node:e,onClose:t,onSaveChanges:n}){const[r,o]=v.useState({}),[s,i]=v.useState(!1);v.useEffect(()=>{e&&e.data&&(o({...e.data}),i(!1))},[e]),v.useEffect(()=>{const f=u=>{u.key==="Escape"&&(s?window.confirm("You have unsaved changes. Are you sure you want to close?")&&t():t())};return window.addEventListener("keydown",f),()=>{window.removeEventListener("keydown",f)}},[t,s]);const a=v.useCallback((f,u)=>{o(h=>({...h,[f]:u})),i(!0)},[]),c=v.useCallback(()=>{e&&(n(e,r),i(!1),ye.success("Node configuration saved"))},[e,r,n]),l=v.useCallback(()=>{s&&!window.confirm("You have unsaved changes. Are you sure you want to close?")||t()},[t,s]);if(!e)return null;const d=Object.entries(r).filter(([f,u])=>typeof u!="function"&&!f.startsWith("on")&&!["id","position","type","__rf"].includes(f));return p.jsxs("div",{className:`fixed right-0 top-0 bottom-0 w-[360px] bg-background border-l border-border shadow-lg transform transition-transform duration-300 z-20 flex flex-col overflow-hidden ${e?"translate-x-0":"translate-x-full"}`,children:[p.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx("h3",{className:"text-lg font-semibold",children:"Node Configuration"}),p.jsx(Ii,{variant:"outline",className:"ml-2",children:e.type})]}),p.jsx(ce,{variant:"ghost",size:"icon",onClick:l,className:"h-8 w-8",children:p.jsx(du,{className:"h-4 w-4"})})]}),p.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:p.jsx("div",{className:"space-y-6",children:p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{className:"space-y-2",children:[p.jsx(ct,{htmlFor:"node-label",children:"Label"}),p.jsx(Er,{id:"node-label",value:r.label||"",onChange:f=>a("label",f.target.value),placeholder:"Node Label"})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx(ct,{htmlFor:"node-description",children:"Description"}),p.jsx(vr,{id:"node-description",value:r.description||"",onChange:f=>a("description",f.target.value),placeholder:"Describe this node's purpose",rows:3})]}),r.note!==void 0&&p.jsxs("div",{className:"space-y-2",children:[p.jsx(ct,{htmlFor:"node-note",children:"Note"}),p.jsx(vr,{id:"node-note",value:r.note||"",onChange:f=>a("note",f.target.value),placeholder:"Add a note to this node",rows:3})]}),d.map(([f,u])=>f==="label"||f==="description"||f==="note"||typeof u!="string"&&typeof u!="number"&&typeof u!="boolean"?null:p.jsxs("div",{className:"space-y-2",children:[p.jsx(ct,{htmlFor:`node-${f}`,children:f.charAt(0).toUpperCase()+f.slice(1)}),typeof u=="boolean"?p.jsxs("div",{className:"flex items-center space-x-2",children:[p.jsx("input",{type:"checkbox",id:`node-${f}`,checked:u,onChange:h=>a(f,h.target.checked),className:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),p.jsx(ct,{htmlFor:`node-${f}`,children:"Enabled"})]}):p.jsx(Er,{id:`node-${f}`,value:u,onChange:h=>a(f,h.target.value)})]},f))]})})}),p.jsxs("div",{className:"border-t p-4 flex justify-end gap-3",children:[p.jsx(ce,{variant:"outline",onClick:l,children:"Cancel"}),p.jsx(ce,{onClick:c,disabled:!s,children:"Save Changes"})]})]})}const Iw=ah(({children:e})=>e,{fallback:({error:e,componentStack:t,resetError:n})=>p.jsxs("div",{className:"p-8 border rounded-md bg-red-50 m-4",children:[p.jsx("h2",{className:"text-xl font-semibold text-red-700 mb-2",children:"Workflow Editor Error"}),p.jsx("p",{className:"mb-4 text-red-600",children:e.message}),p.jsx("button",{onClick:n,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",children:"Reset Editor"})]}),onError:(e,t,n)=>{console.error("Workflow Editor Error:",e),go(e,{tags:{component:"WorkflowEditorPage"},contexts:{react:{componentStack:t}}}),ye.error(`Workflow Editor error: ${e.message}`)}});function Tw(){const{workflowId:e}=lu(),t=uu(),{user:n}=fu(),[r,o]=v.useState("My Workflow"),[s,i]=v.useState(""),[a,c]=v.useState(!1),[l,d]=v.useState(!1),[f,u]=v.useState(!1),[h,g]=v.useState(!1),{nodes:x,edges:b,onNodesChange:_,onEdgesChange:E,onConnect:m,onNodeClick:w,onPaneClick:T,onDragOver:$,onDrop:I,onAddNode:R,selectedNode:A,setNodes:j,setReactFlowInstance:H,isNodePickerOpen:L,setIsNodePickerOpen:O,nodePickerPosition:y,handleNodeAdd:k,handleAddNodeFromToolbar:N,saveWorkflow:C,reactFlowWrapper:M,closeConfigPanel:S,saveNodeConfig:D,noteDialogElement:F}=ew(),V=v.useCallback(()=>{C(r)&&(d(!0),setTimeout(()=>{ye.success("Workflow saved successfully"),d(!1)},1e3))},[r,C]),Y=v.useCallback(()=>{g(!0),setTimeout(()=>{ye.success("Workflow deployed successfully"),g(!1)},Math.floor(Math.random()*1e3)+1e3)},[]),U=v.useCallback(()=>{if(u(!0),Math.random()<.8)throw ye.error("Error: Workflow execution failed"),u(!1),new Error("Simulated error during workflow execution");setTimeout(()=>{ye.success("Workflow executed successfully"),u(!1)},Math.floor(Math.random()*1500)+500)},[]),P=()=>{t("/studio")},B=A?"flex flex-col h-[calc(100vh-5rem)] pr-[360px] transition-all duration-300":"flex flex-col h-[calc(100vh-5rem)] transition-all duration-300";return v.useEffect(()=>{Yd("page","workflow-editor"),Wd("workflow",{workflowId:e,workflowName:r,nodesCount:x.length,edgesCount:b.length})},[e,r,x.length,b.length]),p.jsxs("div",{className:B,children:[p.jsx(aw,{workflowName:r,setWorkflowName:o,onViewCode:()=>t(`/studio/workflows/${e}/code`),onSave:V,onRun:U,onSettings:()=>c(!0),onBack:P,workflowId:e,isSaving:l,isRunning:f,isDeploying:h,onDeploy:Y,onAddNode:N}),p.jsx(Cw,{nodes:x,edges:b,onNodesChange:_,onEdgesChange:E,onConnect:m,setReactFlowInstance:H,onDrop:I,onDragOver:$,onNodeClick:w,onPaneClick:T,selectedNode:A,setNodes:j,onAddNode:R,reactFlowWrapper:M}),L&&p.jsx(nw,{isOpen:L,setIsOpen:O,position:y,onSelect:k}),p.jsx(cw,{isOpen:a,setIsOpen:c,workflowName:r,setWorkflowName:o,workflowDescription:s,setWorkflowDescription:i}),p.jsx(kw,{node:A,onClose:S,onSaveChanges:D}),F]})}function r_(){return p.jsx(Iw,{children:p.jsx(Tw,{})})}export{r_ as default};
//# sourceMappingURL=WorkflowEditorPage-2HDvFhdf.js.map

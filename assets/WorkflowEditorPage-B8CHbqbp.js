import{r as N,A as Ra,D as Ha,R as Mn,j as g,m as La,t as Ba}from"./react-vendor-D9Z7L--9.js";import{c as Ae,m as Fa,n as No,w as Oa,o as Va,p as Ya,q as kr,d as fe,a as Ie,X as Xa,u as Wa,r as qa,v as Ga}from"./index-AU1k0GBq.js";import{D as Mr,b as Ar,c as Ir,d as $r,e as jr,f as Pr}from"./dialog-D_FN0Fk6.js";import{B as se}from"./button-DyydDRsx.js";import{L as Fe}from"./label-Cq7s04FH.js";import{T as An}from"./textarea-CWRfT5sV.js";import{A as Xn}from"./app-window-C_29jRGv.js";import{W as Wn}from"./wrench-B6nmTu5G.js";import{af as Ua,ag as Ka,ah as Za,ai as Qa,aj as Ja,ak as ec,al as Tr,am as Dr,an as zr,ao as Rr,ap as Hr,aq as Lr,ar as Br,as as Fr,at as Or}from"./ui-components-CC8ri8vc.js";import{I as In}from"./input-C9MDm0T4.js";import{A as tc}from"./arrow-left-CoG1BIxl.js";import{C as Vr}from"./code-D2KyAOYS.js";import{S as nc}from"./save-CL9ONgvg.js";import{S as Yr}from"./settings-BBFvavmk.js";import{C as oc}from"./chevron-up-6oX-8_Pk.js";import{C as rc}from"./chevron-down-lRykjHmp.js";import{D as sc,C as ic}from"./download-CBbzQt1q.js";import{T as Xr}from"./trash-2-DkxLFIQ5.js";import{C as ac}from"./chevron-right-B6yav54R.js";import{C as cc}from"./check-B_vNfbYE.js";import{C as lc}from"./circle-Bd03-FbO.js";import{F as Wr}from"./file-text-BJLg9NWi.js";import{B as qr}from"./badge-DQslapAQ.js";import"./supabase-BVXwAj-b.js";import"./utils-DVqAV-fM.js";try{let e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},t=new e.Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="0cc734ee-b90e-4c3d-9ced-b6e73e4e23af",e._sentryDebugIdIdentifier="sentry-dbid-0cc734ee-b90e-4c3d-9ced-b6e73e4e23af")}catch{}/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qn=Ae("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uc=Ae("CloudUpload",[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gn=Ae("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Un=Ae("FileInput",[["path",{d:"M4 22h14a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v4",key:"1pf5j1"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M2 15h10",key:"jfw4w8"}],["path",{d:"m9 18 3-3-3-3",key:"112psh"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kn=Ae("FileOutput",[["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M4 7V4a2 2 0 0 1 2-2 2 2 0 0 0-2 2",key:"1vk7w2"}],["path",{d:"M4.063 20.999a2 2 0 0 0 2 1L18 22a2 2 0 0 0 2-2V7l-5-5H6",key:"1jink5"}],["path",{d:"m5 11-3 3",key:"1dgrs4"}],["path",{d:"m5 17-3-3h10",key:"1mvvaf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zn=Ae("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qn=Ae("ListTodo",[["rect",{x:"3",y:"5",width:"6",height:"6",rx:"1",key:"1defrl"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dc=Ae("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]),fc=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,_o="/home/runner/work/sentry-javascript/sentry-javascript/packages/react/src/errorboundary.tsx";function hc(e){const t=e.match(/^([^.]+)/);return t!==null&&parseInt(t[0])>=17}const gc="unknown",Co={componentStack:null,error:null,eventId:null};function pc(e,t){const n=new WeakMap;function o(r,s){if(!n.has(r)){if(r.cause)return n.set(r,!0),o(r.cause,s);r.cause=s}}o(e,t)}class Jn extends N.Component{constructor(t){super(t),Jn.prototype.__init.call(this),this.state=Co,this._openFallbackReportDialog=!0;const n=Fa();n&&n.on&&t.showDialog&&(this._openFallbackReportDialog=!1,n.on("afterSendEvent",o=>{!o.type&&o.event_id===this._lastEventId&&No({...t.dialogOptions,eventId:this._lastEventId})}))}componentDidCatch(t,{componentStack:n}){const{beforeCapture:o,onError:r,showDialog:s,dialogOptions:i}=this.props;Oa(a=>{if(hc(N.version)&&Ya(t)){const u=new Error(t.message);u.name=`React ErrorBoundary ${t.name}`,u.stack=n,pc(t,u)}o&&o(a,t,n);const l=kr(t,{captureContext:{contexts:{react:{componentStack:n}}},mechanism:{handled:!!this.props.fallback}});r&&r(t,n,l),s&&(this._lastEventId=l,this._openFallbackReportDialog&&No({...i,eventId:l})),this.setState({error:t,componentStack:n,eventId:l})})}componentDidMount(){const{onMount:t}=this.props;t&&t()}componentWillUnmount(){const{error:t,componentStack:n,eventId:o}=this.state,{onUnmount:r}=this.props;r&&r(t,n,o)}__init(){this.resetErrorBoundary=()=>{const{onReset:t}=this.props,{error:n,componentStack:o,eventId:r}=this.state;t&&t(n,o,r),this.setState(Co)}}render(){const{fallback:t,children:n}=this.props,o=this.state;if(o.error){let r;return typeof t=="function"?r=t({error:o.error,componentStack:o.componentStack,resetError:this.resetErrorBoundary,eventId:o.eventId}):r=t,N.isValidElement(r)?r:(t&&fc&&Va.warn("fallback did not produce a valid ReactElement"),null)}return typeof n=="function"?n():n}}function mc(e,t){const n=e.displayName||e.name||gc,o=r=>N.createElement(Jn,{...t,__self:this,__source:{fileName:_o,lineNumber:240}},N.createElement(e,{...r,__self:this,__source:{fileName:_o,lineNumber:241}}));return o.displayName=`errorBoundary(${n})`,Ra(o,e),o}function oe(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,o;n<e.length;n++)(o=oe(e[n]))!==""&&(t+=(t&&" ")+o);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var xc={value:()=>{}};function Jt(){for(var e=0,t=arguments.length,n={},o;e<t;++e){if(!(o=arguments[e]+"")||o in n||/[\s.]/.test(o))throw new Error("illegal type: "+o);n[o]=[]}return new Ht(n)}function Ht(e){this._=e}function yc(e,t){return e.trim().split(/^|\s+/).map(function(n){var o="",r=n.indexOf(".");if(r>=0&&(o=n.slice(r+1),n=n.slice(0,r)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:o}})}Ht.prototype=Jt.prototype={constructor:Ht,on:function(e,t){var n=this._,o=yc(e+"",n),r,s=-1,i=o.length;if(arguments.length<2){for(;++s<i;)if((r=(e=o[s]).type)&&(r=wc(n[r],e.name)))return r;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++s<i;)if(r=(e=o[s]).type)n[r]=Eo(n[r],e.name,t);else if(t==null)for(r in n)n[r]=Eo(n[r],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Ht(e)},call:function(e,t){if((r=arguments.length-2)>0)for(var n=new Array(r),o=0,r,s;o<r;++o)n[o]=arguments[o+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],o=0,r=s.length;o<r;++o)s[o].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var o=this._[e],r=0,s=o.length;r<s;++r)o[r].value.apply(t,n)}};function wc(e,t){for(var n=0,o=e.length,r;n<o;++n)if((r=e[n]).name===t)return r.value}function Eo(e,t,n){for(var o=0,r=e.length;o<r;++o)if(e[o].name===t){e[o]=xc,e=e.slice(0,o).concat(e.slice(o+1));break}return n!=null&&e.push({name:t,value:n}),e}var $n="http://www.w3.org/1999/xhtml";const So={svg:"http://www.w3.org/2000/svg",xhtml:$n,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function en(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),So.hasOwnProperty(t)?{space:So[t],local:e}:e}function bc(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===$n&&t.documentElement.namespaceURI===$n?t.createElement(e):t.createElementNS(n,e)}}function vc(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Gr(e){var t=en(e);return(t.local?vc:bc)(t)}function Nc(){}function eo(e){return e==null?Nc:function(){return this.querySelector(e)}}function _c(e){typeof e!="function"&&(e=eo(e));for(var t=this._groups,n=t.length,o=new Array(n),r=0;r<n;++r)for(var s=t[r],i=s.length,a=o[r]=new Array(i),l,u,d=0;d<i;++d)(l=s[d])&&(u=e.call(l,l.__data__,d,s))&&("__data__"in l&&(u.__data__=l.__data__),a[d]=u);return new le(o,this._parents)}function Cc(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function Ec(){return[]}function Ur(e){return e==null?Ec:function(){return this.querySelectorAll(e)}}function Sc(e){return function(){return Cc(e.apply(this,arguments))}}function kc(e){typeof e=="function"?e=Sc(e):e=Ur(e);for(var t=this._groups,n=t.length,o=[],r=[],s=0;s<n;++s)for(var i=t[s],a=i.length,l,u=0;u<a;++u)(l=i[u])&&(o.push(e.call(l,l.__data__,u,i)),r.push(l));return new le(o,r)}function Kr(e){return function(){return this.matches(e)}}function Zr(e){return function(t){return t.matches(e)}}var Mc=Array.prototype.find;function Ac(e){return function(){return Mc.call(this.children,e)}}function Ic(){return this.firstElementChild}function $c(e){return this.select(e==null?Ic:Ac(typeof e=="function"?e:Zr(e)))}var jc=Array.prototype.filter;function Pc(){return Array.from(this.children)}function Tc(e){return function(){return jc.call(this.children,e)}}function Dc(e){return this.selectAll(e==null?Pc:Tc(typeof e=="function"?e:Zr(e)))}function zc(e){typeof e!="function"&&(e=Kr(e));for(var t=this._groups,n=t.length,o=new Array(n),r=0;r<n;++r)for(var s=t[r],i=s.length,a=o[r]=[],l,u=0;u<i;++u)(l=s[u])&&e.call(l,l.__data__,u,s)&&a.push(l);return new le(o,this._parents)}function Qr(e){return new Array(e.length)}function Rc(){return new le(this._enter||this._groups.map(Qr),this._parents)}function Ot(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Ot.prototype={constructor:Ot,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function Hc(e){return function(){return e}}function Lc(e,t,n,o,r,s){for(var i=0,a,l=t.length,u=s.length;i<u;++i)(a=t[i])?(a.__data__=s[i],o[i]=a):n[i]=new Ot(e,s[i]);for(;i<l;++i)(a=t[i])&&(r[i]=a)}function Bc(e,t,n,o,r,s,i){var a,l,u=new Map,d=t.length,f=s.length,c=new Array(d),h;for(a=0;a<d;++a)(l=t[a])&&(c[a]=h=i.call(l,l.__data__,a,t)+"",u.has(h)?r[a]=l:u.set(h,l));for(a=0;a<f;++a)h=i.call(e,s[a],a,s)+"",(l=u.get(h))?(o[a]=l,l.__data__=s[a],u.delete(h)):n[a]=new Ot(e,s[a]);for(a=0;a<d;++a)(l=t[a])&&u.get(c[a])===l&&(r[a]=l)}function Fc(e){return e.__data__}function Oc(e,t){if(!arguments.length)return Array.from(this,Fc);var n=t?Bc:Lc,o=this._parents,r=this._groups;typeof e!="function"&&(e=Hc(e));for(var s=r.length,i=new Array(s),a=new Array(s),l=new Array(s),u=0;u<s;++u){var d=o[u],f=r[u],c=f.length,h=Vc(e.call(d,d&&d.__data__,u,o)),p=h.length,y=a[u]=new Array(p),v=i[u]=new Array(p),b=l[u]=new Array(c);n(d,f,y,v,b,h,t);for(var _=0,m=0,w,A;_<p;++_)if(w=y[_]){for(_>=m&&(m=_+1);!(A=v[m])&&++m<p;);w._next=A||null}}return i=new le(i,o),i._enter=a,i._exit=l,i}function Vc(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Yc(){return new le(this._exit||this._groups.map(Qr),this._parents)}function Xc(e,t,n){var o=this.enter(),r=this,s=this.exit();return typeof e=="function"?(o=e(o),o&&(o=o.selection())):o=o.append(e+""),t!=null&&(r=t(r),r&&(r=r.selection())),n==null?s.remove():n(s),o&&r?o.merge(r).order():r}function Wc(e){for(var t=e.selection?e.selection():e,n=this._groups,o=t._groups,r=n.length,s=o.length,i=Math.min(r,s),a=new Array(r),l=0;l<i;++l)for(var u=n[l],d=o[l],f=u.length,c=a[l]=new Array(f),h,p=0;p<f;++p)(h=u[p]||d[p])&&(c[p]=h);for(;l<r;++l)a[l]=n[l];return new le(a,this._parents)}function qc(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var o=e[t],r=o.length-1,s=o[r],i;--r>=0;)(i=o[r])&&(s&&i.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(i,s),s=i);return this}function Gc(e){e||(e=Uc);function t(f,c){return f&&c?e(f.__data__,c.__data__):!f-!c}for(var n=this._groups,o=n.length,r=new Array(o),s=0;s<o;++s){for(var i=n[s],a=i.length,l=r[s]=new Array(a),u,d=0;d<a;++d)(u=i[d])&&(l[d]=u);l.sort(t)}return new le(r,this._parents).order()}function Uc(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Kc(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function Zc(){return Array.from(this)}function Qc(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var o=e[t],r=0,s=o.length;r<s;++r){var i=o[r];if(i)return i}return null}function Jc(){let e=0;for(const t of this)++e;return e}function el(){return!this.node()}function tl(e){for(var t=this._groups,n=0,o=t.length;n<o;++n)for(var r=t[n],s=0,i=r.length,a;s<i;++s)(a=r[s])&&e.call(a,a.__data__,s,r);return this}function nl(e){return function(){this.removeAttribute(e)}}function ol(e){return function(){this.removeAttributeNS(e.space,e.local)}}function rl(e,t){return function(){this.setAttribute(e,t)}}function sl(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function il(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function al(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function cl(e,t){var n=en(e);if(arguments.length<2){var o=this.node();return n.local?o.getAttributeNS(n.space,n.local):o.getAttribute(n)}return this.each((t==null?n.local?ol:nl:typeof t=="function"?n.local?al:il:n.local?sl:rl)(n,t))}function Jr(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function ll(e){return function(){this.style.removeProperty(e)}}function ul(e,t,n){return function(){this.style.setProperty(e,t,n)}}function dl(e,t,n){return function(){var o=t.apply(this,arguments);o==null?this.style.removeProperty(e):this.style.setProperty(e,o,n)}}function fl(e,t,n){return arguments.length>1?this.each((t==null?ll:typeof t=="function"?dl:ul)(e,t,n??"")):We(this.node(),e)}function We(e,t){return e.style.getPropertyValue(t)||Jr(e).getComputedStyle(e,null).getPropertyValue(t)}function hl(e){return function(){delete this[e]}}function gl(e,t){return function(){this[e]=t}}function pl(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function ml(e,t){return arguments.length>1?this.each((t==null?hl:typeof t=="function"?pl:gl)(e,t)):this.node()[e]}function es(e){return e.trim().split(/^|\s+/)}function to(e){return e.classList||new ts(e)}function ts(e){this._node=e,this._names=es(e.getAttribute("class")||"")}ts.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function ns(e,t){for(var n=to(e),o=-1,r=t.length;++o<r;)n.add(t[o])}function os(e,t){for(var n=to(e),o=-1,r=t.length;++o<r;)n.remove(t[o])}function xl(e){return function(){ns(this,e)}}function yl(e){return function(){os(this,e)}}function wl(e,t){return function(){(t.apply(this,arguments)?ns:os)(this,e)}}function bl(e,t){var n=es(e+"");if(arguments.length<2){for(var o=to(this.node()),r=-1,s=n.length;++r<s;)if(!o.contains(n[r]))return!1;return!0}return this.each((typeof t=="function"?wl:t?xl:yl)(n,t))}function vl(){this.textContent=""}function Nl(e){return function(){this.textContent=e}}function _l(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function Cl(e){return arguments.length?this.each(e==null?vl:(typeof e=="function"?_l:Nl)(e)):this.node().textContent}function El(){this.innerHTML=""}function Sl(e){return function(){this.innerHTML=e}}function kl(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function Ml(e){return arguments.length?this.each(e==null?El:(typeof e=="function"?kl:Sl)(e)):this.node().innerHTML}function Al(){this.nextSibling&&this.parentNode.appendChild(this)}function Il(){return this.each(Al)}function $l(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function jl(){return this.each($l)}function Pl(e){var t=typeof e=="function"?e:Gr(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function Tl(){return null}function Dl(e,t){var n=typeof e=="function"?e:Gr(e),o=t==null?Tl:typeof t=="function"?t:eo(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),o.apply(this,arguments)||null)})}function zl(){var e=this.parentNode;e&&e.removeChild(this)}function Rl(){return this.each(zl)}function Hl(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Ll(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Bl(e){return this.select(e?Ll:Hl)}function Fl(e){return arguments.length?this.property("__data__",e):this.node().__data__}function Ol(e){return function(t){e.call(this,t,this.__data__)}}function Vl(e){return e.trim().split(/^|\s+/).map(function(t){var n="",o=t.indexOf(".");return o>=0&&(n=t.slice(o+1),t=t.slice(0,o)),{type:t,name:n}})}function Yl(e){return function(){var t=this.__on;if(t){for(var n=0,o=-1,r=t.length,s;n<r;++n)s=t[n],(!e.type||s.type===e.type)&&s.name===e.name?this.removeEventListener(s.type,s.listener,s.options):t[++o]=s;++o?t.length=o:delete this.__on}}}function Xl(e,t,n){return function(){var o=this.__on,r,s=Ol(t);if(o){for(var i=0,a=o.length;i<a;++i)if((r=o[i]).type===e.type&&r.name===e.name){this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=s,r.options=n),r.value=t;return}}this.addEventListener(e.type,s,n),r={type:e.type,name:e.name,value:t,listener:s,options:n},o?o.push(r):this.__on=[r]}}function Wl(e,t,n){var o=Vl(e+""),r,s=o.length,i;if(arguments.length<2){var a=this.node().__on;if(a){for(var l=0,u=a.length,d;l<u;++l)for(r=0,d=a[l];r<s;++r)if((i=o[r]).type===d.type&&i.name===d.name)return d.value}return}for(a=t?Xl:Yl,r=0;r<s;++r)this.each(a(o[r],t,n));return this}function rs(e,t,n){var o=Jr(e),r=o.CustomEvent;typeof r=="function"?r=new r(t,n):(r=o.document.createEvent("Event"),n?(r.initEvent(t,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(t,!1,!1)),e.dispatchEvent(r)}function ql(e,t){return function(){return rs(this,e,t)}}function Gl(e,t){return function(){return rs(this,e,t.apply(this,arguments))}}function Ul(e,t){return this.each((typeof t=="function"?Gl:ql)(e,t))}function*Kl(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var o=e[t],r=0,s=o.length,i;r<s;++r)(i=o[r])&&(yield i)}var ss=[null];function le(e,t){this._groups=e,this._parents=t}function Nt(){return new le([[document.documentElement]],ss)}function Zl(){return this}le.prototype=Nt.prototype={constructor:le,select:_c,selectAll:kc,selectChild:$c,selectChildren:Dc,filter:zc,data:Oc,enter:Rc,exit:Yc,join:Xc,merge:Wc,selection:Zl,order:qc,sort:Gc,call:Kc,nodes:Zc,node:Qc,size:Jc,empty:el,each:tl,attr:cl,style:fl,property:ml,classed:bl,text:Cl,html:Ml,raise:Il,lower:jl,append:Pl,insert:Dl,remove:Rl,clone:Bl,datum:Fl,on:Wl,dispatch:Ul,[Symbol.iterator]:Kl};function ce(e){return typeof e=="string"?new le([[document.querySelector(e)]],[document.documentElement]):new le([[e]],ss)}function Ql(e){let t;for(;t=e.sourceEvent;)e=t;return e}function de(e,t){if(e=Ql(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var o=n.createSVGPoint();return o.x=e.clientX,o.y=e.clientY,o=o.matrixTransform(t.getScreenCTM().inverse()),[o.x,o.y]}if(t.getBoundingClientRect){var r=t.getBoundingClientRect();return[e.clientX-r.left-t.clientLeft,e.clientY-r.top-t.clientTop]}}return[e.pageX,e.pageY]}const Jl={passive:!1},ft={capture:!0,passive:!1};function wn(e){e.stopImmediatePropagation()}function Ye(e){e.preventDefault(),e.stopImmediatePropagation()}function is(e){var t=e.document.documentElement,n=ce(e).on("dragstart.drag",Ye,ft);"onselectstart"in t?n.on("selectstart.drag",Ye,ft):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function as(e,t){var n=e.document.documentElement,o=ce(e).on("dragstart.drag",null);t&&(o.on("click.drag",Ye,ft),setTimeout(function(){o.on("click.drag",null)},0)),"onselectstart"in n?o.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const At=e=>()=>e;function jn(e,{sourceEvent:t,subject:n,target:o,identifier:r,active:s,x:i,y:a,dx:l,dy:u,dispatch:d}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:o,enumerable:!0,configurable:!0},identifier:{value:r,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:i,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:d}})}jn.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function eu(e){return!e.ctrlKey&&!e.button}function tu(){return this.parentNode}function nu(e,t){return t??{x:e.x,y:e.y}}function ou(){return navigator.maxTouchPoints||"ontouchstart"in this}function cs(){var e=eu,t=tu,n=nu,o=ou,r={},s=Jt("start","drag","end"),i=0,a,l,u,d,f=0;function c(w){w.on("mousedown.drag",h).filter(o).on("touchstart.drag",v).on("touchmove.drag",b,Jl).on("touchend.drag touchcancel.drag",_).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(w,A){if(!(d||!e.call(this,w,A))){var $=m(this,t.call(this,w,A),w,A,"mouse");$&&(ce(w.view).on("mousemove.drag",p,ft).on("mouseup.drag",y,ft),is(w.view),wn(w),u=!1,a=w.clientX,l=w.clientY,$("start",w))}}function p(w){if(Ye(w),!u){var A=w.clientX-a,$=w.clientY-l;u=A*A+$*$>f}r.mouse("drag",w)}function y(w){ce(w.view).on("mousemove.drag mouseup.drag",null),as(w.view,u),Ye(w),r.mouse("end",w)}function v(w,A){if(e.call(this,w,A)){var $=w.changedTouches,M=t.call(this,w,A),D=$.length,j,T;for(j=0;j<D;++j)(T=m(this,M,w,A,$[j].identifier,$[j]))&&(wn(w),T("start",w,$[j]))}}function b(w){var A=w.changedTouches,$=A.length,M,D;for(M=0;M<$;++M)(D=r[A[M].identifier])&&(Ye(w),D("drag",w,A[M]))}function _(w){var A=w.changedTouches,$=A.length,M,D;for(d&&clearTimeout(d),d=setTimeout(function(){d=null},500),M=0;M<$;++M)(D=r[A[M].identifier])&&(wn(w),D("end",w,A[M]))}function m(w,A,$,M,D,j){var T=s.copy(),L=de(j||$,A),H,R,x;if((x=n.call(w,new jn("beforestart",{sourceEvent:$,target:c,identifier:D,active:i,x:L[0],y:L[1],dx:0,dy:0,dispatch:T}),M))!=null)return H=x.x-L[0]||0,R=x.y-L[1]||0,function k(C,S,I){var E=L,P;switch(C){case"start":r[D]=k,P=i++;break;case"end":delete r[D],--i;case"drag":L=de(I||S,A),P=i;break}T.call(C,w,new jn(C,{sourceEvent:S,subject:x,target:c,identifier:D,active:P,x:L[0]+H,y:L[1]+R,dx:L[0]-E[0],dy:L[1]-E[1],dispatch:T}),M)}}return c.filter=function(w){return arguments.length?(e=typeof w=="function"?w:At(!!w),c):e},c.container=function(w){return arguments.length?(t=typeof w=="function"?w:At(w),c):t},c.subject=function(w){return arguments.length?(n=typeof w=="function"?w:At(w),c):n},c.touchable=function(w){return arguments.length?(o=typeof w=="function"?w:At(!!w),c):o},c.on=function(){var w=s.on.apply(s,arguments);return w===s?c:w},c.clickDistance=function(w){return arguments.length?(f=(w=+w)*w,c):Math.sqrt(f)},c}function no(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function ls(e,t){var n=Object.create(e.prototype);for(var o in t)n[o]=t[o];return n}function _t(){}var ht=.7,Vt=1/ht,Xe="\\s*([+-]?\\d+)\\s*",gt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",me="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ru=/^#([0-9a-f]{3,8})$/,su=new RegExp(`^rgb\\(${Xe},${Xe},${Xe}\\)$`),iu=new RegExp(`^rgb\\(${me},${me},${me}\\)$`),au=new RegExp(`^rgba\\(${Xe},${Xe},${Xe},${gt}\\)$`),cu=new RegExp(`^rgba\\(${me},${me},${me},${gt}\\)$`),lu=new RegExp(`^hsl\\(${gt},${me},${me}\\)$`),uu=new RegExp(`^hsla\\(${gt},${me},${me},${gt}\\)$`),ko={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};no(_t,pt,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Mo,formatHex:Mo,formatHex8:du,formatHsl:fu,formatRgb:Ao,toString:Ao});function Mo(){return this.rgb().formatHex()}function du(){return this.rgb().formatHex8()}function fu(){return us(this).formatHsl()}function Ao(){return this.rgb().formatRgb()}function pt(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=ru.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Io(t):n===3?new ae(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?It(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?It(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=su.exec(e))?new ae(t[1],t[2],t[3],1):(t=iu.exec(e))?new ae(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=au.exec(e))?It(t[1],t[2],t[3],t[4]):(t=cu.exec(e))?It(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=lu.exec(e))?Po(t[1],t[2]/100,t[3]/100,1):(t=uu.exec(e))?Po(t[1],t[2]/100,t[3]/100,t[4]):ko.hasOwnProperty(e)?Io(ko[e]):e==="transparent"?new ae(NaN,NaN,NaN,0):null}function Io(e){return new ae(e>>16&255,e>>8&255,e&255,1)}function It(e,t,n,o){return o<=0&&(e=t=n=NaN),new ae(e,t,n,o)}function hu(e){return e instanceof _t||(e=pt(e)),e?(e=e.rgb(),new ae(e.r,e.g,e.b,e.opacity)):new ae}function Pn(e,t,n,o){return arguments.length===1?hu(e):new ae(e,t,n,o??1)}function ae(e,t,n,o){this.r=+e,this.g=+t,this.b=+n,this.opacity=+o}no(ae,Pn,ls(_t,{brighter(e){return e=e==null?Vt:Math.pow(Vt,e),new ae(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?ht:Math.pow(ht,e),new ae(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ae(De(this.r),De(this.g),De(this.b),Yt(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:$o,formatHex:$o,formatHex8:gu,formatRgb:jo,toString:jo}));function $o(){return`#${Te(this.r)}${Te(this.g)}${Te(this.b)}`}function gu(){return`#${Te(this.r)}${Te(this.g)}${Te(this.b)}${Te((isNaN(this.opacity)?1:this.opacity)*255)}`}function jo(){const e=Yt(this.opacity);return`${e===1?"rgb(":"rgba("}${De(this.r)}, ${De(this.g)}, ${De(this.b)}${e===1?")":`, ${e})`}`}function Yt(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function De(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Te(e){return e=De(e),(e<16?"0":"")+e.toString(16)}function Po(e,t,n,o){return o<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new he(e,t,n,o)}function us(e){if(e instanceof he)return new he(e.h,e.s,e.l,e.opacity);if(e instanceof _t||(e=pt(e)),!e)return new he;if(e instanceof he)return e;e=e.rgb();var t=e.r/255,n=e.g/255,o=e.b/255,r=Math.min(t,n,o),s=Math.max(t,n,o),i=NaN,a=s-r,l=(s+r)/2;return a?(t===s?i=(n-o)/a+(n<o)*6:n===s?i=(o-t)/a+2:i=(t-n)/a+4,a/=l<.5?s+r:2-s-r,i*=60):a=l>0&&l<1?0:i,new he(i,a,l,e.opacity)}function pu(e,t,n,o){return arguments.length===1?us(e):new he(e,t,n,o??1)}function he(e,t,n,o){this.h=+e,this.s=+t,this.l=+n,this.opacity=+o}no(he,pu,ls(_t,{brighter(e){return e=e==null?Vt:Math.pow(Vt,e),new he(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?ht:Math.pow(ht,e),new he(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,o=n+(n<.5?n:1-n)*t,r=2*n-o;return new ae(bn(e>=240?e-240:e+120,r,o),bn(e,r,o),bn(e<120?e+240:e-120,r,o),this.opacity)},clamp(){return new he(To(this.h),$t(this.s),$t(this.l),Yt(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Yt(this.opacity);return`${e===1?"hsl(":"hsla("}${To(this.h)}, ${$t(this.s)*100}%, ${$t(this.l)*100}%${e===1?")":`, ${e})`}`}}));function To(e){return e=(e||0)%360,e<0?e+360:e}function $t(e){return Math.max(0,Math.min(1,e||0))}function bn(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const ds=e=>()=>e;function mu(e,t){return function(n){return e+n*t}}function xu(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(o){return Math.pow(e+o*t,n)}}function yu(e){return(e=+e)==1?fs:function(t,n){return n-t?xu(t,n,e):ds(isNaN(t)?n:t)}}function fs(e,t){var n=t-e;return n?mu(e,n):ds(isNaN(e)?t:e)}const Do=function e(t){var n=yu(t);function o(r,s){var i=n((r=Pn(r)).r,(s=Pn(s)).r),a=n(r.g,s.g),l=n(r.b,s.b),u=fs(r.opacity,s.opacity);return function(d){return r.r=i(d),r.g=a(d),r.b=l(d),r.opacity=u(d),r+""}}return o.gamma=e,o}(1);function Se(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var Tn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,vn=new RegExp(Tn.source,"g");function wu(e){return function(){return e}}function bu(e){return function(t){return e(t)+""}}function vu(e,t){var n=Tn.lastIndex=vn.lastIndex=0,o,r,s,i=-1,a=[],l=[];for(e=e+"",t=t+"";(o=Tn.exec(e))&&(r=vn.exec(t));)(s=r.index)>n&&(s=t.slice(n,s),a[i]?a[i]+=s:a[++i]=s),(o=o[0])===(r=r[0])?a[i]?a[i]+=r:a[++i]=r:(a[++i]=null,l.push({i,x:Se(o,r)})),n=vn.lastIndex;return n<t.length&&(s=t.slice(n),a[i]?a[i]+=s:a[++i]=s),a.length<2?l[0]?bu(l[0].x):wu(t):(t=l.length,function(u){for(var d=0,f;d<t;++d)a[(f=l[d]).i]=f.x(u);return a.join("")})}var zo=180/Math.PI,Dn={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function hs(e,t,n,o,r,s){var i,a,l;return(i=Math.sqrt(e*e+t*t))&&(e/=i,t/=i),(l=e*n+t*o)&&(n-=e*l,o-=t*l),(a=Math.sqrt(n*n+o*o))&&(n/=a,o/=a,l/=a),e*o<t*n&&(e=-e,t=-t,l=-l,i=-i),{translateX:r,translateY:s,rotate:Math.atan2(t,e)*zo,skewX:Math.atan(l)*zo,scaleX:i,scaleY:a}}var jt;function Nu(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Dn:hs(t.a,t.b,t.c,t.d,t.e,t.f)}function _u(e){return e==null||(jt||(jt=document.createElementNS("http://www.w3.org/2000/svg","g")),jt.setAttribute("transform",e),!(e=jt.transform.baseVal.consolidate()))?Dn:(e=e.matrix,hs(e.a,e.b,e.c,e.d,e.e,e.f))}function gs(e,t,n,o){function r(u){return u.length?u.pop()+" ":""}function s(u,d,f,c,h,p){if(u!==f||d!==c){var y=h.push("translate(",null,t,null,n);p.push({i:y-4,x:Se(u,f)},{i:y-2,x:Se(d,c)})}else(f||c)&&h.push("translate("+f+t+c+n)}function i(u,d,f,c){u!==d?(u-d>180?d+=360:d-u>180&&(u+=360),c.push({i:f.push(r(f)+"rotate(",null,o)-2,x:Se(u,d)})):d&&f.push(r(f)+"rotate("+d+o)}function a(u,d,f,c){u!==d?c.push({i:f.push(r(f)+"skewX(",null,o)-2,x:Se(u,d)}):d&&f.push(r(f)+"skewX("+d+o)}function l(u,d,f,c,h,p){if(u!==f||d!==c){var y=h.push(r(h)+"scale(",null,",",null,")");p.push({i:y-4,x:Se(u,f)},{i:y-2,x:Se(d,c)})}else(f!==1||c!==1)&&h.push(r(h)+"scale("+f+","+c+")")}return function(u,d){var f=[],c=[];return u=e(u),d=e(d),s(u.translateX,u.translateY,d.translateX,d.translateY,f,c),i(u.rotate,d.rotate,f,c),a(u.skewX,d.skewX,f,c),l(u.scaleX,u.scaleY,d.scaleX,d.scaleY,f,c),u=d=null,function(h){for(var p=-1,y=c.length,v;++p<y;)f[(v=c[p]).i]=v.x(h);return f.join("")}}}var Cu=gs(Nu,"px, ","px)","deg)"),Eu=gs(_u,", ",")",")"),Su=1e-12;function Ro(e){return((e=Math.exp(e))+1/e)/2}function ku(e){return((e=Math.exp(e))-1/e)/2}function Mu(e){return((e=Math.exp(2*e))-1)/(e+1)}const Au=function e(t,n,o){function r(s,i){var a=s[0],l=s[1],u=s[2],d=i[0],f=i[1],c=i[2],h=d-a,p=f-l,y=h*h+p*p,v,b;if(y<Su)b=Math.log(c/u)/t,v=function(M){return[a+M*h,l+M*p,u*Math.exp(t*M*b)]};else{var _=Math.sqrt(y),m=(c*c-u*u+o*y)/(2*u*n*_),w=(c*c-u*u-o*y)/(2*c*n*_),A=Math.log(Math.sqrt(m*m+1)-m),$=Math.log(Math.sqrt(w*w+1)-w);b=($-A)/t,v=function(M){var D=M*b,j=Ro(A),T=u/(n*_)*(j*Mu(t*D+A)-ku(A));return[a+T*h,l+T*p,u*j/Ro(t*D+A)]}}return v.duration=b*1e3*t/Math.SQRT2,v}return r.rho=function(s){var i=Math.max(.001,+s),a=i*i,l=a*a;return e(i,a,l)},r}(Math.SQRT2,2,4);var qe=0,at=0,rt=0,ps=1e3,Xt,ct,Wt=0,Re=0,tn=0,mt=typeof performance=="object"&&performance.now?performance:Date,ms=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function oo(){return Re||(ms(Iu),Re=mt.now()+tn)}function Iu(){Re=0}function qt(){this._call=this._time=this._next=null}qt.prototype=xs.prototype={constructor:qt,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?oo():+n)+(t==null?0:+t),!this._next&&ct!==this&&(ct?ct._next=this:Xt=this,ct=this),this._call=e,this._time=n,zn()},stop:function(){this._call&&(this._call=null,this._time=1/0,zn())}};function xs(e,t,n){var o=new qt;return o.restart(e,t,n),o}function $u(){oo(),++qe;for(var e=Xt,t;e;)(t=Re-e._time)>=0&&e._call.call(void 0,t),e=e._next;--qe}function Ho(){Re=(Wt=mt.now())+tn,qe=at=0;try{$u()}finally{qe=0,Pu(),Re=0}}function ju(){var e=mt.now(),t=e-Wt;t>ps&&(tn-=t,Wt=e)}function Pu(){for(var e,t=Xt,n,o=1/0;t;)t._call?(o>t._time&&(o=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Xt=n);ct=e,zn(o)}function zn(e){if(!qe){at&&(at=clearTimeout(at));var t=e-Re;t>24?(e<1/0&&(at=setTimeout(Ho,e-mt.now()-tn)),rt&&(rt=clearInterval(rt))):(rt||(Wt=mt.now(),rt=setInterval(ju,ps)),qe=1,ms(Ho))}}function Lo(e,t,n){var o=new qt;return t=t==null?0:+t,o.restart(r=>{o.stop(),e(r+t)},t,n),o}var Tu=Jt("start","end","cancel","interrupt"),Du=[],ys=0,Bo=1,Rn=2,Lt=3,Fo=4,Hn=5,Bt=6;function nn(e,t,n,o,r,s){var i=e.__transition;if(!i)e.__transition={};else if(n in i)return;zu(e,n,{name:t,index:o,group:r,on:Tu,tween:Du,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:ys})}function ro(e,t){var n=pe(e,t);if(n.state>ys)throw new Error("too late; already scheduled");return n}function ye(e,t){var n=pe(e,t);if(n.state>Lt)throw new Error("too late; already running");return n}function pe(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function zu(e,t,n){var o=e.__transition,r;o[t]=n,n.timer=xs(s,0,n.time);function s(u){n.state=Bo,n.timer.restart(i,n.delay,n.time),n.delay<=u&&i(u-n.delay)}function i(u){var d,f,c,h;if(n.state!==Bo)return l();for(d in o)if(h=o[d],h.name===n.name){if(h.state===Lt)return Lo(i);h.state===Fo?(h.state=Bt,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete o[d]):+d<t&&(h.state=Bt,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete o[d])}if(Lo(function(){n.state===Lt&&(n.state=Fo,n.timer.restart(a,n.delay,n.time),a(u))}),n.state=Rn,n.on.call("start",e,e.__data__,n.index,n.group),n.state===Rn){for(n.state=Lt,r=new Array(c=n.tween.length),d=0,f=-1;d<c;++d)(h=n.tween[d].value.call(e,e.__data__,n.index,n.group))&&(r[++f]=h);r.length=f+1}}function a(u){for(var d=u<n.duration?n.ease.call(null,u/n.duration):(n.timer.restart(l),n.state=Hn,1),f=-1,c=r.length;++f<c;)r[f].call(e,d);n.state===Hn&&(n.on.call("end",e,e.__data__,n.index,n.group),l())}function l(){n.state=Bt,n.timer.stop(),delete o[t];for(var u in o)return;delete e.__transition}}function Ft(e,t){var n=e.__transition,o,r,s=!0,i;if(n){t=t==null?null:t+"";for(i in n){if((o=n[i]).name!==t){s=!1;continue}r=o.state>Rn&&o.state<Hn,o.state=Bt,o.timer.stop(),o.on.call(r?"interrupt":"cancel",e,e.__data__,o.index,o.group),delete n[i]}s&&delete e.__transition}}function Ru(e){return this.each(function(){Ft(this,e)})}function Hu(e,t){var n,o;return function(){var r=ye(this,e),s=r.tween;if(s!==n){o=n=s;for(var i=0,a=o.length;i<a;++i)if(o[i].name===t){o=o.slice(),o.splice(i,1);break}}r.tween=o}}function Lu(e,t,n){var o,r;if(typeof n!="function")throw new Error;return function(){var s=ye(this,e),i=s.tween;if(i!==o){r=(o=i).slice();for(var a={name:t,value:n},l=0,u=r.length;l<u;++l)if(r[l].name===t){r[l]=a;break}l===u&&r.push(a)}s.tween=r}}function Bu(e,t){var n=this._id;if(e+="",arguments.length<2){for(var o=pe(this.node(),n).tween,r=0,s=o.length,i;r<s;++r)if((i=o[r]).name===e)return i.value;return null}return this.each((t==null?Hu:Lu)(n,e,t))}function so(e,t,n){var o=e._id;return e.each(function(){var r=ye(this,o);(r.value||(r.value={}))[t]=n.apply(this,arguments)}),function(r){return pe(r,o).value[t]}}function ws(e,t){var n;return(typeof t=="number"?Se:t instanceof pt?Do:(n=pt(t))?(t=n,Do):vu)(e,t)}function Fu(e){return function(){this.removeAttribute(e)}}function Ou(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Vu(e,t,n){var o,r=n+"",s;return function(){var i=this.getAttribute(e);return i===r?null:i===o?s:s=t(o=i,n)}}function Yu(e,t,n){var o,r=n+"",s;return function(){var i=this.getAttributeNS(e.space,e.local);return i===r?null:i===o?s:s=t(o=i,n)}}function Xu(e,t,n){var o,r,s;return function(){var i,a=n(this),l;return a==null?void this.removeAttribute(e):(i=this.getAttribute(e),l=a+"",i===l?null:i===o&&l===r?s:(r=l,s=t(o=i,a)))}}function Wu(e,t,n){var o,r,s;return function(){var i,a=n(this),l;return a==null?void this.removeAttributeNS(e.space,e.local):(i=this.getAttributeNS(e.space,e.local),l=a+"",i===l?null:i===o&&l===r?s:(r=l,s=t(o=i,a)))}}function qu(e,t){var n=en(e),o=n==="transform"?Eu:ws;return this.attrTween(e,typeof t=="function"?(n.local?Wu:Xu)(n,o,so(this,"attr."+e,t)):t==null?(n.local?Ou:Fu)(n):(n.local?Yu:Vu)(n,o,t))}function Gu(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function Uu(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function Ku(e,t){var n,o;function r(){var s=t.apply(this,arguments);return s!==o&&(n=(o=s)&&Uu(e,s)),n}return r._value=t,r}function Zu(e,t){var n,o;function r(){var s=t.apply(this,arguments);return s!==o&&(n=(o=s)&&Gu(e,s)),n}return r._value=t,r}function Qu(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var o=en(e);return this.tween(n,(o.local?Ku:Zu)(o,t))}function Ju(e,t){return function(){ro(this,e).delay=+t.apply(this,arguments)}}function ed(e,t){return t=+t,function(){ro(this,e).delay=t}}function td(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Ju:ed)(t,e)):pe(this.node(),t).delay}function nd(e,t){return function(){ye(this,e).duration=+t.apply(this,arguments)}}function od(e,t){return t=+t,function(){ye(this,e).duration=t}}function rd(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?nd:od)(t,e)):pe(this.node(),t).duration}function sd(e,t){if(typeof t!="function")throw new Error;return function(){ye(this,e).ease=t}}function id(e){var t=this._id;return arguments.length?this.each(sd(t,e)):pe(this.node(),t).ease}function ad(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;ye(this,e).ease=n}}function cd(e){if(typeof e!="function")throw new Error;return this.each(ad(this._id,e))}function ld(e){typeof e!="function"&&(e=Kr(e));for(var t=this._groups,n=t.length,o=new Array(n),r=0;r<n;++r)for(var s=t[r],i=s.length,a=o[r]=[],l,u=0;u<i;++u)(l=s[u])&&e.call(l,l.__data__,u,s)&&a.push(l);return new Ne(o,this._parents,this._name,this._id)}function ud(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,o=t.length,r=n.length,s=Math.min(o,r),i=new Array(o),a=0;a<s;++a)for(var l=t[a],u=n[a],d=l.length,f=i[a]=new Array(d),c,h=0;h<d;++h)(c=l[h]||u[h])&&(f[h]=c);for(;a<o;++a)i[a]=t[a];return new Ne(i,this._parents,this._name,this._id)}function dd(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function fd(e,t,n){var o,r,s=dd(t)?ro:ye;return function(){var i=s(this,e),a=i.on;a!==o&&(r=(o=a).copy()).on(t,n),i.on=r}}function hd(e,t){var n=this._id;return arguments.length<2?pe(this.node(),n).on.on(e):this.each(fd(n,e,t))}function gd(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function pd(){return this.on("end.remove",gd(this._id))}function md(e){var t=this._name,n=this._id;typeof e!="function"&&(e=eo(e));for(var o=this._groups,r=o.length,s=new Array(r),i=0;i<r;++i)for(var a=o[i],l=a.length,u=s[i]=new Array(l),d,f,c=0;c<l;++c)(d=a[c])&&(f=e.call(d,d.__data__,c,a))&&("__data__"in d&&(f.__data__=d.__data__),u[c]=f,nn(u[c],t,n,c,u,pe(d,n)));return new Ne(s,this._parents,t,n)}function xd(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Ur(e));for(var o=this._groups,r=o.length,s=[],i=[],a=0;a<r;++a)for(var l=o[a],u=l.length,d,f=0;f<u;++f)if(d=l[f]){for(var c=e.call(d,d.__data__,f,l),h,p=pe(d,n),y=0,v=c.length;y<v;++y)(h=c[y])&&nn(h,t,n,y,c,p);s.push(c),i.push(d)}return new Ne(s,i,t,n)}var yd=Nt.prototype.constructor;function wd(){return new yd(this._groups,this._parents)}function bd(e,t){var n,o,r;return function(){var s=We(this,e),i=(this.style.removeProperty(e),We(this,e));return s===i?null:s===n&&i===o?r:r=t(n=s,o=i)}}function bs(e){return function(){this.style.removeProperty(e)}}function vd(e,t,n){var o,r=n+"",s;return function(){var i=We(this,e);return i===r?null:i===o?s:s=t(o=i,n)}}function Nd(e,t,n){var o,r,s;return function(){var i=We(this,e),a=n(this),l=a+"";return a==null&&(l=a=(this.style.removeProperty(e),We(this,e))),i===l?null:i===o&&l===r?s:(r=l,s=t(o=i,a))}}function _d(e,t){var n,o,r,s="style."+t,i="end."+s,a;return function(){var l=ye(this,e),u=l.on,d=l.value[s]==null?a||(a=bs(t)):void 0;(u!==n||r!==d)&&(o=(n=u).copy()).on(i,r=d),l.on=o}}function Cd(e,t,n){var o=(e+="")=="transform"?Cu:ws;return t==null?this.styleTween(e,bd(e,o)).on("end.style."+e,bs(e)):typeof t=="function"?this.styleTween(e,Nd(e,o,so(this,"style."+e,t))).each(_d(this._id,e)):this.styleTween(e,vd(e,o,t),n).on("end.style."+e,null)}function Ed(e,t,n){return function(o){this.style.setProperty(e,t.call(this,o),n)}}function Sd(e,t,n){var o,r;function s(){var i=t.apply(this,arguments);return i!==r&&(o=(r=i)&&Ed(e,i,n)),o}return s._value=t,s}function kd(e,t,n){var o="style."+(e+="");if(arguments.length<2)return(o=this.tween(o))&&o._value;if(t==null)return this.tween(o,null);if(typeof t!="function")throw new Error;return this.tween(o,Sd(e,t,n??""))}function Md(e){return function(){this.textContent=e}}function Ad(e){return function(){var t=e(this);this.textContent=t??""}}function Id(e){return this.tween("text",typeof e=="function"?Ad(so(this,"text",e)):Md(e==null?"":e+""))}function $d(e){return function(t){this.textContent=e.call(this,t)}}function jd(e){var t,n;function o(){var r=e.apply(this,arguments);return r!==n&&(t=(n=r)&&$d(r)),t}return o._value=e,o}function Pd(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,jd(e))}function Td(){for(var e=this._name,t=this._id,n=vs(),o=this._groups,r=o.length,s=0;s<r;++s)for(var i=o[s],a=i.length,l,u=0;u<a;++u)if(l=i[u]){var d=pe(l,t);nn(l,e,n,u,i,{time:d.time+d.delay+d.duration,delay:0,duration:d.duration,ease:d.ease})}return new Ne(o,this._parents,e,n)}function Dd(){var e,t,n=this,o=n._id,r=n.size();return new Promise(function(s,i){var a={value:i},l={value:function(){--r===0&&s()}};n.each(function(){var u=ye(this,o),d=u.on;d!==e&&(t=(e=d).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(l)),u.on=t}),r===0&&s()})}var zd=0;function Ne(e,t,n,o){this._groups=e,this._parents=t,this._name=n,this._id=o}function vs(){return++zd}var we=Nt.prototype;Ne.prototype={constructor:Ne,select:md,selectAll:xd,selectChild:we.selectChild,selectChildren:we.selectChildren,filter:ld,merge:ud,selection:wd,transition:Td,call:we.call,nodes:we.nodes,node:we.node,size:we.size,empty:we.empty,each:we.each,on:hd,attr:qu,attrTween:Qu,style:Cd,styleTween:kd,text:Id,textTween:Pd,remove:pd,tween:Bu,delay:td,duration:rd,ease:id,easeVarying:cd,end:Dd,[Symbol.iterator]:we[Symbol.iterator]};function Rd(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var Hd={time:null,delay:0,duration:250,ease:Rd};function Ld(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function Bd(e){var t,n;e instanceof Ne?(t=e._id,e=e._name):(t=vs(),(n=Hd).time=oo(),e=e==null?null:e+"");for(var o=this._groups,r=o.length,s=0;s<r;++s)for(var i=o[s],a=i.length,l,u=0;u<a;++u)(l=i[u])&&nn(l,e,t,u,i,n||Ld(l,t));return new Ne(o,this._parents,e,t)}Nt.prototype.interrupt=Ru;Nt.prototype.transition=Bd;const Pt=e=>()=>e;function Fd(e,{sourceEvent:t,target:n,transform:o,dispatch:r}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:o,enumerable:!0,configurable:!0},_:{value:r}})}function be(e,t,n){this.k=e,this.x=t,this.y=n}be.prototype={constructor:be,scale:function(e){return e===1?this:new be(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new be(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var on=new be(1,0,0);Ns.prototype=be.prototype;function Ns(e){for(;!e.__zoom;)if(!(e=e.parentNode))return on;return e.__zoom}function Nn(e){e.stopImmediatePropagation()}function st(e){e.preventDefault(),e.stopImmediatePropagation()}function Od(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Vd(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function Oo(){return this.__zoom||on}function Yd(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function Xd(){return navigator.maxTouchPoints||"ontouchstart"in this}function Wd(e,t,n){var o=e.invertX(t[0][0])-n[0][0],r=e.invertX(t[1][0])-n[1][0],s=e.invertY(t[0][1])-n[0][1],i=e.invertY(t[1][1])-n[1][1];return e.translate(r>o?(o+r)/2:Math.min(0,o)||Math.max(0,r),i>s?(s+i)/2:Math.min(0,s)||Math.max(0,i))}function _s(){var e=Od,t=Vd,n=Wd,o=Yd,r=Xd,s=[0,1/0],i=[[-1/0,-1/0],[1/0,1/0]],a=250,l=Au,u=Jt("start","zoom","end"),d,f,c,h=500,p=150,y=0,v=10;function b(x){x.property("__zoom",Oo).on("wheel.zoom",D,{passive:!1}).on("mousedown.zoom",j).on("dblclick.zoom",T).filter(r).on("touchstart.zoom",L).on("touchmove.zoom",H).on("touchend.zoom touchcancel.zoom",R).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}b.transform=function(x,k,C,S){var I=x.selection?x.selection():x;I.property("__zoom",Oo),x!==I?A(x,k,C,S):I.interrupt().each(function(){$(this,arguments).event(S).start().zoom(null,typeof k=="function"?k.apply(this,arguments):k).end()})},b.scaleBy=function(x,k,C,S){b.scaleTo(x,function(){var I=this.__zoom.k,E=typeof k=="function"?k.apply(this,arguments):k;return I*E},C,S)},b.scaleTo=function(x,k,C,S){b.transform(x,function(){var I=t.apply(this,arguments),E=this.__zoom,P=C==null?w(I):typeof C=="function"?C.apply(this,arguments):C,B=E.invert(P),V=typeof k=="function"?k.apply(this,arguments):k;return n(m(_(E,V),P,B),I,i)},C,S)},b.translateBy=function(x,k,C,S){b.transform(x,function(){return n(this.__zoom.translate(typeof k=="function"?k.apply(this,arguments):k,typeof C=="function"?C.apply(this,arguments):C),t.apply(this,arguments),i)},null,S)},b.translateTo=function(x,k,C,S,I){b.transform(x,function(){var E=t.apply(this,arguments),P=this.__zoom,B=S==null?w(E):typeof S=="function"?S.apply(this,arguments):S;return n(on.translate(B[0],B[1]).scale(P.k).translate(typeof k=="function"?-k.apply(this,arguments):-k,typeof C=="function"?-C.apply(this,arguments):-C),E,i)},S,I)};function _(x,k){return k=Math.max(s[0],Math.min(s[1],k)),k===x.k?x:new be(k,x.x,x.y)}function m(x,k,C){var S=k[0]-C[0]*x.k,I=k[1]-C[1]*x.k;return S===x.x&&I===x.y?x:new be(x.k,S,I)}function w(x){return[(+x[0][0]+ +x[1][0])/2,(+x[0][1]+ +x[1][1])/2]}function A(x,k,C,S){x.on("start.zoom",function(){$(this,arguments).event(S).start()}).on("interrupt.zoom end.zoom",function(){$(this,arguments).event(S).end()}).tween("zoom",function(){var I=this,E=arguments,P=$(I,E).event(S),B=t.apply(I,E),V=C==null?w(B):typeof C=="function"?C.apply(I,E):C,X=Math.max(B[1][0]-B[0][0],B[1][1]-B[0][1]),W=I.__zoom,z=typeof k=="function"?k.apply(I,E):k,O=l(W.invert(V).concat(X/W.k),z.invert(V).concat(X/z.k));return function(F){if(F===1)F=z;else{var Y=O(F),U=X/Y[2];F=new be(U,V[0]-Y[0]*U,V[1]-Y[1]*U)}P.zoom(null,F)}})}function $(x,k,C){return!C&&x.__zooming||new M(x,k)}function M(x,k){this.that=x,this.args=k,this.active=0,this.sourceEvent=null,this.extent=t.apply(x,k),this.taps=0}M.prototype={event:function(x){return x&&(this.sourceEvent=x),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(x,k){return this.mouse&&x!=="mouse"&&(this.mouse[1]=k.invert(this.mouse[0])),this.touch0&&x!=="touch"&&(this.touch0[1]=k.invert(this.touch0[0])),this.touch1&&x!=="touch"&&(this.touch1[1]=k.invert(this.touch1[0])),this.that.__zoom=k,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(x){var k=ce(this.that).datum();u.call(x,this.that,new Fd(x,{sourceEvent:this.sourceEvent,target:b,transform:this.that.__zoom,dispatch:u}),k)}};function D(x,...k){if(!e.apply(this,arguments))return;var C=$(this,k).event(x),S=this.__zoom,I=Math.max(s[0],Math.min(s[1],S.k*Math.pow(2,o.apply(this,arguments)))),E=de(x);if(C.wheel)(C.mouse[0][0]!==E[0]||C.mouse[0][1]!==E[1])&&(C.mouse[1]=S.invert(C.mouse[0]=E)),clearTimeout(C.wheel);else{if(S.k===I)return;C.mouse=[E,S.invert(E)],Ft(this),C.start()}st(x),C.wheel=setTimeout(P,p),C.zoom("mouse",n(m(_(S,I),C.mouse[0],C.mouse[1]),C.extent,i));function P(){C.wheel=null,C.end()}}function j(x,...k){if(c||!e.apply(this,arguments))return;var C=x.currentTarget,S=$(this,k,!0).event(x),I=ce(x.view).on("mousemove.zoom",V,!0).on("mouseup.zoom",X,!0),E=de(x,C),P=x.clientX,B=x.clientY;is(x.view),Nn(x),S.mouse=[E,this.__zoom.invert(E)],Ft(this),S.start();function V(W){if(st(W),!S.moved){var z=W.clientX-P,O=W.clientY-B;S.moved=z*z+O*O>y}S.event(W).zoom("mouse",n(m(S.that.__zoom,S.mouse[0]=de(W,C),S.mouse[1]),S.extent,i))}function X(W){I.on("mousemove.zoom mouseup.zoom",null),as(W.view,S.moved),st(W),S.event(W).end()}}function T(x,...k){if(e.apply(this,arguments)){var C=this.__zoom,S=de(x.changedTouches?x.changedTouches[0]:x,this),I=C.invert(S),E=C.k*(x.shiftKey?.5:2),P=n(m(_(C,E),S,I),t.apply(this,k),i);st(x),a>0?ce(this).transition().duration(a).call(A,P,S,x):ce(this).call(b.transform,P,S,x)}}function L(x,...k){if(e.apply(this,arguments)){var C=x.touches,S=C.length,I=$(this,k,x.changedTouches.length===S).event(x),E,P,B,V;for(Nn(x),P=0;P<S;++P)B=C[P],V=de(B,this),V=[V,this.__zoom.invert(V),B.identifier],I.touch0?!I.touch1&&I.touch0[2]!==V[2]&&(I.touch1=V,I.taps=0):(I.touch0=V,E=!0,I.taps=1+!!d);d&&(d=clearTimeout(d)),E&&(I.taps<2&&(f=V[0],d=setTimeout(function(){d=null},h)),Ft(this),I.start())}}function H(x,...k){if(this.__zooming){var C=$(this,k).event(x),S=x.changedTouches,I=S.length,E,P,B,V;for(st(x),E=0;E<I;++E)P=S[E],B=de(P,this),C.touch0&&C.touch0[2]===P.identifier?C.touch0[0]=B:C.touch1&&C.touch1[2]===P.identifier&&(C.touch1[0]=B);if(P=C.that.__zoom,C.touch1){var X=C.touch0[0],W=C.touch0[1],z=C.touch1[0],O=C.touch1[1],F=(F=z[0]-X[0])*F+(F=z[1]-X[1])*F,Y=(Y=O[0]-W[0])*Y+(Y=O[1]-W[1])*Y;P=_(P,Math.sqrt(F/Y)),B=[(X[0]+z[0])/2,(X[1]+z[1])/2],V=[(W[0]+O[0])/2,(W[1]+O[1])/2]}else if(C.touch0)B=C.touch0[0],V=C.touch0[1];else return;C.zoom("touch",n(m(P,B,V),C.extent,i))}}function R(x,...k){if(this.__zooming){var C=$(this,k).event(x),S=x.changedTouches,I=S.length,E,P;for(Nn(x),c&&clearTimeout(c),c=setTimeout(function(){c=null},h),E=0;E<I;++E)P=S[E],C.touch0&&C.touch0[2]===P.identifier?delete C.touch0:C.touch1&&C.touch1[2]===P.identifier&&delete C.touch1;if(C.touch1&&!C.touch0&&(C.touch0=C.touch1,delete C.touch1),C.touch0)C.touch0[1]=this.__zoom.invert(C.touch0[0]);else if(C.end(),C.taps===2&&(P=de(P,this),Math.hypot(f[0]-P[0],f[1]-P[1])<v)){var B=ce(this).on("dblclick.zoom");B&&B.apply(this,arguments)}}}return b.wheelDelta=function(x){return arguments.length?(o=typeof x=="function"?x:Pt(+x),b):o},b.filter=function(x){return arguments.length?(e=typeof x=="function"?x:Pt(!!x),b):e},b.touchable=function(x){return arguments.length?(r=typeof x=="function"?x:Pt(!!x),b):r},b.extent=function(x){return arguments.length?(t=typeof x=="function"?x:Pt([[+x[0][0],+x[0][1]],[+x[1][0],+x[1][1]]]),b):t},b.scaleExtent=function(x){return arguments.length?(s[0]=+x[0],s[1]=+x[1],b):[s[0],s[1]]},b.translateExtent=function(x){return arguments.length?(i[0][0]=+x[0][0],i[1][0]=+x[1][0],i[0][1]=+x[0][1],i[1][1]=+x[1][1],b):[[i[0][0],i[0][1]],[i[1][0],i[1][1]]]},b.constrain=function(x){return arguments.length?(n=x,b):n},b.duration=function(x){return arguments.length?(a=+x,b):a},b.interpolate=function(x){return arguments.length?(l=x,b):l},b.on=function(){var x=u.on.apply(u,arguments);return x===u?b:x},b.clickDistance=function(x){return arguments.length?(y=(x=+x)*x,b):Math.sqrt(y)},b.tapDistance=function(x){return arguments.length?(v=+x,b):v},b}const xe={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,{id:t,sourceHandle:n,targetHandle:o})=>`Couldn't create edge for ${e} handle id: "${e==="source"?n:o}", edge id: ${t}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(e="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},xt=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],Cs=["Enter"," ","Escape"];var Ge;(function(e){e.Strict="strict",e.Loose="loose"})(Ge||(Ge={}));var ze;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(ze||(ze={}));var yt;(function(e){e.Partial="partial",e.Full="full"})(yt||(yt={}));const Es={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null};var ke;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(ke||(ke={}));var Gt;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(Gt||(Gt={}));var q;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(q||(q={}));const Vo={[q.Left]:q.Right,[q.Right]:q.Left,[q.Top]:q.Bottom,[q.Bottom]:q.Top};function Ss(e){return e===null?null:e?"valid":"invalid"}const ks=e=>"id"in e&&"source"in e&&"target"in e,qd=e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e),io=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e),Ct=(e,t=[0,0])=>{const{width:n,height:o}=_e(e),r=e.origin??t,s=n*r[0],i=o*r[1];return{x:e.position.x-s,y:e.position.y-i}},Gd=(e,t={nodeOrigin:[0,0],nodeLookup:void 0})=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((o,r)=>{const s=typeof r=="string";let i=!t.nodeLookup&&!s?r:void 0;t.nodeLookup&&(i=s?t.nodeLookup.get(r):io(r)?r:t.nodeLookup.get(r.id));const a=i?Ut(i,t.nodeOrigin):{x:0,y:0,x2:0,y2:0};return rn(o,a)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return sn(n)},Et=(e,t={})=>{if(e.size===0)return{x:0,y:0,width:0,height:0};let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0};return e.forEach(o=>{if(t.filter===void 0||t.filter(o)){const r=Ut(o);n=rn(n,r)}}),sn(n)},Ms=(e,t,[n,o,r]=[0,0,1],s=!1,i=!1)=>{const a={...St(t,[n,o,r]),width:t.width/r,height:t.height/r},l=[];for(const u of e.values()){const{measured:d,selectable:f=!0,hidden:c=!1}=u;if(i&&!f||c)continue;const h=d.width??u.width??u.initialWidth??null,p=d.height??u.height??u.initialHeight??null,y=wt(a,Ke(u)),v=(h??0)*(p??0),b=s&&y>0;(!u.internals.handleBounds||b||y>=v||u.dragging)&&l.push(u)}return l},Ud=(e,t)=>{const n=new Set;return e.forEach(o=>{n.add(o.id)}),t.filter(o=>n.has(o.source)||n.has(o.target))};function Kd(e,t){const n=new Map,o=t!=null&&t.nodes?new Set(t.nodes.map(r=>r.id)):null;return e.forEach(r=>{r.measured.width&&r.measured.height&&((t==null?void 0:t.includeHiddenNodes)||!r.hidden)&&(!o||o.has(r.id))&&n.set(r.id,r)}),n}async function Zd({nodes:e,width:t,height:n,panZoom:o,minZoom:r,maxZoom:s},i){if(e.size===0)return Promise.resolve(!0);const a=Kd(e,i),l=Et(a),u=ao(l,t,n,(i==null?void 0:i.minZoom)??r,(i==null?void 0:i.maxZoom)??s,(i==null?void 0:i.padding)??.1);return await o.setViewport(u,{duration:i==null?void 0:i.duration}),Promise.resolve(!0)}function As({nodeId:e,nextPosition:t,nodeLookup:n,nodeOrigin:o=[0,0],nodeExtent:r,onError:s}){const i=n.get(e),a=i.parentId?n.get(i.parentId):void 0,{x:l,y:u}=a?a.internals.positionAbsolute:{x:0,y:0},d=i.origin??o;let f=r;if(i.extent==="parent"&&!i.expandParent)if(!a)s==null||s("005",xe.error005());else{const h=a.measured.width,p=a.measured.height;h&&p&&(f=[[l,u],[l+h,u+p]])}else a&&Ze(i.extent)&&(f=[[i.extent[0][0]+l,i.extent[0][1]+u],[i.extent[1][0]+l,i.extent[1][1]+u]]);const c=Ze(f)?He(t,f,i.measured):t;return(i.measured.width===void 0||i.measured.height===void 0)&&(s==null||s("015",xe.error015())),{position:{x:c.x-l+(i.measured.width??0)*d[0],y:c.y-u+(i.measured.height??0)*d[1]},positionAbsolute:c}}async function Qd({nodesToRemove:e=[],edgesToRemove:t=[],nodes:n,edges:o,onBeforeDelete:r}){const s=new Set(e.map(c=>c.id)),i=[];for(const c of n){if(c.deletable===!1)continue;const h=s.has(c.id),p=!h&&c.parentId&&i.find(y=>y.id===c.parentId);(h||p)&&i.push(c)}const a=new Set(t.map(c=>c.id)),l=o.filter(c=>c.deletable!==!1),d=Ud(i,l);for(const c of l)a.has(c.id)&&!d.find(p=>p.id===c.id)&&d.push(c);if(!r)return{edges:d,nodes:i};const f=await r({nodes:i,edges:d});return typeof f=="boolean"?f?{edges:d,nodes:i}:{edges:[],nodes:[]}:f}const Ue=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),He=(e={x:0,y:0},t,n)=>({x:Ue(e.x,t[0][0],t[1][0]-((n==null?void 0:n.width)??0)),y:Ue(e.y,t[0][1],t[1][1]-((n==null?void 0:n.height)??0))});function Is(e,t,n){const{width:o,height:r}=_e(n),{x:s,y:i}=n.internals.positionAbsolute;return He(e,[[s,i],[s+o,i+r]],t)}const Yo=(e,t,n)=>e<t?Ue(Math.abs(e-t),1,t)/t:e>n?-Ue(Math.abs(e-n),1,t)/t:0,$s=(e,t,n=15,o=40)=>{const r=Yo(e.x,o,t.width-o)*n,s=Yo(e.y,o,t.height-o)*n;return[r,s]},rn=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),Ln=({x:e,y:t,width:n,height:o})=>({x:e,y:t,x2:e+n,y2:t+o}),sn=({x:e,y:t,x2:n,y2:o})=>({x:e,y:t,width:n-e,height:o-t}),Ke=(e,t=[0,0])=>{var r,s;const{x:n,y:o}=io(e)?e.internals.positionAbsolute:Ct(e,t);return{x:n,y:o,width:((r=e.measured)==null?void 0:r.width)??e.width??e.initialWidth??0,height:((s=e.measured)==null?void 0:s.height)??e.height??e.initialHeight??0}},Ut=(e,t=[0,0])=>{var r,s;const{x:n,y:o}=io(e)?e.internals.positionAbsolute:Ct(e,t);return{x:n,y:o,x2:n+(((r=e.measured)==null?void 0:r.width)??e.width??e.initialWidth??0),y2:o+(((s=e.measured)==null?void 0:s.height)??e.height??e.initialHeight??0)}},js=(e,t)=>sn(rn(Ln(e),Ln(t))),wt=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),o=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*o)},Xo=e=>ge(e.width)&&ge(e.height)&&ge(e.x)&&ge(e.y),ge=e=>!isNaN(e)&&isFinite(e),Jd=(e,t)=>{},an=(e,t=[1,1])=>({x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}),St=({x:e,y:t},[n,o,r],s=!1,i=[1,1])=>{const a={x:(e-n)/r,y:(t-o)/r};return s?an(a,i):a},Kt=({x:e,y:t},[n,o,r])=>({x:e*r+n,y:t*r+o});function Be(e,t){if(typeof e=="number")return Math.floor(t-t/(1+e));if(typeof e=="string"&&e.endsWith("px")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(n)}if(typeof e=="string"&&e.endsWith("%")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(t*n*.01)}return console.error(`[React Flow] The padding value "${e}" is invalid. Please provide a number or a string with a valid unit (px or %).`),0}function ef(e,t,n){if(typeof e=="string"||typeof e=="number"){const o=Be(e,n),r=Be(e,t);return{top:o,right:r,bottom:o,left:r,x:r*2,y:o*2}}if(typeof e=="object"){const o=Be(e.top??e.y??0,n),r=Be(e.bottom??e.y??0,n),s=Be(e.left??e.x??0,t),i=Be(e.right??e.x??0,t);return{top:o,right:i,bottom:r,left:s,x:s+i,y:o+r}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}function tf(e,t,n,o,r,s){const{x:i,y:a}=Kt(e,[t,n,o]),{x:l,y:u}=Kt({x:e.x+e.width,y:e.y+e.height},[t,n,o]),d=r-l,f=s-u;return{left:Math.floor(i),top:Math.floor(a),right:Math.floor(d),bottom:Math.floor(f)}}const ao=(e,t,n,o,r,s)=>{const i=ef(s,t,n),a=(t-i.x)/e.width,l=(n-i.y)/e.height,u=Math.min(a,l),d=Ue(u,o,r),f=e.x+e.width/2,c=e.y+e.height/2,h=t/2-f*d,p=n/2-c*d,y=tf(e,h,p,d,t,n),v={left:Math.min(y.left-i.left,0),top:Math.min(y.top-i.top,0),right:Math.min(y.right-i.right,0),bottom:Math.min(y.bottom-i.bottom,0)};return{x:h-v.left+v.right,y:p-v.top+v.bottom,zoom:d}},Zt=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0};function Ze(e){return e!==void 0&&e!=="parent"}function _e(e){var t,n;return{width:((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth??0,height:((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight??0}}function Ps(e){var t,n;return(((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth)!==void 0&&(((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight)!==void 0}function Ts(e,t={width:0,height:0},n,o,r){const s={...e},i=o.get(n);if(i){const a=i.origin||r;s.x+=i.internals.positionAbsolute.x-(t.width??0)*a[0],s.y+=i.internals.positionAbsolute.y-(t.height??0)*a[1]}return s}function Wo(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function ut(e,{snapGrid:t=[0,0],snapToGrid:n=!1,transform:o,containerBounds:r}){const{x:s,y:i}=ve(e),a=St({x:s-((r==null?void 0:r.left)??0),y:i-((r==null?void 0:r.top)??0)},o),{x:l,y:u}=n?an(a,t):a;return{xSnapped:l,ySnapped:u,...a}}const co=e=>({width:e.offsetWidth,height:e.offsetHeight}),Ds=e=>{var t;return((t=e==null?void 0:e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},nf=["INPUT","SELECT","TEXTAREA"];function zs(e){var o,r;const t=((r=(o=e.composedPath)==null?void 0:o.call(e))==null?void 0:r[0])||e.target;return(t==null?void 0:t.nodeType)!==1?!1:nf.includes(t.nodeName)||t.hasAttribute("contenteditable")||!!t.closest(".nokey")}const Rs=e=>"clientX"in e,ve=(e,t)=>{var s,i;const n=Rs(e),o=n?e.clientX:(s=e.touches)==null?void 0:s[0].clientX,r=n?e.clientY:(i=e.touches)==null?void 0:i[0].clientY;return{x:o-((t==null?void 0:t.left)??0),y:r-((t==null?void 0:t.top)??0)}},qo=(e,t,n,o,r)=>{const s=t.querySelectorAll(`.${e}`);return!s||!s.length?null:Array.from(s).map(i=>{const a=i.getBoundingClientRect();return{id:i.getAttribute("data-handleid"),type:e,nodeId:r,position:i.getAttribute("data-handlepos"),x:(a.left-n.left)/o,y:(a.top-n.top)/o,...co(i)}})};function Hs({sourceX:e,sourceY:t,targetX:n,targetY:o,sourceControlX:r,sourceControlY:s,targetControlX:i,targetControlY:a}){const l=e*.125+r*.375+i*.375+n*.125,u=t*.125+s*.375+a*.375+o*.125,d=Math.abs(l-e),f=Math.abs(u-t);return[l,u,d,f]}function Tt(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function Go({pos:e,x1:t,y1:n,x2:o,y2:r,c:s}){switch(e){case q.Left:return[t-Tt(t-o,s),n];case q.Right:return[t+Tt(o-t,s),n];case q.Top:return[t,n-Tt(n-r,s)];case q.Bottom:return[t,n+Tt(r-n,s)]}}function Ls({sourceX:e,sourceY:t,sourcePosition:n=q.Bottom,targetX:o,targetY:r,targetPosition:s=q.Top,curvature:i=.25}){const[a,l]=Go({pos:n,x1:e,y1:t,x2:o,y2:r,c:i}),[u,d]=Go({pos:s,x1:o,y1:r,x2:e,y2:t,c:i}),[f,c,h,p]=Hs({sourceX:e,sourceY:t,targetX:o,targetY:r,sourceControlX:a,sourceControlY:l,targetControlX:u,targetControlY:d});return[`M${e},${t} C${a},${l} ${u},${d} ${o},${r}`,f,c,h,p]}function Bs({sourceX:e,sourceY:t,targetX:n,targetY:o}){const r=Math.abs(n-e)/2,s=n<e?n+r:n-r,i=Math.abs(o-t)/2,a=o<t?o+i:o-i;return[s,a,r,i]}function of({sourceNode:e,targetNode:t,selected:n=!1,zIndex:o=0,elevateOnSelect:r=!1}){if(!r)return o;const s=n||t.selected||e.selected,i=Math.max(e.internals.z||0,t.internals.z||0,1e3);return o+(s?i:0)}function rf({sourceNode:e,targetNode:t,width:n,height:o,transform:r}){const s=rn(Ut(e),Ut(t));s.x===s.x2&&(s.x2+=1),s.y===s.y2&&(s.y2+=1);const i={x:-r[0]/r[2],y:-r[1]/r[2],width:n/r[2],height:o/r[2]};return wt(i,sn(s))>0}const sf=({source:e,sourceHandle:t,target:n,targetHandle:o})=>`xy-edge__${e}${t||""}-${n}${o||""}`,af=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),Fs=(e,t)=>{if(!e.source||!e.target)return t;let n;return ks(e)?n={...e}:n={...e,id:sf(e)},af(n,t)?t:(n.sourceHandle===null&&delete n.sourceHandle,n.targetHandle===null&&delete n.targetHandle,t.concat(n))};function Os({sourceX:e,sourceY:t,targetX:n,targetY:o}){const[r,s,i,a]=Bs({sourceX:e,sourceY:t,targetX:n,targetY:o});return[`M ${e},${t}L ${n},${o}`,r,s,i,a]}const Uo={[q.Left]:{x:-1,y:0},[q.Right]:{x:1,y:0},[q.Top]:{x:0,y:-1},[q.Bottom]:{x:0,y:1}},cf=({source:e,sourcePosition:t=q.Bottom,target:n})=>t===q.Left||t===q.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},Ko=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function lf({source:e,sourcePosition:t=q.Bottom,target:n,targetPosition:o=q.Top,center:r,offset:s}){const i=Uo[t],a=Uo[o],l={x:e.x+i.x*s,y:e.y+i.y*s},u={x:n.x+a.x*s,y:n.y+a.y*s},d=cf({source:l,sourcePosition:t,target:u}),f=d.x!==0?"x":"y",c=d[f];let h=[],p,y;const v={x:0,y:0},b={x:0,y:0},[_,m,w,A]=Bs({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(i[f]*a[f]===-1){p=r.x??_,y=r.y??m;const M=[{x:p,y:l.y},{x:p,y:u.y}],D=[{x:l.x,y},{x:u.x,y}];i[f]===c?h=f==="x"?M:D:h=f==="x"?D:M}else{const M=[{x:l.x,y:u.y}],D=[{x:u.x,y:l.y}];if(f==="x"?h=i.x===c?D:M:h=i.y===c?M:D,t===o){const R=Math.abs(e[f]-n[f]);if(R<=s){const x=Math.min(s-1,s-R);i[f]===c?v[f]=(l[f]>e[f]?-1:1)*x:b[f]=(u[f]>n[f]?-1:1)*x}}if(t!==o){const R=f==="x"?"y":"x",x=i[f]===a[R],k=l[R]>u[R],C=l[R]<u[R];(i[f]===1&&(!x&&k||x&&C)||i[f]!==1&&(!x&&C||x&&k))&&(h=f==="x"?M:D)}const j={x:l.x+v.x,y:l.y+v.y},T={x:u.x+b.x,y:u.y+b.y},L=Math.max(Math.abs(j.x-h[0].x),Math.abs(T.x-h[0].x)),H=Math.max(Math.abs(j.y-h[0].y),Math.abs(T.y-h[0].y));L>=H?(p=(j.x+T.x)/2,y=h[0].y):(p=h[0].x,y=(j.y+T.y)/2)}return[[e,{x:l.x+v.x,y:l.y+v.y},...h,{x:u.x+b.x,y:u.y+b.y},n],p,y,w,A]}function uf(e,t,n,o){const r=Math.min(Ko(e,t)/2,Ko(t,n)/2,o),{x:s,y:i}=t;if(e.x===s&&s===n.x||e.y===i&&i===n.y)return`L${s} ${i}`;if(e.y===i){const u=e.x<n.x?-1:1,d=e.y<n.y?1:-1;return`L ${s+r*u},${i}Q ${s},${i} ${s},${i+r*d}`}const a=e.x<n.x?1:-1,l=e.y<n.y?-1:1;return`L ${s},${i+r*l}Q ${s},${i} ${s+r*a},${i}`}function Bn({sourceX:e,sourceY:t,sourcePosition:n=q.Bottom,targetX:o,targetY:r,targetPosition:s=q.Top,borderRadius:i=5,centerX:a,centerY:l,offset:u=20}){const[d,f,c,h,p]=lf({source:{x:e,y:t},sourcePosition:n,target:{x:o,y:r},targetPosition:s,center:{x:a,y:l},offset:u});return[d.reduce((v,b,_)=>{let m="";return _>0&&_<d.length-1?m=uf(d[_-1],b,d[_+1],i):m=`${_===0?"M":"L"}${b.x} ${b.y}`,v+=m,v},""),f,c,h,p]}function Zo(e){var t;return e&&!!(e.internals.handleBounds||(t=e.handles)!=null&&t.length)&&!!(e.measured.width||e.width||e.initialWidth)}function df(e){var f;const{sourceNode:t,targetNode:n}=e;if(!Zo(t)||!Zo(n))return null;const o=t.internals.handleBounds||Qo(t.handles),r=n.internals.handleBounds||Qo(n.handles),s=Jo((o==null?void 0:o.source)??[],e.sourceHandle),i=Jo(e.connectionMode===Ge.Strict?(r==null?void 0:r.target)??[]:((r==null?void 0:r.target)??[]).concat((r==null?void 0:r.source)??[]),e.targetHandle);if(!s||!i)return(f=e.onError)==null||f.call(e,"008",xe.error008(s?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;const a=(s==null?void 0:s.position)||q.Bottom,l=(i==null?void 0:i.position)||q.Top,u=bt(t,s,a),d=bt(n,i,l);return{sourceX:u.x,sourceY:u.y,targetX:d.x,targetY:d.y,sourcePosition:a,targetPosition:l}}function Qo(e){if(!e)return null;const t=[],n=[];for(const o of e)o.width=o.width??1,o.height=o.height??1,o.type==="source"?t.push(o):o.type==="target"&&n.push(o);return{source:t,target:n}}function bt(e,t,n=q.Left,o=!1){const r=((t==null?void 0:t.x)??0)+e.internals.positionAbsolute.x,s=((t==null?void 0:t.y)??0)+e.internals.positionAbsolute.y,{width:i,height:a}=t??_e(e);if(o)return{x:r+i/2,y:s+a/2};switch((t==null?void 0:t.position)??n){case q.Top:return{x:r+i/2,y:s};case q.Right:return{x:r+i,y:s+a/2};case q.Bottom:return{x:r+i/2,y:s+a};case q.Left:return{x:r,y:s+a/2}}}function Jo(e,t){return e&&(t?e.find(n=>n.id===t):e[0])||null}function Fn(e,t){return e?typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(o=>`${o}=${e[o]}`).join("&")}`:""}function ff(e,{id:t,defaultColor:n,defaultMarkerStart:o,defaultMarkerEnd:r}){const s=new Set;return e.reduce((i,a)=>([a.markerStart||o,a.markerEnd||r].forEach(l=>{if(l&&typeof l=="object"){const u=Fn(l,t);s.has(u)||(i.push({id:u,color:l.color||n,...l}),s.add(u))}}),i),[]).sort((i,a)=>i.id.localeCompare(a.id))}const lo={nodeOrigin:[0,0],nodeExtent:xt,elevateNodesOnSelect:!0,defaults:{}},hf={...lo,checkEquality:!0};function uo(e,t){const n={...e};for(const o in t)t[o]!==void 0&&(n[o]=t[o]);return n}function gf(e,t,n){const o=uo(lo,n);for(const r of e.values())if(r.parentId)fo(r,e,t,o);else{const s=Ct(r,o.nodeOrigin),i=Ze(r.extent)?r.extent:o.nodeExtent,a=He(s,i,_e(r));r.internals.positionAbsolute=a}}function On(e,t,n,o){var l,u;const r=uo(hf,o);let s=!0;const i=new Map(t),a=r!=null&&r.elevateNodesOnSelect?1e3:0;t.clear(),n.clear();for(const d of e){let f=i.get(d.id);if(r.checkEquality&&d===(f==null?void 0:f.internals.userNode))t.set(d.id,f);else{const c=Ct(d,r.nodeOrigin),h=Ze(d.extent)?d.extent:r.nodeExtent,p=He(c,h,_e(d));f={...r.defaults,...d,measured:{width:(l=d.measured)==null?void 0:l.width,height:(u=d.measured)==null?void 0:u.height},internals:{positionAbsolute:p,handleBounds:d.measured?f==null?void 0:f.internals.handleBounds:void 0,z:Vs(d,a),userNode:d}},t.set(d.id,f)}(!f.measured||!f.measured.width||!f.measured.height)&&!f.hidden&&(s=!1),d.parentId&&fo(f,t,n,o)}return s}function pf(e,t){if(!e.parentId)return;const n=t.get(e.parentId);n?n.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}function fo(e,t,n,o){const{elevateNodesOnSelect:r,nodeOrigin:s,nodeExtent:i}=uo(lo,o),a=e.parentId,l=t.get(a);if(!l){console.warn(`Parent node ${a} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}pf(e,n);const u=r?1e3:0,{x:d,y:f,z:c}=mf(e,l,s,i,u),{positionAbsolute:h}=e.internals,p=d!==h.x||f!==h.y;(p||c!==e.internals.z)&&t.set(e.id,{...e,internals:{...e.internals,positionAbsolute:p?{x:d,y:f}:h,z:c}})}function Vs(e,t){return(ge(e.zIndex)?e.zIndex:0)+(e.selected?t:0)}function mf(e,t,n,o,r){const{x:s,y:i}=t.internals.positionAbsolute,a=_e(e),l=Ct(e,n),u=Ze(e.extent)?He(l,e.extent,a):l;let d=He({x:s+u.x,y:i+u.y},o,a);e.extent==="parent"&&(d=Is(d,a,t));const f=Vs(e,r),c=t.internals.z??0;return{x:d.x,y:d.y,z:c>f?c:f}}function ho(e,t,n,o=[0,0]){var i;const r=[],s=new Map;for(const a of e){const l=t.get(a.parentId);if(!l)continue;const u=((i=s.get(a.parentId))==null?void 0:i.expandedRect)??Ke(l),d=js(u,a.rect);s.set(a.parentId,{expandedRect:d,parent:l})}return s.size>0&&s.forEach(({expandedRect:a,parent:l},u)=>{var m;const d=l.internals.positionAbsolute,f=_e(l),c=l.origin??o,h=a.x<d.x?Math.round(Math.abs(d.x-a.x)):0,p=a.y<d.y?Math.round(Math.abs(d.y-a.y)):0,y=Math.max(f.width,Math.round(a.width)),v=Math.max(f.height,Math.round(a.height)),b=(y-f.width)*c[0],_=(v-f.height)*c[1];(h>0||p>0||b||_)&&(r.push({id:u,type:"position",position:{x:l.position.x-h+b,y:l.position.y-p+_}}),(m=n.get(u))==null||m.forEach(w=>{e.some(A=>A.id===w.id)||r.push({id:w.id,type:"position",position:{x:w.position.x+h,y:w.position.y+p}})})),(f.width<a.width||f.height<a.height||h||p)&&r.push({id:u,type:"dimensions",setAttributes:!0,dimensions:{width:y+(h?c[0]*h-b:0),height:v+(p?c[1]*p-_:0)}})}),r}function xf(e,t,n,o,r,s){const i=o==null?void 0:o.querySelector(".xyflow__viewport");let a=!1;if(!i)return{changes:[],updatedInternals:a};const l=[],u=window.getComputedStyle(i),{m22:d}=new window.DOMMatrixReadOnly(u.transform),f=[];for(const c of e.values()){const h=t.get(c.id);if(!h)continue;if(h.hidden){t.set(h.id,{...h,internals:{...h.internals,handleBounds:void 0}}),a=!0;continue}const p=co(c.nodeElement),y=h.measured.width!==p.width||h.measured.height!==p.height;if(!!(p.width&&p.height&&(y||!h.internals.handleBounds||c.force))){const b=c.nodeElement.getBoundingClientRect(),_=Ze(h.extent)?h.extent:s;let{positionAbsolute:m}=h.internals;h.parentId&&h.extent==="parent"?m=Is(m,p,t.get(h.parentId)):_&&(m=He(m,_,p));const w={...h,measured:p,internals:{...h.internals,positionAbsolute:m,handleBounds:{source:qo("source",c.nodeElement,b,d,h.id),target:qo("target",c.nodeElement,b,d,h.id)}}};t.set(h.id,w),h.parentId&&fo(w,t,n,{nodeOrigin:r}),a=!0,y&&(l.push({id:h.id,type:"dimensions",dimensions:p}),h.expandParent&&h.parentId&&f.push({id:h.id,parentId:h.parentId,rect:Ke(w,r)}))}}if(f.length>0){const c=ho(f,t,n,r);l.push(...c)}return{changes:l,updatedInternals:a}}async function yf({delta:e,panZoom:t,transform:n,translateExtent:o,width:r,height:s}){if(!t||!e.x&&!e.y)return Promise.resolve(!1);const i=await t.setViewportConstrained({x:n[0]+e.x,y:n[1]+e.y,zoom:n[2]},[[0,0],[r,s]],o),a=!!i&&(i.x!==n[0]||i.y!==n[1]||i.k!==n[2]);return Promise.resolve(a)}function er(e,t,n,o,r,s){let i=r;const a=o.get(i)||new Map;o.set(i,a.set(n,t)),i=`${r}-${e}`;const l=o.get(i)||new Map;if(o.set(i,l.set(n,t)),s){i=`${r}-${e}-${s}`;const u=o.get(i)||new Map;o.set(i,u.set(n,t))}}function Ys(e,t,n){e.clear(),t.clear();for(const o of n){const{source:r,target:s,sourceHandle:i=null,targetHandle:a=null}=o,l={edgeId:o.id,source:r,target:s,sourceHandle:i,targetHandle:a},u=`${r}-${i}--${s}-${a}`,d=`${s}-${a}--${r}-${i}`;er("source",l,d,e,r,i),er("target",l,u,e,s,a),t.set(o.id,o)}}function Xs(e,t){if(!e.parentId)return!1;const n=t.get(e.parentId);return n?n.selected?!0:Xs(n,t):!1}function tr(e,t,n){var r;let o=e;do{if((r=o==null?void 0:o.matches)!=null&&r.call(o,t))return!0;if(o===n)return!1;o=o==null?void 0:o.parentElement}while(o);return!1}function wf(e,t,n,o){const r=new Map;for(const[s,i]of e)if((i.selected||i.id===o)&&(!i.parentId||!Xs(i,e))&&(i.draggable||t&&typeof i.draggable>"u")){const a=e.get(s);a&&r.set(s,{id:s,position:a.position||{x:0,y:0},distance:{x:n.x-a.internals.positionAbsolute.x,y:n.y-a.internals.positionAbsolute.y},extent:a.extent,parentId:a.parentId,origin:a.origin,expandParent:a.expandParent,internals:{positionAbsolute:a.internals.positionAbsolute||{x:0,y:0}},measured:{width:a.measured.width??0,height:a.measured.height??0}})}return r}function _n({nodeId:e,dragItems:t,nodeLookup:n,dragging:o=!0}){var i,a,l;const r=[];for(const[u,d]of t){const f=(i=n.get(u))==null?void 0:i.internals.userNode;f&&r.push({...f,position:d.position,dragging:o})}if(!e)return[r[0],r];const s=(a=n.get(e))==null?void 0:a.internals.userNode;return[s?{...s,position:((l=t.get(e))==null?void 0:l.position)||s.position,dragging:o}:r[0],r]}function bf({onNodeMouseDown:e,getStoreItems:t,onDragStart:n,onDrag:o,onDragStop:r}){let s={x:null,y:null},i=0,a=new Map,l=!1,u={x:0,y:0},d=null,f=!1,c=null,h=!1;function p({noDragClassName:v,handleSelector:b,domNode:_,isSelectable:m,nodeId:w,nodeClickDistance:A=0}){c=ce(_);function $({x:T,y:L},H){const{nodeLookup:R,nodeExtent:x,snapGrid:k,snapToGrid:C,nodeOrigin:S,onNodeDrag:I,onSelectionDrag:E,onError:P,updateNodePositions:B}=t();s={x:T,y:L};let V=!1,X={x:0,y:0,x2:0,y2:0};if(a.size>1&&x){const W=Et(a);X=Ln(W)}for(const[W,z]of a){if(!R.has(W))continue;let O={x:T-z.distance.x,y:L-z.distance.y};C&&(O=an(O,k));let F=[[x[0][0],x[0][1]],[x[1][0],x[1][1]]];if(a.size>1&&x&&!z.extent){const{positionAbsolute:J}=z.internals,K=J.x-X.x+x[0][0],G=J.x+z.measured.width-X.x2+x[1][0],ee=J.y-X.y+x[0][1],Q=J.y+z.measured.height-X.y2+x[1][1];F=[[K,ee],[G,Q]]}const{position:Y,positionAbsolute:U}=As({nodeId:W,nextPosition:O,nodeLookup:R,nodeExtent:F,nodeOrigin:S,onError:P});V=V||z.position.x!==Y.x||z.position.y!==Y.y,z.position=Y,z.internals.positionAbsolute=U}if(V&&(B(a,!0),H&&(o||I||!w&&E))){const[W,z]=_n({nodeId:w,dragItems:a,nodeLookup:R});o==null||o(H,a,W,z),I==null||I(H,W,z),w||E==null||E(H,z)}}async function M(){if(!d)return;const{transform:T,panBy:L,autoPanSpeed:H,autoPanOnNodeDrag:R}=t();if(!R){l=!1,cancelAnimationFrame(i);return}const[x,k]=$s(u,d,H);(x!==0||k!==0)&&(s.x=(s.x??0)-x/T[2],s.y=(s.y??0)-k/T[2],await L({x,y:k})&&$(s,null)),i=requestAnimationFrame(M)}function D(T){var V;const{nodeLookup:L,multiSelectionActive:H,nodesDraggable:R,transform:x,snapGrid:k,snapToGrid:C,selectNodesOnDrag:S,onNodeDragStart:I,onSelectionDragStart:E,unselectNodesAndEdges:P}=t();f=!0,(!S||!m)&&!H&&w&&((V=L.get(w))!=null&&V.selected||P()),m&&S&&w&&(e==null||e(w));const B=ut(T.sourceEvent,{transform:x,snapGrid:k,snapToGrid:C,containerBounds:d});if(s=B,a=wf(L,R,B,w),a.size>0&&(n||I||!w&&E)){const[X,W]=_n({nodeId:w,dragItems:a,nodeLookup:L});n==null||n(T.sourceEvent,a,X,W),I==null||I(T.sourceEvent,X,W),w||E==null||E(T.sourceEvent,W)}}const j=cs().clickDistance(A).on("start",T=>{const{domNode:L,nodeDragThreshold:H,transform:R,snapGrid:x,snapToGrid:k}=t();d=(L==null?void 0:L.getBoundingClientRect())||null,h=!1,H===0&&D(T),s=ut(T.sourceEvent,{transform:R,snapGrid:x,snapToGrid:k,containerBounds:d}),u=ve(T.sourceEvent,d)}).on("drag",T=>{const{autoPanOnNodeDrag:L,transform:H,snapGrid:R,snapToGrid:x,nodeDragThreshold:k,nodeLookup:C}=t(),S=ut(T.sourceEvent,{transform:H,snapGrid:R,snapToGrid:x,containerBounds:d});if((T.sourceEvent.type==="touchmove"&&T.sourceEvent.touches.length>1||w&&!C.has(w))&&(h=!0),!h){if(!l&&L&&f&&(l=!0,M()),!f){const I=S.xSnapped-(s.x??0),E=S.ySnapped-(s.y??0);Math.sqrt(I*I+E*E)>k&&D(T)}(s.x!==S.xSnapped||s.y!==S.ySnapped)&&a&&f&&(u=ve(T.sourceEvent,d),$(S,T.sourceEvent))}}).on("end",T=>{if(!(!f||h)&&(l=!1,f=!1,cancelAnimationFrame(i),a.size>0)){const{nodeLookup:L,updateNodePositions:H,onNodeDragStop:R,onSelectionDragStop:x}=t();if(H(a,!1),r||R||!w&&x){const[k,C]=_n({nodeId:w,dragItems:a,nodeLookup:L,dragging:!1});r==null||r(T.sourceEvent,a,k,C),R==null||R(T.sourceEvent,k,C),w||x==null||x(T.sourceEvent,C)}}}).filter(T=>{const L=T.target;return!T.button&&(!v||!tr(L,`.${v}`,_))&&(!b||tr(L,b,_))});c.call(j)}function y(){c==null||c.on(".drag",null)}return{update:p,destroy:y}}function vf(e,t,n){const o=[],r={x:e.x-n,y:e.y-n,width:n*2,height:n*2};for(const s of t.values())wt(r,Ke(s))>0&&o.push(s);return o}const Nf=250;function _f(e,t,n,o){var a,l;let r=[],s=1/0;const i=vf(e,n,t+Nf);for(const u of i){const d=[...((a=u.internals.handleBounds)==null?void 0:a.source)??[],...((l=u.internals.handleBounds)==null?void 0:l.target)??[]];for(const f of d){if(o.nodeId===f.nodeId&&o.type===f.type&&o.id===f.id)continue;const{x:c,y:h}=bt(u,f,f.position,!0),p=Math.sqrt(Math.pow(c-e.x,2)+Math.pow(h-e.y,2));p>t||(p<s?(r=[{...f,x:c,y:h}],s=p):p===s&&r.push({...f,x:c,y:h}))}}if(!r.length)return null;if(r.length>1){const u=o.type==="source"?"target":"source";return r.find(d=>d.type===u)??r[0]}return r[0]}function Ws(e,t,n,o,r,s=!1){var u,d,f;const i=o.get(e);if(!i)return null;const a=r==="strict"?(u=i.internals.handleBounds)==null?void 0:u[t]:[...((d=i.internals.handleBounds)==null?void 0:d.source)??[],...((f=i.internals.handleBounds)==null?void 0:f.target)??[]],l=(n?a==null?void 0:a.find(c=>c.id===n):a==null?void 0:a[0])??null;return l&&s?{...l,...bt(i,l,l.position,!0)}:l}function qs(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function Cf(e,t){let n=null;return t?n=!0:e&&!t&&(n=!1),n}const Gs=()=>!0;function Ef(e,{connectionMode:t,connectionRadius:n,handleId:o,nodeId:r,edgeUpdaterType:s,isTarget:i,domNode:a,nodeLookup:l,lib:u,autoPanOnConnect:d,flowId:f,panBy:c,cancelConnection:h,onConnectStart:p,onConnect:y,onConnectEnd:v,isValidConnection:b=Gs,onReconnectEnd:_,updateConnection:m,getTransform:w,getFromHandle:A,autoPanSpeed:$}){const M=Ds(e.target);let D=0,j;const{x:T,y:L}=ve(e),H=M==null?void 0:M.elementFromPoint(T,L),R=qs(s,H),x=a==null?void 0:a.getBoundingClientRect();if(!x||!R)return;const k=Ws(r,R,o,l,t);if(!k)return;let C=ve(e,x),S=!1,I=null,E=!1,P=null;function B(){if(!d||!x)return;const[U,J]=$s(C,x,$);c({x:U,y:J}),D=requestAnimationFrame(B)}const V={...k,nodeId:r,type:R,position:k.position},X=l.get(r),z={inProgress:!0,isValid:null,from:bt(X,V,q.Left,!0),fromHandle:V,fromPosition:V.position,fromNode:X,to:C,toHandle:null,toPosition:Vo[V.position],toNode:null};m(z);let O=z;p==null||p(e,{nodeId:r,handleId:o,handleType:R});function F(U){if(!A()||!V){Y(U);return}const J=w();C=ve(U,x),j=_f(St(C,J,!1,[1,1]),n,l,V),S||(B(),S=!0);const K=Us(U,{handle:j,connectionMode:t,fromNodeId:r,fromHandleId:o,fromType:i?"target":"source",isValidConnection:b,doc:M,lib:u,flowId:f,nodeLookup:l});P=K.handleDomNode,I=K.connection,E=Cf(!!j,K.isValid);const G={...O,isValid:E,to:j&&E?Kt({x:j.x,y:j.y},J):C,toHandle:K.toHandle,toPosition:E&&K.toHandle?K.toHandle.position:Vo[V.position],toNode:K.toHandle?l.get(K.toHandle.nodeId):null};E&&j&&O.toHandle&&G.toHandle&&O.toHandle.type===G.toHandle.type&&O.toHandle.nodeId===G.toHandle.nodeId&&O.toHandle.id===G.toHandle.id&&O.to.x===G.to.x&&O.to.y===G.to.y||(m(G),O=G)}function Y(U){(j||P)&&I&&E&&(y==null||y(I));const{inProgress:J,...K}=O,G={...K,toPosition:O.toHandle?O.toPosition:null};v==null||v(U,G),s&&(_==null||_(U,G)),h(),cancelAnimationFrame(D),S=!1,E=!1,I=null,P=null,M.removeEventListener("mousemove",F),M.removeEventListener("mouseup",Y),M.removeEventListener("touchmove",F),M.removeEventListener("touchend",Y)}M.addEventListener("mousemove",F),M.addEventListener("mouseup",Y),M.addEventListener("touchmove",F),M.addEventListener("touchend",Y)}function Us(e,{handle:t,connectionMode:n,fromNodeId:o,fromHandleId:r,fromType:s,doc:i,lib:a,flowId:l,isValidConnection:u=Gs,nodeLookup:d}){const f=s==="target",c=t?i.querySelector(`.${a}-flow__handle[data-id="${l}-${t==null?void 0:t.nodeId}-${t==null?void 0:t.id}-${t==null?void 0:t.type}"]`):null,{x:h,y:p}=ve(e),y=i.elementFromPoint(h,p),v=y!=null&&y.classList.contains(`${a}-flow__handle`)?y:c,b={handleDomNode:v,isValid:!1,connection:null,toHandle:null};if(v){const _=qs(void 0,v),m=v.getAttribute("data-nodeid"),w=v.getAttribute("data-handleid"),A=v.classList.contains("connectable"),$=v.classList.contains("connectableend");if(!m||!_)return b;const M={source:f?m:o,sourceHandle:f?w:r,target:f?o:m,targetHandle:f?r:w};b.connection=M;const j=A&&$&&(n===Ge.Strict?f&&_==="source"||!f&&_==="target":m!==o||w!==r);b.isValid=j&&u(M),b.toHandle=Ws(m,_,w,d,n,!1)}return b}const Vn={onPointerDown:Ef,isValid:Us};function Sf({domNode:e,panZoom:t,getTransform:n,getViewScale:o}){const r=ce(e);function s({translateExtent:a,width:l,height:u,zoomStep:d=10,pannable:f=!0,zoomable:c=!0,inversePan:h=!1}){const p=m=>{const w=n();if(m.sourceEvent.type!=="wheel"||!t)return;const A=-m.sourceEvent.deltaY*(m.sourceEvent.deltaMode===1?.05:m.sourceEvent.deltaMode?1:.002)*d,$=w[2]*Math.pow(2,A);t.scaleTo($)};let y=[0,0];const v=m=>{(m.sourceEvent.type==="mousedown"||m.sourceEvent.type==="touchstart")&&(y=[m.sourceEvent.clientX??m.sourceEvent.touches[0].clientX,m.sourceEvent.clientY??m.sourceEvent.touches[0].clientY])},b=m=>{const w=n();if(m.sourceEvent.type!=="mousemove"&&m.sourceEvent.type!=="touchmove"||!t)return;const A=[m.sourceEvent.clientX??m.sourceEvent.touches[0].clientX,m.sourceEvent.clientY??m.sourceEvent.touches[0].clientY],$=[A[0]-y[0],A[1]-y[1]];y=A;const M=o()*Math.max(w[2],Math.log(w[2]))*(h?-1:1),D={x:w[0]-$[0]*M,y:w[1]-$[1]*M},j=[[0,0],[l,u]];t.setViewportConstrained({x:D.x,y:D.y,zoom:w[2]},j,a)},_=_s().on("start",v).on("zoom",f?b:null).on("zoom.wheel",c?p:null);r.call(_,{})}function i(){r.on("zoom",null)}return{update:s,destroy:i,pointer:de}}const kf=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,cn=e=>({x:e.x,y:e.y,zoom:e.k}),Cn=({x:e,y:t,zoom:n})=>on.translate(e,t).scale(n),Oe=(e,t)=>e.target.closest(`.${t}`),Ks=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),En=(e,t=0,n=()=>{})=>{const o=typeof t=="number"&&t>0;return o||n(),o?e.transition().duration(t).on("end",n):e},Zs=e=>{const t=e.ctrlKey&&Zt()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t};function Mf({zoomPanValues:e,noWheelClassName:t,d3Selection:n,d3Zoom:o,panOnScrollMode:r,panOnScrollSpeed:s,zoomOnPinch:i,onPanZoomStart:a,onPanZoom:l,onPanZoomEnd:u}){return d=>{if(Oe(d,t))return!1;d.preventDefault(),d.stopImmediatePropagation();const f=n.property("__zoom").k||1;if(d.ctrlKey&&i){const v=de(d),b=Zs(d),_=f*Math.pow(2,b);o.scaleTo(n,_,v,d);return}const c=d.deltaMode===1?20:1;let h=r===ze.Vertical?0:d.deltaX*c,p=r===ze.Horizontal?0:d.deltaY*c;!Zt()&&d.shiftKey&&r!==ze.Vertical&&(h=d.deltaY*c,p=0),o.translateBy(n,-(h/f)*s,-(p/f)*s,{internal:!0});const y=cn(n.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling||(e.isPanScrolling=!0,a==null||a(d,y)),e.isPanScrolling&&(l==null||l(d,y),e.panScrollTimeout=setTimeout(()=>{u==null||u(d,y),e.isPanScrolling=!1},150))}}function Af({noWheelClassName:e,preventScrolling:t,d3ZoomHandler:n}){return function(o,r){if(!t&&o.type==="wheel"&&!o.ctrlKey||Oe(o,e))return null;o.preventDefault(),n.call(this,o,r)}}function If({zoomPanValues:e,onDraggingChange:t,onPanZoomStart:n}){return o=>{var s,i,a;if((s=o.sourceEvent)!=null&&s.internal)return;const r=cn(o.transform);e.mouseButton=((i=o.sourceEvent)==null?void 0:i.button)||0,e.isZoomingOrPanning=!0,e.prevViewport=r,((a=o.sourceEvent)==null?void 0:a.type)==="mousedown"&&t(!0),n&&(n==null||n(o.sourceEvent,r))}}function $f({zoomPanValues:e,panOnDrag:t,onPaneContextMenu:n,onTransformChange:o,onPanZoom:r}){return s=>{var i,a;e.usedRightMouseButton=!!(n&&Ks(t,e.mouseButton??0)),(i=s.sourceEvent)!=null&&i.sync||o([s.transform.x,s.transform.y,s.transform.k]),r&&!((a=s.sourceEvent)!=null&&a.internal)&&(r==null||r(s.sourceEvent,cn(s.transform)))}}function jf({zoomPanValues:e,panOnDrag:t,panOnScroll:n,onDraggingChange:o,onPanZoomEnd:r,onPaneContextMenu:s}){return i=>{var a;if(!((a=i.sourceEvent)!=null&&a.internal)&&(e.isZoomingOrPanning=!1,s&&Ks(t,e.mouseButton??0)&&!e.usedRightMouseButton&&i.sourceEvent&&s(i.sourceEvent),e.usedRightMouseButton=!1,o(!1),r&&kf(e.prevViewport,i.transform))){const l=cn(i.transform);e.prevViewport=l,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{r==null||r(i.sourceEvent,l)},n?150:0)}}}function Pf({zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:n,panOnDrag:o,panOnScroll:r,zoomOnDoubleClick:s,userSelectionActive:i,noWheelClassName:a,noPanClassName:l,lib:u}){return d=>{var p;const f=e||t,c=n&&d.ctrlKey;if(d.button===1&&d.type==="mousedown"&&(Oe(d,`${u}-flow__node`)||Oe(d,`${u}-flow__edge`)))return!0;if(!o&&!f&&!r&&!s&&!n||i||Oe(d,a)&&d.type==="wheel"||Oe(d,l)&&(d.type!=="wheel"||r&&d.type==="wheel"&&!e)||!n&&d.ctrlKey&&d.type==="wheel")return!1;if(!n&&d.type==="touchstart"&&((p=d.touches)==null?void 0:p.length)>1)return d.preventDefault(),!1;if(!f&&!r&&!c&&d.type==="wheel"||!o&&(d.type==="mousedown"||d.type==="touchstart")||Array.isArray(o)&&!o.includes(d.button)&&d.type==="mousedown")return!1;const h=Array.isArray(o)&&o.includes(d.button)||!d.button||d.button<=1;return(!d.ctrlKey||d.type==="wheel")&&h}}function Tf({domNode:e,minZoom:t,maxZoom:n,paneClickDistance:o,translateExtent:r,viewport:s,onPanZoom:i,onPanZoomStart:a,onPanZoomEnd:l,onDraggingChange:u}){const d={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{x:0,y:0,zoom:0},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},f=e.getBoundingClientRect(),c=_s().clickDistance(!ge(o)||o<0?0:o).scaleExtent([t,n]).translateExtent(r),h=ce(e).call(c);m({x:s.x,y:s.y,zoom:Ue(s.zoom,t,n)},[[0,0],[f.width,f.height]],r);const p=h.on("wheel.zoom"),y=h.on("dblclick.zoom");c.wheelDelta(Zs);function v(H,R){return h?new Promise(x=>{c==null||c.transform(En(h,R==null?void 0:R.duration,()=>x(!0)),H)}):Promise.resolve(!1)}function b({noWheelClassName:H,noPanClassName:R,onPaneContextMenu:x,userSelectionActive:k,panOnScroll:C,panOnDrag:S,panOnScrollMode:I,panOnScrollSpeed:E,preventScrolling:P,zoomOnPinch:B,zoomOnScroll:V,zoomOnDoubleClick:X,zoomActivationKeyPressed:W,lib:z,onTransformChange:O}){k&&!d.isZoomingOrPanning&&_();const Y=C&&!W&&!k?Mf({zoomPanValues:d,noWheelClassName:H,d3Selection:h,d3Zoom:c,panOnScrollMode:I,panOnScrollSpeed:E,zoomOnPinch:B,onPanZoomStart:a,onPanZoom:i,onPanZoomEnd:l}):Af({noWheelClassName:H,preventScrolling:P,d3ZoomHandler:p});if(h.on("wheel.zoom",Y,{passive:!1}),!k){const J=If({zoomPanValues:d,onDraggingChange:u,onPanZoomStart:a});c.on("start",J);const K=$f({zoomPanValues:d,panOnDrag:S,onPaneContextMenu:!!x,onPanZoom:i,onTransformChange:O});c.on("zoom",K);const G=jf({zoomPanValues:d,panOnDrag:S,panOnScroll:C,onPaneContextMenu:x,onPanZoomEnd:l,onDraggingChange:u});c.on("end",G)}const U=Pf({zoomActivationKeyPressed:W,panOnDrag:S,zoomOnScroll:V,panOnScroll:C,zoomOnDoubleClick:X,zoomOnPinch:B,userSelectionActive:k,noPanClassName:R,noWheelClassName:H,lib:z});c.filter(U),X?h.on("dblclick.zoom",y):h.on("dblclick.zoom",null)}function _(){c.on("zoom",null)}async function m(H,R,x){const k=Cn(H),C=c==null?void 0:c.constrain()(k,R,x);return C&&await v(C),new Promise(S=>S(C))}async function w(H,R){const x=Cn(H);return await v(x,R),new Promise(k=>k(x))}function A(H){if(h){const R=Cn(H),x=h.property("__zoom");(x.k!==H.zoom||x.x!==H.x||x.y!==H.y)&&(c==null||c.transform(h,R,null,{sync:!0}))}}function $(){const H=h?Ns(h.node()):{x:0,y:0,k:1};return{x:H.x,y:H.y,zoom:H.k}}function M(H,R){return h?new Promise(x=>{c==null||c.scaleTo(En(h,R==null?void 0:R.duration,()=>x(!0)),H)}):Promise.resolve(!1)}function D(H,R){return h?new Promise(x=>{c==null||c.scaleBy(En(h,R==null?void 0:R.duration,()=>x(!0)),H)}):Promise.resolve(!1)}function j(H){c==null||c.scaleExtent(H)}function T(H){c==null||c.translateExtent(H)}function L(H){const R=!ge(H)||H<0?0:H;c==null||c.clickDistance(R)}return{update:b,destroy:_,setViewport:w,setViewportConstrained:m,getViewport:$,scaleTo:M,scaleBy:D,setScaleExtent:j,setTranslateExtent:T,syncViewport:A,setClickDistance:L}}var dt;(function(e){e.Line="line",e.Handle="handle"})(dt||(dt={}));function Df({width:e,prevWidth:t,height:n,prevHeight:o,affectsX:r,affectsY:s}){const i=e-t,a=n-o,l=[i>0?1:i<0?-1:0,a>0?1:a<0?-1:0];return i&&r&&(l[0]=l[0]*-1),a&&s&&(l[1]=l[1]*-1),l}function zf(e){const t=e.includes("right")||e.includes("left"),n=e.includes("bottom")||e.includes("top"),o=e.includes("left"),r=e.includes("top");return{isHorizontal:t,isVertical:n,affectsX:o,affectsY:r}}function Ce(e,t){return Math.max(0,t-e)}function Ee(e,t){return Math.max(0,e-t)}function Dt(e,t,n){return Math.max(0,t-e,e-n)}function nr(e,t){return e?!t:t}function Rf(e,t,n,o,r,s,i,a){let{affectsX:l,affectsY:u}=t;const{isHorizontal:d,isVertical:f}=t,c=d&&f,{xSnapped:h,ySnapped:p}=n,{minWidth:y,maxWidth:v,minHeight:b,maxHeight:_}=o,{x:m,y:w,width:A,height:$,aspectRatio:M}=e;let D=Math.floor(d?h-e.pointerX:0),j=Math.floor(f?p-e.pointerY:0);const T=A+(l?-D:D),L=$+(u?-j:j),H=-s[0]*A,R=-s[1]*$;let x=Dt(T,y,v),k=Dt(L,b,_);if(i){let I=0,E=0;l&&D<0?I=Ce(m+D+H,i[0][0]):!l&&D>0&&(I=Ee(m+T+H,i[1][0])),u&&j<0?E=Ce(w+j+R,i[0][1]):!u&&j>0&&(E=Ee(w+L+R,i[1][1])),x=Math.max(x,I),k=Math.max(k,E)}if(a){let I=0,E=0;l&&D>0?I=Ee(m+D,a[0][0]):!l&&D<0&&(I=Ce(m+T,a[1][0])),u&&j>0?E=Ee(w+j,a[0][1]):!u&&j<0&&(E=Ce(w+L,a[1][1])),x=Math.max(x,I),k=Math.max(k,E)}if(r){if(d){const I=Dt(T/M,b,_)*M;if(x=Math.max(x,I),i){let E=0;!l&&!u||l&&!u&&c?E=Ee(w+R+T/M,i[1][1])*M:E=Ce(w+R+(l?D:-D)/M,i[0][1])*M,x=Math.max(x,E)}if(a){let E=0;!l&&!u||l&&!u&&c?E=Ce(w+T/M,a[1][1])*M:E=Ee(w+(l?D:-D)/M,a[0][1])*M,x=Math.max(x,E)}}if(f){const I=Dt(L*M,y,v)/M;if(k=Math.max(k,I),i){let E=0;!l&&!u||u&&!l&&c?E=Ee(m+L*M+H,i[1][0])/M:E=Ce(m+(u?j:-j)*M+H,i[0][0])/M,k=Math.max(k,E)}if(a){let E=0;!l&&!u||u&&!l&&c?E=Ce(m+L*M,a[1][0])/M:E=Ee(m+(u?j:-j)*M,a[0][0])/M,k=Math.max(k,E)}}}j=j+(j<0?k:-k),D=D+(D<0?x:-x),r&&(c?T>L*M?j=(nr(l,u)?-D:D)/M:D=(nr(l,u)?-j:j)*M:d?(j=D/M,u=l):(D=j*M,l=u));const C=l?m+D:m,S=u?w+j:w;return{width:A+(l?-D:D),height:$+(u?-j:j),x:s[0]*D*(l?-1:1)+C,y:s[1]*j*(u?-1:1)+S}}const Qs={width:0,height:0,x:0,y:0},Hf={...Qs,pointerX:0,pointerY:0,aspectRatio:1};function Lf(e){return[[0,0],[e.measured.width,e.measured.height]]}function Bf(e,t,n){const o=t.position.x+e.position.x,r=t.position.y+e.position.y,s=e.measured.width??0,i=e.measured.height??0,a=n[0]*s,l=n[1]*i;return[[o-a,r-l],[o+s-a,r+i-l]]}function Ff({domNode:e,nodeId:t,getStoreItems:n,onChange:o,onEnd:r}){const s=ce(e);function i({controlPosition:l,boundaries:u,keepAspectRatio:d,onResizeStart:f,onResize:c,onResizeEnd:h,shouldResize:p}){let y={...Qs},v={...Hf};const b=zf(l);let _,m=null,w=[],A,$,M;const D=cs().on("start",j=>{const{nodeLookup:T,transform:L,snapGrid:H,snapToGrid:R,nodeOrigin:x,paneDomNode:k}=n();if(_=T.get(t),!_)return;m=(k==null?void 0:k.getBoundingClientRect())??null;const{xSnapped:C,ySnapped:S}=ut(j.sourceEvent,{transform:L,snapGrid:H,snapToGrid:R,containerBounds:m});y={width:_.measured.width??0,height:_.measured.height??0,x:_.position.x??0,y:_.position.y??0},v={...y,pointerX:C,pointerY:S,aspectRatio:y.width/y.height},A=void 0,_.parentId&&(_.extent==="parent"||_.expandParent)&&(A=T.get(_.parentId),$=A&&_.extent==="parent"?Lf(A):void 0),w=[],M=void 0;for(const[I,E]of T)if(E.parentId===t&&(w.push({id:I,position:{...E.position},extent:E.extent}),E.extent==="parent"||E.expandParent)){const P=Bf(E,_,E.origin??x);M?M=[[Math.min(P[0][0],M[0][0]),Math.min(P[0][1],M[0][1])],[Math.max(P[1][0],M[1][0]),Math.max(P[1][1],M[1][1])]]:M=P}f==null||f(j,{...y})}).on("drag",j=>{const{transform:T,snapGrid:L,snapToGrid:H,nodeOrigin:R}=n(),x=ut(j.sourceEvent,{transform:T,snapGrid:L,snapToGrid:H,containerBounds:m}),k=[];if(!_)return;const{x:C,y:S,width:I,height:E}=y,P={},B=_.origin??R,{width:V,height:X,x:W,y:z}=Rf(v,b,x,u,d,B,$,M),O=V!==I,F=X!==E,Y=W!==C&&O,U=z!==S&&F;if(!Y&&!U&&!O&&!F)return;if((Y||U||B[0]===1||B[1]===1)&&(P.x=Y?W:y.x,P.y=U?z:y.y,y.x=P.x,y.y=P.y,w.length>0)){const ee=W-C,Q=z-S;for(const re of w)re.position={x:re.position.x-ee+B[0]*(V-I),y:re.position.y-Q+B[1]*(X-E)},k.push(re)}if((O||F)&&(P.width=O?V:y.width,P.height=F?X:y.height,y.width=P.width,y.height=P.height),A&&_.expandParent){const ee=B[0]*(P.width??0);P.x&&P.x<ee&&(y.x=ee,v.x=v.x-(P.x-ee));const Q=B[1]*(P.height??0);P.y&&P.y<Q&&(y.y=Q,v.y=v.y-(P.y-Q))}const J=Df({width:y.width,prevWidth:I,height:y.height,prevHeight:E,affectsX:b.affectsX,affectsY:b.affectsY}),K={...y,direction:J};(p==null?void 0:p(j,K))!==!1&&(c==null||c(j,K),o(P,k))}).on("end",j=>{h==null||h(j,{...y}),r==null||r()});s.call(D)}function a(){s.on(".drag",null)}return{update:i,destroy:a}}const Of={},or=e=>{let t;const n=new Set,o=(d,f)=>{const c=typeof d=="function"?d(t):d;if(!Object.is(c,t)){const h=t;t=f??(typeof c!="object"||c===null)?c:Object.assign({},t,c),n.forEach(p=>p(t,h))}},r=()=>t,l={setState:o,getState:r,getInitialState:()=>u,subscribe:d=>(n.add(d),()=>n.delete(d)),destroy:()=>{(Of?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},u=t=e(o,r,l);return l},Vf=e=>e?or(e):or,{useDebugValue:Yf}=Mn,{useSyncExternalStoreWithSelector:Xf}=Ha,Wf=e=>e;function Js(e,t=Wf,n){const o=Xf(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return Yf(o),o}const rr=(e,t)=>{const n=Vf(e),o=(r,s=t)=>Js(n,r,s);return Object.assign(o,n),o},qf=(e,t)=>e?rr(e,t):rr;function ne(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[o,r]of e)if(!Object.is(r,t.get(o)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const o of e)if(!t.has(o))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const o of n)if(!Object.prototype.hasOwnProperty.call(t,o)||!Object.is(e[o],t[o]))return!1;return!0}const ln=N.createContext(null),Gf=ln.Provider,ei=xe.error001();function Z(e,t){const n=N.useContext(ln);if(n===null)throw new Error(ei);return Js(n,e,t)}function te(){const e=N.useContext(ln);if(e===null)throw new Error(ei);return N.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe}),[e])}const sr={display:"none"},Uf={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},ti="react-flow__node-desc",ni="react-flow__edge-desc",Kf="react-flow__aria-live",Zf=e=>e.ariaLiveMessage;function Qf({rfId:e}){const t=Z(Zf);return g.jsx("div",{id:`${Kf}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:Uf,children:t})}function Jf({rfId:e,disableKeyboardA11y:t}){return g.jsxs(g.Fragment,{children:[g.jsxs("div",{id:`${ti}-${e}`,style:sr,children:["Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "]}),g.jsx("div",{id:`${ni}-${e}`,style:sr,children:"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."}),!t&&g.jsx(Qf,{rfId:e})]})}const eh=e=>e.userSelectionActive?"none":"all",un=N.forwardRef(({position:e="top-left",children:t,className:n,style:o,...r},s)=>{const i=Z(eh),a=`${e}`.split("-");return g.jsx("div",{className:oe(["react-flow__panel",n,...a]),style:{...o,pointerEvents:i},ref:s,...r,children:t})});un.displayName="Panel";function th({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:g.jsx(un,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:g.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const nh=e=>{const t=[],n=[];for(const[,o]of e.nodeLookup)o.selected&&t.push(o.internals.userNode);for(const[,o]of e.edgeLookup)o.selected&&n.push(o);return{selectedNodes:t,selectedEdges:n}},zt=e=>e.id;function oh(e,t){return ne(e.selectedNodes.map(zt),t.selectedNodes.map(zt))&&ne(e.selectedEdges.map(zt),t.selectedEdges.map(zt))}function rh({onSelectionChange:e}){const t=te(),{selectedNodes:n,selectedEdges:o}=Z(nh,oh);return N.useEffect(()=>{const r={nodes:n,edges:o};e==null||e(r),t.getState().onSelectionChangeHandlers.forEach(s=>s(r))},[n,o,e]),null}const sh=e=>!!e.onSelectionChangeHandlers;function ih({onSelectionChange:e}){const t=Z(sh);return e||t?g.jsx(rh,{onSelectionChange:e}):null}const oi=[0,0],ah={x:0,y:0,zoom:1},ch=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","onBeforeDelete","debug","autoPanSpeed","paneClickDistance"],ir=[...ch,"rfId"],lh=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setPaneClickDistance:e.setPaneClickDistance}),ar={translateExtent:xt,nodeOrigin:oi,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1",paneClickDistance:0};function uh(e){const{setNodes:t,setEdges:n,setMinZoom:o,setMaxZoom:r,setTranslateExtent:s,setNodeExtent:i,reset:a,setDefaultNodesAndEdges:l,setPaneClickDistance:u}=Z(lh,ne),d=te();N.useEffect(()=>(l(e.defaultNodes,e.defaultEdges),()=>{f.current=ar,a()}),[]);const f=N.useRef(ar);return N.useEffect(()=>{for(const c of ir){const h=e[c],p=f.current[c];h!==p&&(typeof e[c]>"u"||(c==="nodes"?t(h):c==="edges"?n(h):c==="minZoom"?o(h):c==="maxZoom"?r(h):c==="translateExtent"?s(h):c==="nodeExtent"?i(h):c==="paneClickDistance"?u(h):c==="fitView"?d.setState({fitViewQueued:h}):c==="fitViewOptions"?d.setState({fitViewOptions:h}):d.setState({[c]:h})))}f.current=e},ir.map(c=>e[c])),null}function cr(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function dh(e){var o;const[t,n]=N.useState(e==="system"?null:e);return N.useEffect(()=>{if(e!=="system"){n(e);return}const r=cr(),s=()=>n(r!=null&&r.matches?"dark":"light");return s(),r==null||r.addEventListener("change",s),()=>{r==null||r.removeEventListener("change",s)}},[e]),t!==null?t:(o=cr())!=null&&o.matches?"dark":"light"}const lr=typeof document<"u"?document:null;function vt(e=null,t={target:lr,actInsideInputWithModifier:!0}){const[n,o]=N.useState(!1),r=N.useRef(!1),s=N.useRef(new Set([])),[i,a]=N.useMemo(()=>{if(e!==null){const u=(Array.isArray(e)?e:[e]).filter(f=>typeof f=="string").map(f=>f.replace("+",`
`).replace(`

`,`
+`).split(`
`)),d=u.reduce((f,c)=>f.concat(...c),[]);return[u,d]}return[[],[]]},[e]);return N.useEffect(()=>{const l=(t==null?void 0:t.target)||lr;if(e!==null){const u=c=>{var y,v;if(r.current=c.ctrlKey||c.metaKey||c.shiftKey||c.altKey,(!r.current||r.current&&!t.actInsideInputWithModifier)&&zs(c))return!1;const p=dr(c.code,a);if(s.current.add(c[p]),ur(i,s.current,!1)){const b=((v=(y=c.composedPath)==null?void 0:y.call(c))==null?void 0:v[0])||c.target,_=(b==null?void 0:b.nodeName)==="BUTTON"||(b==null?void 0:b.nodeName)==="A";t.preventDefault!==!1&&(r.current||!_)&&c.preventDefault(),o(!0)}},d=c=>{const h=dr(c.code,a);ur(i,s.current,!0)?(o(!1),s.current.clear()):s.current.delete(c[h]),c.key==="Meta"&&s.current.clear(),r.current=!1},f=()=>{s.current.clear(),o(!1)};return l==null||l.addEventListener("keydown",u),l==null||l.addEventListener("keyup",d),window.addEventListener("blur",f),window.addEventListener("contextmenu",f),()=>{l==null||l.removeEventListener("keydown",u),l==null||l.removeEventListener("keyup",d),window.removeEventListener("blur",f),window.removeEventListener("contextmenu",f)}}},[e,o]),n}function ur(e,t,n){return e.filter(o=>n||o.length===t.size).some(o=>o.every(r=>t.has(r)))}function dr(e,t){return t.includes(e)?"code":"key"}const fh=()=>{const e=te();return N.useMemo(()=>({zoomIn:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomOut:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1/1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomTo:(t,n)=>{const{panZoom:o}=e.getState();return o?o.scaleTo(t,{duration:n==null?void 0:n.duration}):Promise.resolve(!1)},getZoom:()=>e.getState().transform[2],setViewport:async(t,n)=>{const{transform:[o,r,s],panZoom:i}=e.getState();return i?(await i.setViewport({x:t.x??o,y:t.y??r,zoom:t.zoom??s},{duration:n==null?void 0:n.duration}),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[t,n,o]=e.getState().transform;return{x:t,y:n,zoom:o}},setCenter:async(t,n,o)=>{const{width:r,height:s,maxZoom:i,panZoom:a}=e.getState(),l=typeof(o==null?void 0:o.zoom)<"u"?o.zoom:i,u=r/2-t*l,d=s/2-n*l;return a?(await a.setViewport({x:u,y:d,zoom:l},{duration:o==null?void 0:o.duration}),Promise.resolve(!0)):Promise.resolve(!1)},fitBounds:async(t,n)=>{const{width:o,height:r,minZoom:s,maxZoom:i,panZoom:a}=e.getState(),l=ao(t,o,r,s,i,(n==null?void 0:n.padding)??.1);return a?(await a.setViewport(l,{duration:n==null?void 0:n.duration}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(t,n={})=>{const{transform:o,snapGrid:r,snapToGrid:s,domNode:i}=e.getState();if(!i)return t;const{x:a,y:l}=i.getBoundingClientRect(),u={x:t.x-a,y:t.y-l},d=n.snapGrid??r,f=n.snapToGrid??s;return St(u,o,f,d)},flowToScreenPosition:t=>{const{transform:n,domNode:o}=e.getState();if(!o)return t;const{x:r,y:s}=o.getBoundingClientRect(),i=Kt(t,n);return{x:i.x+r,y:i.y+s}}}),[])};function ri(e,t){const n=[],o=new Map,r=[];for(const s of e)if(s.type==="add"){r.push(s);continue}else if(s.type==="remove"||s.type==="replace")o.set(s.id,[s]);else{const i=o.get(s.id);i?i.push(s):o.set(s.id,[s])}for(const s of t){const i=o.get(s.id);if(!i){n.push(s);continue}if(i[0].type==="remove")continue;if(i[0].type==="replace"){n.push({...i[0].item});continue}const a={...s};for(const l of i)hh(l,a);n.push(a)}return r.length&&r.forEach(s=>{s.index!==void 0?n.splice(s.index,0,{...s.item}):n.push({...s.item})}),n}function hh(e,t){switch(e.type){case"select":{t.selected=e.selected;break}case"position":{typeof e.position<"u"&&(t.position=e.position),typeof e.dragging<"u"&&(t.dragging=e.dragging);break}case"dimensions":{typeof e.dimensions<"u"&&(t.measured??(t.measured={}),t.measured.width=e.dimensions.width,t.measured.height=e.dimensions.height,e.setAttributes&&(t.width=e.dimensions.width,t.height=e.dimensions.height)),typeof e.resizing=="boolean"&&(t.resizing=e.resizing);break}}}function si(e,t){return ri(e,t)}function ii(e,t){return ri(e,t)}function Pe(e,t){return{id:e,type:"select",selected:t}}function Ve(e,t=new Set,n=!1){const o=[];for(const[r,s]of e){const i=t.has(r);!(s.selected===void 0&&!i)&&s.selected!==i&&(n&&(s.selected=i),o.push(Pe(s.id,i)))}return o}function fr({items:e=[],lookup:t}){var r;const n=[],o=new Map(e.map(s=>[s.id,s]));for(const[s,i]of e.entries()){const a=t.get(i.id),l=((r=a==null?void 0:a.internals)==null?void 0:r.userNode)??a;l!==void 0&&l!==i&&n.push({id:i.id,item:i,type:"replace"}),l===void 0&&n.push({item:i,type:"add",index:s})}for(const[s]of t)o.get(s)===void 0&&n.push({id:s,type:"remove"});return n}function hr(e){return{id:e.id,type:"remove"}}const gr=e=>qd(e),gh=e=>ks(e);function ai(e){return N.forwardRef(e)}const ph=typeof window<"u"?N.useLayoutEffect:N.useEffect;function pr(e){const[t,n]=N.useState(BigInt(0)),[o]=N.useState(()=>mh(()=>n(r=>r+BigInt(1))));return ph(()=>{const r=o.get();r.length&&(e(r),o.reset())},[t]),o}function mh(e){let t=[];return{get:()=>t,reset:()=>{t=[]},push:n=>{t.push(n),e()}}}const ci=N.createContext(null);function xh({children:e}){const t=te(),n=N.useCallback(a=>{const{nodes:l=[],setNodes:u,hasDefaultNodes:d,onNodesChange:f,nodeLookup:c}=t.getState();let h=l;for(const p of a)h=typeof p=="function"?p(h):p;d?u(h):f&&f(fr({items:h,lookup:c}))},[]),o=pr(n),r=N.useCallback(a=>{const{edges:l=[],setEdges:u,hasDefaultEdges:d,onEdgesChange:f,edgeLookup:c}=t.getState();let h=l;for(const p of a)h=typeof p=="function"?p(h):p;d?u(h):f&&f(fr({items:h,lookup:c}))},[]),s=pr(r),i=N.useMemo(()=>({nodeQueue:o,edgeQueue:s}),[]);return g.jsx(ci.Provider,{value:i,children:e})}function yh(){const e=N.useContext(ci);if(!e)throw new Error("useBatchContext must be used within a BatchProvider");return e}const wh=e=>!!e.panZoom;function go(){const e=fh(),t=te(),n=yh(),o=Z(wh),r=N.useMemo(()=>{const s=f=>t.getState().nodeLookup.get(f),i=f=>{n.nodeQueue.push(f)},a=f=>{n.edgeQueue.push(f)},l=f=>{var b,_;const{nodeLookup:c,nodeOrigin:h}=t.getState(),p=gr(f)?f:c.get(f.id),y=p.parentId?Ts(p.position,p.measured,p.parentId,c,h):p.position,v={...p,position:y,width:((b=p.measured)==null?void 0:b.width)??p.width,height:((_=p.measured)==null?void 0:_.height)??p.height};return Ke(v)},u=(f,c,h={replace:!1})=>{i(p=>p.map(y=>{if(y.id===f){const v=typeof c=="function"?c(y):c;return h.replace&&gr(v)?v:{...y,...v}}return y}))},d=(f,c,h={replace:!1})=>{a(p=>p.map(y=>{if(y.id===f){const v=typeof c=="function"?c(y):c;return h.replace&&gh(v)?v:{...y,...v}}return y}))};return{getNodes:()=>t.getState().nodes.map(f=>({...f})),getNode:f=>{var c;return(c=s(f))==null?void 0:c.internals.userNode},getInternalNode:s,getEdges:()=>{const{edges:f=[]}=t.getState();return f.map(c=>({...c}))},getEdge:f=>t.getState().edgeLookup.get(f),setNodes:i,setEdges:a,addNodes:f=>{const c=Array.isArray(f)?f:[f];n.nodeQueue.push(h=>[...h,...c])},addEdges:f=>{const c=Array.isArray(f)?f:[f];n.edgeQueue.push(h=>[...h,...c])},toObject:()=>{const{nodes:f=[],edges:c=[],transform:h}=t.getState(),[p,y,v]=h;return{nodes:f.map(b=>({...b})),edges:c.map(b=>({...b})),viewport:{x:p,y,zoom:v}}},deleteElements:async({nodes:f=[],edges:c=[]})=>{const{nodes:h,edges:p,onNodesDelete:y,onEdgesDelete:v,triggerNodeChanges:b,triggerEdgeChanges:_,onDelete:m,onBeforeDelete:w}=t.getState(),{nodes:A,edges:$}=await Qd({nodesToRemove:f,edgesToRemove:c,nodes:h,edges:p,onBeforeDelete:w}),M=$.length>0,D=A.length>0;if(M){const j=$.map(hr);v==null||v($),_(j)}if(D){const j=A.map(hr);y==null||y(A),b(j)}return(D||M)&&(m==null||m({nodes:A,edges:$})),{deletedNodes:A,deletedEdges:$}},getIntersectingNodes:(f,c=!0,h)=>{const p=Xo(f),y=p?f:l(f),v=h!==void 0;return y?(h||t.getState().nodes).filter(b=>{const _=t.getState().nodeLookup.get(b.id);if(_&&!p&&(b.id===f.id||!_.internals.positionAbsolute))return!1;const m=Ke(v?b:_),w=wt(m,y);return c&&w>0||w>=y.width*y.height}):[]},isNodeIntersecting:(f,c,h=!0)=>{const y=Xo(f)?f:l(f);if(!y)return!1;const v=wt(y,c);return h&&v>0||v>=y.width*y.height},updateNode:u,updateNodeData:(f,c,h={replace:!1})=>{u(f,p=>{const y=typeof c=="function"?c(p):c;return h.replace?{...p,data:y}:{...p,data:{...p.data,...y}}},h)},updateEdge:d,updateEdgeData:(f,c,h={replace:!1})=>{d(f,p=>{const y=typeof c=="function"?c(p):c;return h.replace?{...p,data:y}:{...p,data:{...p.data,...y}}},h)},getNodesBounds:f=>{const{nodeLookup:c,nodeOrigin:h}=t.getState();return Gd(f,{nodeLookup:c,nodeOrigin:h})},getHandleConnections:({type:f,id:c,nodeId:h})=>{var p;return Array.from(((p=t.getState().connectionLookup.get(`${h}-${f}${c?`-${c}`:""}`))==null?void 0:p.values())??[])},getNodeConnections:({type:f,handleId:c,nodeId:h})=>{var p;return Array.from(((p=t.getState().connectionLookup.get(`${h}${f?c?`-${f}-${c}`:`-${f}`:""}`))==null?void 0:p.values())??[])},fitView:async f=>{const c=t.getState().fitViewResolver??Promise.withResolvers();return t.setState({fitViewQueued:!0,fitViewOptions:f,fitViewResolver:c}),n.nodeQueue.push(h=>[...h]),c.promise}}},[]);return N.useMemo(()=>({...r,...e,viewportInitialized:o}),[o])}const mr=e=>e.selected,bh={actInsideInputWithModifier:!1},vh=typeof window<"u"?window:void 0;function Nh({deleteKeyCode:e,multiSelectionKeyCode:t}){const n=te(),{deleteElements:o}=go(),r=vt(e,bh),s=vt(t,{target:vh});N.useEffect(()=>{if(r){const{edges:i,nodes:a}=n.getState();o({nodes:a.filter(mr),edges:i.filter(mr)}),n.setState({nodesSelectionActive:!1})}},[r]),N.useEffect(()=>{n.setState({multiSelectionActive:s})},[s])}function _h(e){const t=te();N.useEffect(()=>{const n=()=>{var r,s;if(!e.current)return!1;const o=co(e.current);(o.height===0||o.width===0)&&((s=(r=t.getState()).onError)==null||s.call(r,"004",xe.error004())),t.setState({width:o.width||500,height:o.height||500})};if(e.current){n(),window.addEventListener("resize",n);const o=new ResizeObserver(()=>n());return o.observe(e.current),()=>{window.removeEventListener("resize",n),o&&e.current&&o.unobserve(e.current)}}},[])}const dn={position:"absolute",width:"100%",height:"100%",top:0,left:0},Ch=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib});function Eh({onPaneContextMenu:e,zoomOnScroll:t=!0,zoomOnPinch:n=!0,panOnScroll:o=!1,panOnScrollSpeed:r=.5,panOnScrollMode:s=ze.Free,zoomOnDoubleClick:i=!0,panOnDrag:a=!0,defaultViewport:l,translateExtent:u,minZoom:d,maxZoom:f,zoomActivationKeyCode:c,preventScrolling:h=!0,children:p,noWheelClassName:y,noPanClassName:v,onViewportChange:b,isControlledViewport:_,paneClickDistance:m}){const w=te(),A=N.useRef(null),{userSelectionActive:$,lib:M}=Z(Ch,ne),D=vt(c),j=N.useRef();_h(A);const T=N.useCallback(L=>{b==null||b({x:L[0],y:L[1],zoom:L[2]}),_||w.setState({transform:L})},[b,_]);return N.useEffect(()=>{if(A.current){j.current=Tf({domNode:A.current,minZoom:d,maxZoom:f,translateExtent:u,viewport:l,paneClickDistance:m,onDraggingChange:x=>w.setState({paneDragging:x}),onPanZoomStart:(x,k)=>{const{onViewportChangeStart:C,onMoveStart:S}=w.getState();S==null||S(x,k),C==null||C(k)},onPanZoom:(x,k)=>{const{onViewportChange:C,onMove:S}=w.getState();S==null||S(x,k),C==null||C(k)},onPanZoomEnd:(x,k)=>{const{onViewportChangeEnd:C,onMoveEnd:S}=w.getState();S==null||S(x,k),C==null||C(k)}});const{x:L,y:H,zoom:R}=j.current.getViewport();return w.setState({panZoom:j.current,transform:[L,H,R],domNode:A.current.closest(".react-flow")}),()=>{var x;(x=j.current)==null||x.destroy()}}},[]),N.useEffect(()=>{var L;(L=j.current)==null||L.update({onPaneContextMenu:e,zoomOnScroll:t,zoomOnPinch:n,panOnScroll:o,panOnScrollSpeed:r,panOnScrollMode:s,zoomOnDoubleClick:i,panOnDrag:a,zoomActivationKeyPressed:D,preventScrolling:h,noPanClassName:v,userSelectionActive:$,noWheelClassName:y,lib:M,onTransformChange:T})},[e,t,n,o,r,s,i,a,D,h,v,$,y,M,T]),g.jsx("div",{className:"react-flow__renderer",ref:A,style:dn,children:p})}const Sh=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function kh(){const{userSelectionActive:e,userSelectionRect:t}=Z(Sh,ne);return e&&t?g.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}const Sn=(e,t)=>n=>{n.target===t.current&&(e==null||e(n))},Mh=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,connectionInProgress:e.connection.inProgress,dragging:e.paneDragging});function Ah({isSelecting:e,selectionKeyPressed:t,selectionMode:n=yt.Full,panOnDrag:o,selectionOnDrag:r,onSelectionStart:s,onSelectionEnd:i,onPaneClick:a,onPaneContextMenu:l,onPaneScroll:u,onPaneMouseEnter:d,onPaneMouseMove:f,onPaneMouseLeave:c,children:h}){const p=te(),{userSelectionActive:y,elementsSelectable:v,dragging:b,connectionInProgress:_}=Z(Mh,ne),m=v&&(e||y),w=N.useRef(null),A=N.useRef(),$=N.useRef(new Set),M=N.useRef(new Set),D=N.useRef(!1),j=N.useRef(!1),T=S=>{if(D.current||_){D.current=!1;return}a==null||a(S),p.getState().resetSelectedElements(),p.setState({nodesSelectionActive:!1})},L=S=>{if(Array.isArray(o)&&(o!=null&&o.includes(2))){S.preventDefault();return}l==null||l(S)},H=u?S=>u(S):void 0,R=S=>{var V,X;const{resetSelectedElements:I,domNode:E}=p.getState();if(A.current=E==null?void 0:E.getBoundingClientRect(),!v||!e||S.button!==0||S.target!==w.current||!A.current)return;(X=(V=S.target)==null?void 0:V.setPointerCapture)==null||X.call(V,S.pointerId),j.current=!0,D.current=!1;const{x:P,y:B}=ve(S.nativeEvent,A.current);I(),p.setState({userSelectionRect:{width:0,height:0,startX:P,startY:B,x:P,y:B}}),s==null||s(S)},x=S=>{const{userSelectionRect:I,transform:E,nodeLookup:P,edgeLookup:B,connectionLookup:V,triggerNodeChanges:X,triggerEdgeChanges:W,defaultEdgeOptions:z}=p.getState();if(!A.current||!I)return;D.current=!0;const{x:O,y:F}=ve(S.nativeEvent,A.current),{startX:Y,startY:U}=I,J={startX:Y,startY:U,x:O<Y?O:Y,y:F<U?F:U,width:Math.abs(O-Y),height:Math.abs(F-U)},K=$.current,G=M.current;$.current=new Set(Ms(P,J,E,n===yt.Partial,!0).map(Q=>Q.id)),M.current=new Set;const ee=(z==null?void 0:z.selectable)??!0;for(const Q of $.current){const re=V.get(Q);if(re)for(const{edgeId:ue}of re.values()){const Le=B.get(ue);Le&&(Le.selectable??ee)&&M.current.add(ue)}}if(!Wo(K,$.current)){const Q=Ve(P,$.current,!0);X(Q)}if(!Wo(G,M.current)){const Q=Ve(B,M.current);W(Q)}p.setState({userSelectionRect:J,userSelectionActive:!0,nodesSelectionActive:!1})},k=S=>{var E,P;if(S.button!==0||!j.current)return;(P=(E=S.target)==null?void 0:E.releasePointerCapture)==null||P.call(E,S.pointerId);const{userSelectionRect:I}=p.getState();!y&&I&&S.target===w.current&&(T==null||T(S)),p.setState({userSelectionActive:!1,userSelectionRect:null,nodesSelectionActive:$.current.size>0}),i==null||i(S),(t||r)&&(D.current=!1),j.current=!1},C=o===!0||Array.isArray(o)&&o.includes(0);return g.jsxs("div",{className:oe(["react-flow__pane",{draggable:C,dragging:b,selection:e}]),onClick:m?void 0:Sn(T,w),onContextMenu:Sn(L,w),onWheel:Sn(H,w),onPointerEnter:m?void 0:d,onPointerDown:m?R:f,onPointerMove:m?x:f,onPointerUp:m?k:void 0,onPointerLeave:c,ref:w,style:dn,children:[h,g.jsx(kh,{})]})}function Yn({id:e,store:t,unselect:n=!1,nodeRef:o}){const{addSelectedNodes:r,unselectNodesAndEdges:s,multiSelectionActive:i,nodeLookup:a,onError:l}=t.getState(),u=a.get(e);if(!u){l==null||l("012",xe.error012(e));return}t.setState({nodesSelectionActive:!1}),u.selected?(n||u.selected&&i)&&(s({nodes:[u],edges:[]}),requestAnimationFrame(()=>{var d;return(d=o==null?void 0:o.current)==null?void 0:d.blur()})):r([e])}function li({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:o,nodeId:r,isSelectable:s,nodeClickDistance:i}){const a=te(),[l,u]=N.useState(!1),d=N.useRef();return N.useEffect(()=>{d.current=bf({getStoreItems:()=>a.getState(),onNodeMouseDown:f=>{Yn({id:f,store:a,nodeRef:e})},onDragStart:()=>{u(!0)},onDragStop:()=>{u(!1)}})},[]),N.useEffect(()=>{var f,c;if(t)(f=d.current)==null||f.destroy();else if(e.current)return(c=d.current)==null||c.update({noDragClassName:n,handleSelector:o,domNode:e.current,isSelectable:s,nodeId:r,nodeClickDistance:i}),()=>{var h;(h=d.current)==null||h.destroy()}},[n,o,t,s,e,r]),l}const Ih=e=>t=>t.selected&&(t.draggable||e&&typeof t.draggable>"u");function ui(){const e=te();return N.useCallback(n=>{const{nodeExtent:o,snapToGrid:r,snapGrid:s,nodesDraggable:i,onError:a,updateNodePositions:l,nodeLookup:u,nodeOrigin:d}=e.getState(),f=new Map,c=Ih(i),h=r?s[0]:5,p=r?s[1]:5,y=n.direction.x*h*n.factor,v=n.direction.y*p*n.factor;for(const[,b]of u){if(!c(b))continue;let _={x:b.internals.positionAbsolute.x+y,y:b.internals.positionAbsolute.y+v};r&&(_=an(_,s));const{position:m,positionAbsolute:w}=As({nodeId:b.id,nextPosition:_,nodeLookup:u,nodeExtent:o,nodeOrigin:d,onError:a});b.position=m,b.internals.positionAbsolute=w,f.set(b.id,b)}l(f)},[])}const po=N.createContext(null),$h=po.Provider;po.Consumer;const di=()=>N.useContext(po),jh=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId}),Ph=(e,t,n)=>o=>{const{connectionClickStartHandle:r,connectionMode:s,connection:i}=o,{fromHandle:a,toHandle:l,isValid:u}=i,d=(l==null?void 0:l.nodeId)===e&&(l==null?void 0:l.id)===t&&(l==null?void 0:l.type)===n;return{connectingFrom:(a==null?void 0:a.nodeId)===e&&(a==null?void 0:a.id)===t&&(a==null?void 0:a.type)===n,connectingTo:d,clickConnecting:(r==null?void 0:r.nodeId)===e&&(r==null?void 0:r.id)===t&&(r==null?void 0:r.type)===n,isPossibleEndHandle:s===Ge.Strict?(a==null?void 0:a.type)!==n:e!==(a==null?void 0:a.nodeId)||t!==(a==null?void 0:a.id),connectionInProcess:!!a,clickConnectionInProcess:!!r,valid:d&&u}};function Th({type:e="source",position:t=q.Top,isValidConnection:n,isConnectable:o=!0,isConnectableStart:r=!0,isConnectableEnd:s=!0,id:i,onConnect:a,children:l,className:u,onMouseDown:d,onTouchStart:f,...c},h){var k,C;const p=i||null,y=e==="target",v=te(),b=di(),{connectOnClick:_,noPanClassName:m,rfId:w}=Z(jh,ne),{connectingFrom:A,connectingTo:$,clickConnecting:M,isPossibleEndHandle:D,connectionInProcess:j,clickConnectionInProcess:T,valid:L}=Z(Ph(b,p,e),ne);b||(C=(k=v.getState()).onError)==null||C.call(k,"010",xe.error010());const H=S=>{const{defaultEdgeOptions:I,onConnect:E,hasDefaultEdges:P}=v.getState(),B={...I,...S};if(P){const{edges:V,setEdges:X}=v.getState();X(Fs(B,V))}E==null||E(B),a==null||a(B)},R=S=>{if(!b)return;const I=Rs(S.nativeEvent);if(r&&(I&&S.button===0||!I)){const E=v.getState();Vn.onPointerDown(S.nativeEvent,{autoPanOnConnect:E.autoPanOnConnect,connectionMode:E.connectionMode,connectionRadius:E.connectionRadius,domNode:E.domNode,nodeLookup:E.nodeLookup,lib:E.lib,isTarget:y,handleId:p,nodeId:b,flowId:E.rfId,panBy:E.panBy,cancelConnection:E.cancelConnection,onConnectStart:E.onConnectStart,onConnectEnd:E.onConnectEnd,updateConnection:E.updateConnection,onConnect:H,isValidConnection:n||E.isValidConnection,getTransform:()=>v.getState().transform,getFromHandle:()=>v.getState().connection.fromHandle,autoPanSpeed:E.autoPanSpeed})}I?d==null||d(S):f==null||f(S)},x=S=>{const{onClickConnectStart:I,onClickConnectEnd:E,connectionClickStartHandle:P,connectionMode:B,isValidConnection:V,lib:X,rfId:W,nodeLookup:z,connection:O}=v.getState();if(!b||!P&&!r)return;if(!P){I==null||I(S.nativeEvent,{nodeId:b,handleId:p,handleType:e}),v.setState({connectionClickStartHandle:{nodeId:b,type:e,id:p}});return}const F=Ds(S.target),Y=n||V,{connection:U,isValid:J}=Vn.isValid(S.nativeEvent,{handle:{nodeId:b,id:p,type:e},connectionMode:B,fromNodeId:P.nodeId,fromHandleId:P.id||null,fromType:P.type,isValidConnection:Y,flowId:W,doc:F,lib:X,nodeLookup:z});J&&U&&H(U);const K=structuredClone(O);delete K.inProgress,K.toPosition=K.toHandle?K.toHandle.position:null,E==null||E(S,K),v.setState({connectionClickStartHandle:null})};return g.jsx("div",{"data-handleid":p,"data-nodeid":b,"data-handlepos":t,"data-id":`${w}-${b}-${p}-${e}`,className:oe(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",m,u,{source:!y,target:y,connectable:o,connectablestart:r,connectableend:s,clickconnecting:M,connectingfrom:A,connectingto:$,valid:L,connectionindicator:o&&(!j||D)&&(j||T?s:r)}]),onMouseDown:R,onTouchStart:R,onClick:_?x:void 0,ref:h,...c,children:l})}const Qe=N.memo(ai(Th));function Dh({data:e,isConnectable:t,sourcePosition:n=q.Bottom}){return g.jsxs(g.Fragment,{children:[e==null?void 0:e.label,g.jsx(Qe,{type:"source",position:n,isConnectable:t})]})}function zh({data:e,isConnectable:t,targetPosition:n=q.Top,sourcePosition:o=q.Bottom}){return g.jsxs(g.Fragment,{children:[g.jsx(Qe,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label,g.jsx(Qe,{type:"source",position:o,isConnectable:t})]})}function Rh(){return null}function Hh({data:e,isConnectable:t,targetPosition:n=q.Top}){return g.jsxs(g.Fragment,{children:[g.jsx(Qe,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label]})}const Qt={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},xr={input:Dh,default:zh,output:Hh,group:Rh};function Lh(e){var t,n,o,r;return e.internals.handleBounds===void 0?{width:e.width??e.initialWidth??((t=e.style)==null?void 0:t.width),height:e.height??e.initialHeight??((n=e.style)==null?void 0:n.height)}:{width:e.width??((o=e.style)==null?void 0:o.width),height:e.height??((r=e.style)==null?void 0:r.height)}}const Bh=e=>{const{width:t,height:n,x:o,y:r}=Et(e.nodeLookup,{filter:s=>!!s.selected});return{width:ge(t)?t:null,height:ge(n)?n:null,userSelectionActive:e.userSelectionActive,transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${o}px,${r}px)`}};function Fh({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const o=te(),{width:r,height:s,transformString:i,userSelectionActive:a}=Z(Bh,ne),l=ui(),u=N.useRef(null);if(N.useEffect(()=>{var c;n||(c=u.current)==null||c.focus({preventScroll:!0})},[n]),li({nodeRef:u}),a||!r||!s)return null;const d=e?c=>{const h=o.getState().nodes.filter(p=>p.selected);e(c,h)}:void 0,f=c=>{Object.prototype.hasOwnProperty.call(Qt,c.key)&&(c.preventDefault(),l({direction:Qt[c.key],factor:c.shiftKey?4:1}))};return g.jsx("div",{className:oe(["react-flow__nodesselection","react-flow__container",t]),style:{transform:i},children:g.jsx("div",{ref:u,className:"react-flow__nodesselection-rect",onContextMenu:d,tabIndex:n?void 0:-1,onKeyDown:n?void 0:f,style:{width:r,height:s}})})}const yr=typeof window<"u"?window:void 0,Oh=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function fi({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:r,onPaneContextMenu:s,onPaneScroll:i,paneClickDistance:a,deleteKeyCode:l,selectionKeyCode:u,selectionOnDrag:d,selectionMode:f,onSelectionStart:c,onSelectionEnd:h,multiSelectionKeyCode:p,panActivationKeyCode:y,zoomActivationKeyCode:v,elementsSelectable:b,zoomOnScroll:_,zoomOnPinch:m,panOnScroll:w,panOnScrollSpeed:A,panOnScrollMode:$,zoomOnDoubleClick:M,panOnDrag:D,defaultViewport:j,translateExtent:T,minZoom:L,maxZoom:H,preventScrolling:R,onSelectionContextMenu:x,noWheelClassName:k,noPanClassName:C,disableKeyboardA11y:S,onViewportChange:I,isControlledViewport:E}){const{nodesSelectionActive:P,userSelectionActive:B}=Z(Oh),V=vt(u,{target:yr}),X=vt(y,{target:yr}),W=X||D,z=X||w,O=d&&W!==!0,F=V||B||O;return Nh({deleteKeyCode:l,multiSelectionKeyCode:p}),g.jsx(Eh,{onPaneContextMenu:s,elementsSelectable:b,zoomOnScroll:_,zoomOnPinch:m,panOnScroll:z,panOnScrollSpeed:A,panOnScrollMode:$,zoomOnDoubleClick:M,panOnDrag:!V&&W,defaultViewport:j,translateExtent:T,minZoom:L,maxZoom:H,zoomActivationKeyCode:v,preventScrolling:R,noWheelClassName:k,noPanClassName:C,onViewportChange:I,isControlledViewport:E,paneClickDistance:a,children:g.jsxs(Ah,{onSelectionStart:c,onSelectionEnd:h,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:r,onPaneContextMenu:s,onPaneScroll:i,panOnDrag:W,isSelecting:!!F,selectionMode:f,selectionKeyPressed:V,selectionOnDrag:O,children:[e,P&&g.jsx(Fh,{onSelectionContextMenu:x,noPanClassName:C,disableKeyboardA11y:S})]})})}fi.displayName="FlowRenderer";const Vh=N.memo(fi),Yh=e=>t=>e?Ms(t.nodeLookup,{x:0,y:0,width:t.width,height:t.height},t.transform,!0).map(n=>n.id):Array.from(t.nodeLookup.keys());function Xh(e){return Z(N.useCallback(Yh(e),[e]),ne)}const Wh=e=>e.updateNodeInternals;function qh(){const e=Z(Wh),[t]=N.useState(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(n=>{const o=new Map;n.forEach(r=>{const s=r.target.getAttribute("data-id");o.set(s,{id:s,nodeElement:r.target,force:!0})}),e(o)}));return N.useEffect(()=>()=>{t==null||t.disconnect()},[t]),t}function Gh({node:e,nodeType:t,hasDimensions:n,resizeObserver:o}){const r=te(),s=N.useRef(null),i=N.useRef(null),a=N.useRef(e.sourcePosition),l=N.useRef(e.targetPosition),u=N.useRef(t),d=n&&!!e.internals.handleBounds;return N.useEffect(()=>{s.current&&!e.hidden&&(!d||i.current!==s.current)&&(i.current&&(o==null||o.unobserve(i.current)),o==null||o.observe(s.current),i.current=s.current)},[d,e.hidden]),N.useEffect(()=>()=>{i.current&&(o==null||o.unobserve(i.current),i.current=null)},[]),N.useEffect(()=>{if(s.current){const f=u.current!==t,c=a.current!==e.sourcePosition,h=l.current!==e.targetPosition;(f||c||h)&&(u.current=t,a.current=e.sourcePosition,l.current=e.targetPosition,r.getState().updateNodeInternals(new Map([[e.id,{id:e.id,nodeElement:s.current,force:!0}]])))}},[e.id,t,e.sourcePosition,e.targetPosition]),s}function Uh({id:e,onClick:t,onMouseEnter:n,onMouseMove:o,onMouseLeave:r,onContextMenu:s,onDoubleClick:i,nodesDraggable:a,elementsSelectable:l,nodesConnectable:u,nodesFocusable:d,resizeObserver:f,noDragClassName:c,noPanClassName:h,disableKeyboardA11y:p,rfId:y,nodeTypes:v,nodeClickDistance:b,onError:_}){const{node:m,internals:w,isParent:A}=Z(F=>{const Y=F.nodeLookup.get(e),U=F.parentLookup.has(e);return{node:Y,internals:Y.internals,isParent:U}},ne);let $=m.type||"default",M=(v==null?void 0:v[$])||xr[$];M===void 0&&(_==null||_("003",xe.error003($)),$="default",M=xr.default);const D=!!(m.draggable||a&&typeof m.draggable>"u"),j=!!(m.selectable||l&&typeof m.selectable>"u"),T=!!(m.connectable||u&&typeof m.connectable>"u"),L=!!(m.focusable||d&&typeof m.focusable>"u"),H=te(),R=Ps(m),x=Gh({node:m,nodeType:$,hasDimensions:R,resizeObserver:f}),k=li({nodeRef:x,disabled:m.hidden||!D,noDragClassName:c,handleSelector:m.dragHandle,nodeId:e,isSelectable:j,nodeClickDistance:b}),C=ui();if(m.hidden)return null;const S=_e(m),I=Lh(m),E=j||D||t||n||o||r,P=n?F=>n(F,{...w.userNode}):void 0,B=o?F=>o(F,{...w.userNode}):void 0,V=r?F=>r(F,{...w.userNode}):void 0,X=s?F=>s(F,{...w.userNode}):void 0,W=i?F=>i(F,{...w.userNode}):void 0,z=F=>{const{selectNodesOnDrag:Y,nodeDragThreshold:U}=H.getState();j&&(!Y||!D||U>0)&&Yn({id:e,store:H,nodeRef:x}),t&&t(F,{...w.userNode})},O=F=>{if(!(zs(F.nativeEvent)||p))if(Cs.includes(F.key)&&j){const Y=F.key==="Escape";Yn({id:e,store:H,unselect:Y,nodeRef:x})}else D&&m.selected&&Object.prototype.hasOwnProperty.call(Qt,F.key)&&(F.preventDefault(),H.setState({ariaLiveMessage:`Moved selected node ${F.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~w.positionAbsolute.x}, y: ${~~w.positionAbsolute.y}`}),C({direction:Qt[F.key],factor:F.shiftKey?4:1}))};return g.jsx("div",{className:oe(["react-flow__node",`react-flow__node-${$}`,{[h]:D},m.className,{selected:m.selected,selectable:j,parent:A,draggable:D,dragging:k}]),ref:x,style:{zIndex:w.z,transform:`translate(${w.positionAbsolute.x}px,${w.positionAbsolute.y}px)`,pointerEvents:E?"all":"none",visibility:R?"visible":"hidden",...m.style,...I},"data-id":e,"data-testid":`rf__node-${e}`,onMouseEnter:P,onMouseMove:B,onMouseLeave:V,onContextMenu:X,onClick:z,onDoubleClick:W,onKeyDown:L?O:void 0,tabIndex:L?0:void 0,role:L?"button":void 0,"aria-describedby":p?void 0:`${ti}-${y}`,"aria-label":m.ariaLabel,children:g.jsx($h,{value:e,children:g.jsx(M,{id:e,data:m.data,type:$,positionAbsoluteX:w.positionAbsolute.x,positionAbsoluteY:w.positionAbsolute.y,selected:m.selected??!1,selectable:j,draggable:D,deletable:m.deletable??!0,isConnectable:T,sourcePosition:m.sourcePosition,targetPosition:m.targetPosition,dragging:k,dragHandle:m.dragHandle,zIndex:w.z,parentId:m.parentId,...S})})})}const Kh=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function hi(e){const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:o,elementsSelectable:r,onError:s}=Z(Kh,ne),i=Xh(e.onlyRenderVisibleElements),a=qh();return g.jsx("div",{className:"react-flow__nodes",style:dn,children:i.map(l=>g.jsx(Uh,{id:l,nodeTypes:e.nodeTypes,nodeExtent:e.nodeExtent,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,resizeObserver:a,nodesDraggable:t,nodesConnectable:n,nodesFocusable:o,elementsSelectable:r,nodeClickDistance:e.nodeClickDistance,onError:s},l))})}hi.displayName="NodeRenderer";const Zh=N.memo(hi);function Qh(e){return Z(N.useCallback(n=>{if(!e)return n.edges.map(r=>r.id);const o=[];if(n.width&&n.height)for(const r of n.edges){const s=n.nodeLookup.get(r.source),i=n.nodeLookup.get(r.target);s&&i&&rf({sourceNode:s,targetNode:i,width:n.width,height:n.height,transform:n.transform})&&o.push(r.id)}return o},[e]),ne)}const Jh=({color:e="none",strokeWidth:t=1})=>g.jsx("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),eg=({color:e="none",strokeWidth:t=1})=>g.jsx("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),wr={[Gt.Arrow]:Jh,[Gt.ArrowClosed]:eg};function tg(e){const t=te();return N.useMemo(()=>{var r,s;return Object.prototype.hasOwnProperty.call(wr,e)?wr[e]:((s=(r=t.getState()).onError)==null||s.call(r,"009",xe.error009(e)),null)},[e])}const ng=({id:e,type:t,color:n,width:o=12.5,height:r=12.5,markerUnits:s="strokeWidth",strokeWidth:i,orient:a="auto-start-reverse"})=>{const l=tg(t);return l?g.jsx("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${o}`,markerHeight:`${r}`,viewBox:"-10 -10 20 20",markerUnits:s,orient:a,refX:"0",refY:"0",children:g.jsx(l,{color:n,strokeWidth:i})}):null},gi=({defaultColor:e,rfId:t})=>{const n=Z(s=>s.edges),o=Z(s=>s.defaultEdgeOptions),r=N.useMemo(()=>ff(n,{id:t,defaultColor:e,defaultMarkerStart:o==null?void 0:o.markerStart,defaultMarkerEnd:o==null?void 0:o.markerEnd}),[n,o,t,e]);return r.length?g.jsx("svg",{className:"react-flow__marker",children:g.jsx("defs",{children:r.map(s=>g.jsx(ng,{id:s.id,type:s.type,color:s.color,width:s.width,height:s.height,markerUnits:s.markerUnits,strokeWidth:s.strokeWidth,orient:s.orient},s.id))})}):null};gi.displayName="MarkerDefinitions";var og=N.memo(gi);function pi({x:e,y:t,label:n,labelStyle:o,labelShowBg:r=!0,labelBgStyle:s,labelBgPadding:i=[2,4],labelBgBorderRadius:a=2,children:l,className:u,...d}){const[f,c]=N.useState({x:1,y:0,width:0,height:0}),h=oe(["react-flow__edge-textwrapper",u]),p=N.useRef(null);return N.useEffect(()=>{if(p.current){const y=p.current.getBBox();c({x:y.x,y:y.y,width:y.width,height:y.height})}},[n]),n?g.jsxs("g",{transform:`translate(${e-f.width/2} ${t-f.height/2})`,className:h,visibility:f.width?"visible":"hidden",...d,children:[r&&g.jsx("rect",{width:f.width+2*i[0],x:-i[0],y:-i[1],height:f.height+2*i[1],className:"react-flow__edge-textbg",style:s,rx:a,ry:a}),g.jsx("text",{className:"react-flow__edge-text",y:f.height/2,dy:"0.3em",ref:p,style:o,children:n}),l]}):null}pi.displayName="EdgeText";const rg=N.memo(pi);function fn({path:e,labelX:t,labelY:n,label:o,labelStyle:r,labelShowBg:s,labelBgStyle:i,labelBgPadding:a,labelBgBorderRadius:l,interactionWidth:u=20,...d}){return g.jsxs(g.Fragment,{children:[g.jsx("path",{...d,d:e,fill:"none",className:oe(["react-flow__edge-path",d.className])}),u&&g.jsx("path",{d:e,fill:"none",strokeOpacity:0,strokeWidth:u,className:"react-flow__edge-interaction"}),o&&ge(t)&&ge(n)?g.jsx(rg,{x:t,y:n,label:o,labelStyle:r,labelShowBg:s,labelBgStyle:i,labelBgPadding:a,labelBgBorderRadius:l}):null]})}function br({pos:e,x1:t,y1:n,x2:o,y2:r}){return e===q.Left||e===q.Right?[.5*(t+o),n]:[t,.5*(n+r)]}function mi({sourceX:e,sourceY:t,sourcePosition:n=q.Bottom,targetX:o,targetY:r,targetPosition:s=q.Top}){const[i,a]=br({pos:n,x1:e,y1:t,x2:o,y2:r}),[l,u]=br({pos:s,x1:o,y1:r,x2:e,y2:t}),[d,f,c,h]=Hs({sourceX:e,sourceY:t,targetX:o,targetY:r,sourceControlX:i,sourceControlY:a,targetControlX:l,targetControlY:u});return[`M${e},${t} C${i},${a} ${l},${u} ${o},${r}`,d,f,c,h]}function xi(e){return N.memo(({id:t,sourceX:n,sourceY:o,targetX:r,targetY:s,sourcePosition:i=q.Bottom,targetPosition:a=q.Top,label:l,labelStyle:u,labelShowBg:d,labelBgStyle:f,labelBgPadding:c,labelBgBorderRadius:h,style:p,markerEnd:y,markerStart:v,interactionWidth:b})=>{const[_,m,w]=mi({sourceX:n,sourceY:o,sourcePosition:i,targetX:r,targetY:s,targetPosition:a}),A=e.isInternal?void 0:t;return g.jsx(fn,{id:A,path:_,labelX:m,labelY:w,label:l,labelStyle:u,labelShowBg:d,labelBgStyle:f,labelBgPadding:c,labelBgBorderRadius:h,style:p,markerEnd:y,markerStart:v,interactionWidth:b})})}const sg=xi({isInternal:!1}),yi=xi({isInternal:!0});sg.displayName="SimpleBezierEdge";yi.displayName="SimpleBezierEdgeInternal";function wi(e){return N.memo(({id:t,sourceX:n,sourceY:o,targetX:r,targetY:s,label:i,labelStyle:a,labelShowBg:l,labelBgStyle:u,labelBgPadding:d,labelBgBorderRadius:f,style:c,sourcePosition:h=q.Bottom,targetPosition:p=q.Top,markerEnd:y,markerStart:v,pathOptions:b,interactionWidth:_})=>{const[m,w,A]=Bn({sourceX:n,sourceY:o,sourcePosition:h,targetX:r,targetY:s,targetPosition:p,borderRadius:b==null?void 0:b.borderRadius,offset:b==null?void 0:b.offset}),$=e.isInternal?void 0:t;return g.jsx(fn,{id:$,path:m,labelX:w,labelY:A,label:i,labelStyle:a,labelShowBg:l,labelBgStyle:u,labelBgPadding:d,labelBgBorderRadius:f,style:c,markerEnd:y,markerStart:v,interactionWidth:_})})}const bi=wi({isInternal:!1}),vi=wi({isInternal:!0});bi.displayName="SmoothStepEdge";vi.displayName="SmoothStepEdgeInternal";function Ni(e){return N.memo(({id:t,...n})=>{var r;const o=e.isInternal?void 0:t;return g.jsx(bi,{...n,id:o,pathOptions:N.useMemo(()=>{var s;return{borderRadius:0,offset:(s=n.pathOptions)==null?void 0:s.offset}},[(r=n.pathOptions)==null?void 0:r.offset])})})}const ig=Ni({isInternal:!1}),_i=Ni({isInternal:!0});ig.displayName="StepEdge";_i.displayName="StepEdgeInternal";function Ci(e){return N.memo(({id:t,sourceX:n,sourceY:o,targetX:r,targetY:s,label:i,labelStyle:a,labelShowBg:l,labelBgStyle:u,labelBgPadding:d,labelBgBorderRadius:f,style:c,markerEnd:h,markerStart:p,interactionWidth:y})=>{const[v,b,_]=Os({sourceX:n,sourceY:o,targetX:r,targetY:s}),m=e.isInternal?void 0:t;return g.jsx(fn,{id:m,path:v,labelX:b,labelY:_,label:i,labelStyle:a,labelShowBg:l,labelBgStyle:u,labelBgPadding:d,labelBgBorderRadius:f,style:c,markerEnd:h,markerStart:p,interactionWidth:y})})}const ag=Ci({isInternal:!1}),Ei=Ci({isInternal:!0});ag.displayName="StraightEdge";Ei.displayName="StraightEdgeInternal";function Si(e){return N.memo(({id:t,sourceX:n,sourceY:o,targetX:r,targetY:s,sourcePosition:i=q.Bottom,targetPosition:a=q.Top,label:l,labelStyle:u,labelShowBg:d,labelBgStyle:f,labelBgPadding:c,labelBgBorderRadius:h,style:p,markerEnd:y,markerStart:v,pathOptions:b,interactionWidth:_})=>{const[m,w,A]=Ls({sourceX:n,sourceY:o,sourcePosition:i,targetX:r,targetY:s,targetPosition:a,curvature:b==null?void 0:b.curvature}),$=e.isInternal?void 0:t;return g.jsx(fn,{id:$,path:m,labelX:w,labelY:A,label:l,labelStyle:u,labelShowBg:d,labelBgStyle:f,labelBgPadding:c,labelBgBorderRadius:h,style:p,markerEnd:y,markerStart:v,interactionWidth:_})})}const cg=Si({isInternal:!1}),ki=Si({isInternal:!0});cg.displayName="BezierEdge";ki.displayName="BezierEdgeInternal";const vr={default:ki,straight:Ei,step:_i,smoothstep:vi,simplebezier:yi},Nr={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},lg=(e,t,n)=>n===q.Left?e-t:n===q.Right?e+t:e,ug=(e,t,n)=>n===q.Top?e-t:n===q.Bottom?e+t:e,_r="react-flow__edgeupdater";function Cr({position:e,centerX:t,centerY:n,radius:o=10,onMouseDown:r,onMouseEnter:s,onMouseOut:i,type:a}){return g.jsx("circle",{onMouseDown:r,onMouseEnter:s,onMouseOut:i,className:oe([_r,`${_r}-${a}`]),cx:lg(t,o,e),cy:ug(n,o,e),r:o,stroke:"transparent",fill:"transparent"})}function dg({isReconnectable:e,reconnectRadius:t,edge:n,sourceX:o,sourceY:r,targetX:s,targetY:i,sourcePosition:a,targetPosition:l,onReconnect:u,onReconnectStart:d,onReconnectEnd:f,setReconnecting:c,setUpdateHover:h}){const p=te(),y=(w,A)=>{if(w.button!==0)return;const{autoPanOnConnect:$,domNode:M,isValidConnection:D,connectionMode:j,connectionRadius:T,lib:L,onConnectStart:H,onConnectEnd:R,cancelConnection:x,nodeLookup:k,rfId:C,panBy:S,updateConnection:I}=p.getState(),E=A.type==="target";c(!0),d==null||d(w,n,A.type);const P=(V,X)=>{c(!1),f==null||f(V,n,A.type,X)},B=V=>u==null?void 0:u(n,V);Vn.onPointerDown(w.nativeEvent,{autoPanOnConnect:$,connectionMode:j,connectionRadius:T,domNode:M,handleId:A.id,nodeId:A.nodeId,nodeLookup:k,isTarget:E,edgeUpdaterType:A.type,lib:L,flowId:C,cancelConnection:x,panBy:S,isValidConnection:D,onConnect:B,onConnectStart:H,onConnectEnd:R,onReconnectEnd:P,updateConnection:I,getTransform:()=>p.getState().transform,getFromHandle:()=>p.getState().connection.fromHandle})},v=w=>y(w,{nodeId:n.target,id:n.targetHandle??null,type:"target"}),b=w=>y(w,{nodeId:n.source,id:n.sourceHandle??null,type:"source"}),_=()=>h(!0),m=()=>h(!1);return g.jsxs(g.Fragment,{children:[(e===!0||e==="source")&&g.jsx(Cr,{position:a,centerX:o,centerY:r,radius:t,onMouseDown:v,onMouseEnter:_,onMouseOut:m,type:"source"}),(e===!0||e==="target")&&g.jsx(Cr,{position:l,centerX:s,centerY:i,radius:t,onMouseDown:b,onMouseEnter:_,onMouseOut:m,type:"target"})]})}function fg({id:e,edgesFocusable:t,edgesReconnectable:n,elementsSelectable:o,onClick:r,onDoubleClick:s,onContextMenu:i,onMouseEnter:a,onMouseMove:l,onMouseLeave:u,reconnectRadius:d,onReconnect:f,onReconnectStart:c,onReconnectEnd:h,rfId:p,edgeTypes:y,noPanClassName:v,onError:b,disableKeyboardA11y:_}){let m=Z(G=>G.edgeLookup.get(e));const w=Z(G=>G.defaultEdgeOptions);m=w?{...w,...m}:m;let A=m.type||"default",$=(y==null?void 0:y[A])||vr[A];$===void 0&&(b==null||b("011",xe.error011(A)),A="default",$=vr.default);const M=!!(m.focusable||t&&typeof m.focusable>"u"),D=typeof f<"u"&&(m.reconnectable||n&&typeof m.reconnectable>"u"),j=!!(m.selectable||o&&typeof m.selectable>"u"),T=N.useRef(null),[L,H]=N.useState(!1),[R,x]=N.useState(!1),k=te(),{zIndex:C,sourceX:S,sourceY:I,targetX:E,targetY:P,sourcePosition:B,targetPosition:V}=Z(N.useCallback(G=>{const ee=G.nodeLookup.get(m.source),Q=G.nodeLookup.get(m.target);if(!ee||!Q)return{zIndex:m.zIndex,...Nr};const re=df({id:e,sourceNode:ee,targetNode:Q,sourceHandle:m.sourceHandle||null,targetHandle:m.targetHandle||null,connectionMode:G.connectionMode,onError:b});return{zIndex:of({selected:m.selected,zIndex:m.zIndex,sourceNode:ee,targetNode:Q,elevateOnSelect:G.elevateEdgesOnSelect}),...re||Nr}},[m.source,m.target,m.sourceHandle,m.targetHandle,m.selected,m.zIndex]),ne),X=N.useMemo(()=>m.markerStart?`url('#${Fn(m.markerStart,p)}')`:void 0,[m.markerStart,p]),W=N.useMemo(()=>m.markerEnd?`url('#${Fn(m.markerEnd,p)}')`:void 0,[m.markerEnd,p]);if(m.hidden||S===null||I===null||E===null||P===null)return null;const z=G=>{var ue;const{addSelectedEdges:ee,unselectNodesAndEdges:Q,multiSelectionActive:re}=k.getState();j&&(k.setState({nodesSelectionActive:!1}),m.selected&&re?(Q({nodes:[],edges:[m]}),(ue=T.current)==null||ue.blur()):ee([e])),r&&r(G,m)},O=s?G=>{s(G,{...m})}:void 0,F=i?G=>{i(G,{...m})}:void 0,Y=a?G=>{a(G,{...m})}:void 0,U=l?G=>{l(G,{...m})}:void 0,J=u?G=>{u(G,{...m})}:void 0,K=G=>{var ee;if(!_&&Cs.includes(G.key)&&j){const{unselectNodesAndEdges:Q,addSelectedEdges:re}=k.getState();G.key==="Escape"?((ee=T.current)==null||ee.blur(),Q({edges:[m]})):re([e])}};return g.jsx("svg",{style:{zIndex:C},children:g.jsxs("g",{className:oe(["react-flow__edge",`react-flow__edge-${A}`,m.className,v,{selected:m.selected,animated:m.animated,inactive:!j&&!r,updating:L,selectable:j}]),onClick:z,onDoubleClick:O,onContextMenu:F,onMouseEnter:Y,onMouseMove:U,onMouseLeave:J,onKeyDown:M?K:void 0,tabIndex:M?0:void 0,role:M?"button":"img","data-id":e,"data-testid":`rf__edge-${e}`,"aria-label":m.ariaLabel===null?void 0:m.ariaLabel||`Edge from ${m.source} to ${m.target}`,"aria-describedby":M?`${ni}-${p}`:void 0,ref:T,children:[!R&&g.jsx($,{id:e,source:m.source,target:m.target,type:m.type,selected:m.selected,animated:m.animated,selectable:j,deletable:m.deletable??!0,label:m.label,labelStyle:m.labelStyle,labelShowBg:m.labelShowBg,labelBgStyle:m.labelBgStyle,labelBgPadding:m.labelBgPadding,labelBgBorderRadius:m.labelBgBorderRadius,sourceX:S,sourceY:I,targetX:E,targetY:P,sourcePosition:B,targetPosition:V,data:m.data,style:m.style,sourceHandleId:m.sourceHandle,targetHandleId:m.targetHandle,markerStart:X,markerEnd:W,pathOptions:"pathOptions"in m?m.pathOptions:void 0,interactionWidth:m.interactionWidth}),D&&g.jsx(dg,{edge:m,isReconnectable:D,reconnectRadius:d,onReconnect:f,onReconnectStart:c,onReconnectEnd:h,sourceX:S,sourceY:I,targetX:E,targetY:P,sourcePosition:B,targetPosition:V,setUpdateHover:H,setReconnecting:x})]})})}const hg=e=>({edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function Mi({defaultMarkerColor:e,onlyRenderVisibleElements:t,rfId:n,edgeTypes:o,noPanClassName:r,onReconnect:s,onEdgeContextMenu:i,onEdgeMouseEnter:a,onEdgeMouseMove:l,onEdgeMouseLeave:u,onEdgeClick:d,reconnectRadius:f,onEdgeDoubleClick:c,onReconnectStart:h,onReconnectEnd:p,disableKeyboardA11y:y}){const{edgesFocusable:v,edgesReconnectable:b,elementsSelectable:_,onError:m}=Z(hg,ne),w=Qh(t);return g.jsxs("div",{className:"react-flow__edges",children:[g.jsx(og,{defaultColor:e,rfId:n}),w.map(A=>g.jsx(fg,{id:A,edgesFocusable:v,edgesReconnectable:b,elementsSelectable:_,noPanClassName:r,onReconnect:s,onContextMenu:i,onMouseEnter:a,onMouseMove:l,onMouseLeave:u,onClick:d,reconnectRadius:f,onDoubleClick:c,onReconnectStart:h,onReconnectEnd:p,rfId:n,onError:m,edgeTypes:o,disableKeyboardA11y:y},A))]})}Mi.displayName="EdgeRenderer";const gg=N.memo(Mi),pg=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function mg({children:e}){const t=Z(pg);return g.jsx("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:t},children:e})}function xg(e){const t=go(),n=N.useRef(!1);N.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const yg=e=>{var t;return(t=e.panZoom)==null?void 0:t.syncViewport};function wg(e){const t=Z(yg),n=te();return N.useEffect(()=>{e&&(t==null||t(e),n.setState({transform:[e.x,e.y,e.zoom]}))},[e,t]),null}function bg(e){return e.connection.inProgress?{...e.connection,to:St(e.connection.to,e.transform)}:{...e.connection}}function vg(e){return bg}function Ng(e){const t=vg();return Z(t,ne)}const _g=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function Cg({containerStyle:e,style:t,type:n,component:o}){const{nodesConnectable:r,width:s,height:i,isValid:a,inProgress:l}=Z(_g,ne);return!(s&&r&&l)?null:g.jsx("svg",{style:e,width:s,height:i,className:"react-flow__connectionline react-flow__container",children:g.jsx("g",{className:oe(["react-flow__connection",Ss(a)]),children:g.jsx(Ai,{style:t,type:n,CustomComponent:o,isValid:a})})})}const Ai=({style:e,type:t=ke.Bezier,CustomComponent:n,isValid:o})=>{const{inProgress:r,from:s,fromNode:i,fromHandle:a,fromPosition:l,to:u,toNode:d,toHandle:f,toPosition:c}=Ng();if(!r)return;if(n)return g.jsx(n,{connectionLineType:t,connectionLineStyle:e,fromNode:i,fromHandle:a,fromX:s.x,fromY:s.y,toX:u.x,toY:u.y,fromPosition:l,toPosition:c,connectionStatus:Ss(o),toNode:d,toHandle:f});let h="";const p={sourceX:s.x,sourceY:s.y,sourcePosition:l,targetX:u.x,targetY:u.y,targetPosition:c};switch(t){case ke.Bezier:[h]=Ls(p);break;case ke.SimpleBezier:[h]=mi(p);break;case ke.Step:[h]=Bn({...p,borderRadius:0});break;case ke.SmoothStep:[h]=Bn(p);break;default:[h]=Os(p)}return g.jsx("path",{d:h,fill:"none",className:"react-flow__connection-path",style:e})};Ai.displayName="ConnectionLine";const Eg={};function Er(e=Eg){N.useRef(e),te(),N.useEffect(()=>{},[e])}function Sg(){te(),N.useRef(!1),N.useEffect(()=>{},[])}function Ii({nodeTypes:e,edgeTypes:t,onInit:n,onNodeClick:o,onEdgeClick:r,onNodeDoubleClick:s,onEdgeDoubleClick:i,onNodeMouseEnter:a,onNodeMouseMove:l,onNodeMouseLeave:u,onNodeContextMenu:d,onSelectionContextMenu:f,onSelectionStart:c,onSelectionEnd:h,connectionLineType:p,connectionLineStyle:y,connectionLineComponent:v,connectionLineContainerStyle:b,selectionKeyCode:_,selectionOnDrag:m,selectionMode:w,multiSelectionKeyCode:A,panActivationKeyCode:$,zoomActivationKeyCode:M,deleteKeyCode:D,onlyRenderVisibleElements:j,elementsSelectable:T,defaultViewport:L,translateExtent:H,minZoom:R,maxZoom:x,preventScrolling:k,defaultMarkerColor:C,zoomOnScroll:S,zoomOnPinch:I,panOnScroll:E,panOnScrollSpeed:P,panOnScrollMode:B,zoomOnDoubleClick:V,panOnDrag:X,onPaneClick:W,onPaneMouseEnter:z,onPaneMouseMove:O,onPaneMouseLeave:F,onPaneScroll:Y,onPaneContextMenu:U,paneClickDistance:J,nodeClickDistance:K,onEdgeContextMenu:G,onEdgeMouseEnter:ee,onEdgeMouseMove:Q,onEdgeMouseLeave:re,reconnectRadius:ue,onReconnect:Le,onReconnectStart:hn,onReconnectEnd:gn,noDragClassName:Je,noWheelClassName:pn,noPanClassName:et,disableKeyboardA11y:tt,nodeExtent:mn,rfId:nt,viewport:ot,onViewportChange:kt}){return Er(e),Er(t),Sg(),xg(n),wg(ot),g.jsx(Vh,{onPaneClick:W,onPaneMouseEnter:z,onPaneMouseMove:O,onPaneMouseLeave:F,onPaneContextMenu:U,onPaneScroll:Y,paneClickDistance:J,deleteKeyCode:D,selectionKeyCode:_,selectionOnDrag:m,selectionMode:w,onSelectionStart:c,onSelectionEnd:h,multiSelectionKeyCode:A,panActivationKeyCode:$,zoomActivationKeyCode:M,elementsSelectable:T,zoomOnScroll:S,zoomOnPinch:I,zoomOnDoubleClick:V,panOnScroll:E,panOnScrollSpeed:P,panOnScrollMode:B,panOnDrag:X,defaultViewport:L,translateExtent:H,minZoom:R,maxZoom:x,onSelectionContextMenu:f,preventScrolling:k,noDragClassName:Je,noWheelClassName:pn,noPanClassName:et,disableKeyboardA11y:tt,onViewportChange:kt,isControlledViewport:!!ot,children:g.jsxs(mg,{children:[g.jsx(gg,{edgeTypes:t,onEdgeClick:r,onEdgeDoubleClick:i,onReconnect:Le,onReconnectStart:hn,onReconnectEnd:gn,onlyRenderVisibleElements:j,onEdgeContextMenu:G,onEdgeMouseEnter:ee,onEdgeMouseMove:Q,onEdgeMouseLeave:re,reconnectRadius:ue,defaultMarkerColor:C,noPanClassName:et,disableKeyboardA11y:tt,rfId:nt}),g.jsx(Cg,{style:y,type:p,component:v,containerStyle:b}),g.jsx("div",{className:"react-flow__edgelabel-renderer"}),g.jsx(Zh,{nodeTypes:e,onNodeClick:o,onNodeDoubleClick:s,onNodeMouseEnter:a,onNodeMouseMove:l,onNodeMouseLeave:u,onNodeContextMenu:d,nodeClickDistance:K,onlyRenderVisibleElements:j,noPanClassName:et,noDragClassName:Je,disableKeyboardA11y:tt,nodeExtent:mn,rfId:nt}),g.jsx("div",{className:"react-flow__viewport-portal"})]})})}Ii.displayName="GraphView";const kg=N.memo(Ii),Sr=({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,width:r,height:s,fitView:i,nodeOrigin:a,nodeExtent:l}={})=>{const u=new Map,d=new Map,f=new Map,c=new Map,h=o??t??[],p=n??e??[],y=a??[0,0],v=l??xt;Ys(f,c,h),On(p,u,d,{nodeOrigin:y,nodeExtent:v,elevateNodesOnSelect:!1});let b=[0,0,1];if(i&&r&&s){const _=Et(u,{filter:$=>!!(($.width||$.initialWidth)&&($.height||$.initialHeight))}),{x:m,y:w,zoom:A}=ao(_,r,s,.5,2,.1);b=[m,w,A]}return{rfId:"1",width:0,height:0,transform:b,nodes:p,nodeLookup:u,parentLookup:d,edges:h,edgeLookup:c,connectionLookup:f,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:n!==void 0,hasDefaultEdges:o!==void 0,panZoom:null,minZoom:.5,maxZoom:2,translateExtent:xt,nodeExtent:v,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:Ge.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:y,nodeDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!1,selectNodesOnDrag:!0,multiSelectionActive:!1,fitViewQueued:i??!1,fitViewOptions:void 0,fitViewResolver:null,connection:{...Es},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanSpeed:15,connectionRadius:20,onError:Jd,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1}},Mg=({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,width:r,height:s,fitView:i,nodeOrigin:a,nodeExtent:l})=>qf((u,d)=>{async function f(){const{nodeLookup:c,panZoom:h,fitViewOptions:p,fitViewResolver:y,width:v,height:b,minZoom:_,maxZoom:m}=d();h&&(await Zd({nodes:c,width:v,height:b,panZoom:h,minZoom:_,maxZoom:m},p),y==null||y.resolve(!0),u({fitViewResolver:null}))}return{...Sr({nodes:e,edges:t,width:r,height:s,fitView:i,nodeOrigin:a,nodeExtent:l,defaultNodes:n,defaultEdges:o}),setNodes:c=>{const{nodeLookup:h,parentLookup:p,nodeOrigin:y,elevateNodesOnSelect:v,fitViewQueued:b}=d(),_=On(c,h,p,{nodeOrigin:y,nodeExtent:l,elevateNodesOnSelect:v,checkEquality:!0});b&&_?(f(),u({nodes:c,fitViewQueued:!1,fitViewOptions:void 0})):u({nodes:c})},setEdges:c=>{const{connectionLookup:h,edgeLookup:p}=d();Ys(h,p,c),u({edges:c})},setDefaultNodesAndEdges:(c,h)=>{if(c){const{setNodes:p}=d();p(c),u({hasDefaultNodes:!0})}if(h){const{setEdges:p}=d();p(h),u({hasDefaultEdges:!0})}},updateNodeInternals:c=>{const{triggerNodeChanges:h,nodeLookup:p,parentLookup:y,domNode:v,nodeOrigin:b,nodeExtent:_,debug:m,fitViewQueued:w}=d(),{changes:A,updatedInternals:$}=xf(c,p,y,v,b,_);$&&(gf(p,y,{nodeOrigin:b,nodeExtent:_}),w?(f(),u({fitViewQueued:!1,fitViewOptions:void 0})):u({}),(A==null?void 0:A.length)>0&&(m&&console.log("React Flow: trigger node changes",A),h==null||h(A)))},updateNodePositions:(c,h=!1)=>{const p=[],y=[],{nodeLookup:v,triggerNodeChanges:b}=d();for(const[_,m]of c){const w=v.get(_),A=!!(w!=null&&w.expandParent&&(w!=null&&w.parentId)&&(m!=null&&m.position)),$={id:_,type:"position",position:A?{x:Math.max(0,m.position.x),y:Math.max(0,m.position.y)}:m.position,dragging:h};A&&w.parentId&&p.push({id:_,parentId:w.parentId,rect:{...m.internals.positionAbsolute,width:m.measured.width??0,height:m.measured.height??0}}),y.push($)}if(p.length>0){const{parentLookup:_,nodeOrigin:m}=d(),w=ho(p,v,_,m);y.push(...w)}b(y)},triggerNodeChanges:c=>{const{onNodesChange:h,setNodes:p,nodes:y,hasDefaultNodes:v,debug:b}=d();if(c!=null&&c.length){if(v){const _=si(c,y);p(_)}b&&console.log("React Flow: trigger node changes",c),h==null||h(c)}},triggerEdgeChanges:c=>{const{onEdgesChange:h,setEdges:p,edges:y,hasDefaultEdges:v,debug:b}=d();if(c!=null&&c.length){if(v){const _=ii(c,y);p(_)}b&&console.log("React Flow: trigger edge changes",c),h==null||h(c)}},addSelectedNodes:c=>{const{multiSelectionActive:h,edgeLookup:p,nodeLookup:y,triggerNodeChanges:v,triggerEdgeChanges:b}=d();if(h){const _=c.map(m=>Pe(m,!0));v(_);return}v(Ve(y,new Set([...c]),!0)),b(Ve(p))},addSelectedEdges:c=>{const{multiSelectionActive:h,edgeLookup:p,nodeLookup:y,triggerNodeChanges:v,triggerEdgeChanges:b}=d();if(h){const _=c.map(m=>Pe(m,!0));b(_);return}b(Ve(p,new Set([...c]))),v(Ve(y,new Set,!0))},unselectNodesAndEdges:({nodes:c,edges:h}={})=>{const{edges:p,nodes:y,nodeLookup:v,triggerNodeChanges:b,triggerEdgeChanges:_}=d(),m=c||y,w=h||p,A=m.map(M=>{const D=v.get(M.id);return D&&(D.selected=!1),Pe(M.id,!1)}),$=w.map(M=>Pe(M.id,!1));b(A),_($)},setMinZoom:c=>{const{panZoom:h,maxZoom:p}=d();h==null||h.setScaleExtent([c,p]),u({minZoom:c})},setMaxZoom:c=>{const{panZoom:h,minZoom:p}=d();h==null||h.setScaleExtent([p,c]),u({maxZoom:c})},setTranslateExtent:c=>{var h;(h=d().panZoom)==null||h.setTranslateExtent(c),u({translateExtent:c})},setPaneClickDistance:c=>{var h;(h=d().panZoom)==null||h.setClickDistance(c)},resetSelectedElements:()=>{const{edges:c,nodes:h,triggerNodeChanges:p,triggerEdgeChanges:y}=d(),v=h.reduce((_,m)=>m.selected?[..._,Pe(m.id,!1)]:_,[]),b=c.reduce((_,m)=>m.selected?[..._,Pe(m.id,!1)]:_,[]);p(v),y(b)},setNodeExtent:c=>{const{nodes:h,nodeLookup:p,parentLookup:y,nodeOrigin:v,elevateNodesOnSelect:b,nodeExtent:_}=d();c[0][0]===_[0][0]&&c[0][1]===_[0][1]&&c[1][0]===_[1][0]&&c[1][1]===_[1][1]||(On(h,p,y,{nodeOrigin:v,nodeExtent:c,elevateNodesOnSelect:b,checkEquality:!1}),u({nodeExtent:c}))},panBy:c=>{const{transform:h,width:p,height:y,panZoom:v,translateExtent:b}=d();return yf({delta:c,panZoom:v,transform:h,translateExtent:b,width:p,height:y})},cancelConnection:()=>{u({connection:{...Es}})},updateConnection:c=>{u({connection:c})},reset:()=>u({...Sr()})}},Object.is);function Ag({initialNodes:e,initialEdges:t,defaultNodes:n,defaultEdges:o,initialWidth:r,initialHeight:s,fitView:i,nodeOrigin:a,nodeExtent:l,children:u}){const[d]=N.useState(()=>Mg({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,width:r,height:s,fitView:i,nodeOrigin:a,nodeExtent:l}));return g.jsx(Gf,{value:d,children:g.jsx(xh,{children:u})})}function Ig({children:e,nodes:t,edges:n,defaultNodes:o,defaultEdges:r,width:s,height:i,fitView:a,nodeOrigin:l,nodeExtent:u}){return N.useContext(ln)?g.jsx(g.Fragment,{children:e}):g.jsx(Ag,{initialNodes:t,initialEdges:n,defaultNodes:o,defaultEdges:r,initialWidth:s,initialHeight:i,fitView:a,nodeOrigin:l,nodeExtent:u,children:e})}const $g={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function jg({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,className:r,nodeTypes:s,edgeTypes:i,onNodeClick:a,onEdgeClick:l,onInit:u,onMove:d,onMoveStart:f,onMoveEnd:c,onConnect:h,onConnectStart:p,onConnectEnd:y,onClickConnectStart:v,onClickConnectEnd:b,onNodeMouseEnter:_,onNodeMouseMove:m,onNodeMouseLeave:w,onNodeContextMenu:A,onNodeDoubleClick:$,onNodeDragStart:M,onNodeDrag:D,onNodeDragStop:j,onNodesDelete:T,onEdgesDelete:L,onDelete:H,onSelectionChange:R,onSelectionDragStart:x,onSelectionDrag:k,onSelectionDragStop:C,onSelectionContextMenu:S,onSelectionStart:I,onSelectionEnd:E,onBeforeDelete:P,connectionMode:B,connectionLineType:V=ke.Bezier,connectionLineStyle:X,connectionLineComponent:W,connectionLineContainerStyle:z,deleteKeyCode:O="Backspace",selectionKeyCode:F="Shift",selectionOnDrag:Y=!1,selectionMode:U=yt.Full,panActivationKeyCode:J="Space",multiSelectionKeyCode:K=Zt()?"Meta":"Control",zoomActivationKeyCode:G=Zt()?"Meta":"Control",snapToGrid:ee,snapGrid:Q,onlyRenderVisibleElements:re=!1,selectNodesOnDrag:ue,nodesDraggable:Le,nodesConnectable:hn,nodesFocusable:gn,nodeOrigin:Je=oi,edgesFocusable:pn,edgesReconnectable:et,elementsSelectable:tt=!0,defaultViewport:mn=ah,minZoom:nt=.5,maxZoom:ot=2,translateExtent:kt=xt,preventScrolling:zi=!0,nodeExtent:xn,defaultMarkerColor:Ri="#b1b1b7",zoomOnScroll:Hi=!0,zoomOnPinch:Li=!0,panOnScroll:Bi=!1,panOnScrollSpeed:Fi=.5,panOnScrollMode:Oi=ze.Free,zoomOnDoubleClick:Vi=!0,panOnDrag:Yi=!0,onPaneClick:Xi,onPaneMouseEnter:Wi,onPaneMouseMove:qi,onPaneMouseLeave:Gi,onPaneScroll:Ui,onPaneContextMenu:Ki,paneClickDistance:mo=0,nodeClickDistance:Zi=0,children:Qi,onReconnect:Ji,onReconnectStart:ea,onReconnectEnd:ta,onEdgeContextMenu:na,onEdgeDoubleClick:oa,onEdgeMouseEnter:ra,onEdgeMouseMove:sa,onEdgeMouseLeave:ia,reconnectRadius:aa=10,onNodesChange:ca,onEdgesChange:la,noDragClassName:ua="nodrag",noWheelClassName:da="nowheel",noPanClassName:xo="nopan",fitView:yo,fitViewOptions:fa,connectOnClick:ha,attributionPosition:ga,proOptions:pa,defaultEdgeOptions:ma,elevateNodesOnSelect:xa,elevateEdgesOnSelect:ya,disableKeyboardA11y:wo=!1,autoPanOnConnect:wa,autoPanOnNodeDrag:ba,autoPanSpeed:va,connectionRadius:Na,isValidConnection:_a,onError:Ca,style:Ea,id:bo,nodeDragThreshold:Sa,viewport:ka,onViewportChange:Ma,width:Aa,height:Ia,colorMode:$a="light",debug:ja,onScroll:Mt,...Pa},Ta){const yn=bo||"1",Da=dh($a),za=N.useCallback(vo=>{vo.currentTarget.scrollTo({top:0,left:0,behavior:"instant"}),Mt==null||Mt(vo)},[Mt]);return g.jsx("div",{"data-testid":"rf__wrapper",...Pa,onScroll:za,style:{...Ea,...$g},ref:Ta,className:oe(["react-flow",r,Da]),id:bo,children:g.jsxs(Ig,{nodes:e,edges:t,width:Aa,height:Ia,fitView:yo,nodeOrigin:Je,nodeExtent:xn,children:[g.jsx(kg,{onInit:u,onNodeClick:a,onEdgeClick:l,onNodeMouseEnter:_,onNodeMouseMove:m,onNodeMouseLeave:w,onNodeContextMenu:A,onNodeDoubleClick:$,nodeTypes:s,edgeTypes:i,connectionLineType:V,connectionLineStyle:X,connectionLineComponent:W,connectionLineContainerStyle:z,selectionKeyCode:F,selectionOnDrag:Y,selectionMode:U,deleteKeyCode:O,multiSelectionKeyCode:K,panActivationKeyCode:J,zoomActivationKeyCode:G,onlyRenderVisibleElements:re,defaultViewport:mn,translateExtent:kt,minZoom:nt,maxZoom:ot,preventScrolling:zi,zoomOnScroll:Hi,zoomOnPinch:Li,zoomOnDoubleClick:Vi,panOnScroll:Bi,panOnScrollSpeed:Fi,panOnScrollMode:Oi,panOnDrag:Yi,onPaneClick:Xi,onPaneMouseEnter:Wi,onPaneMouseMove:qi,onPaneMouseLeave:Gi,onPaneScroll:Ui,onPaneContextMenu:Ki,paneClickDistance:mo,nodeClickDistance:Zi,onSelectionContextMenu:S,onSelectionStart:I,onSelectionEnd:E,onReconnect:Ji,onReconnectStart:ea,onReconnectEnd:ta,onEdgeContextMenu:na,onEdgeDoubleClick:oa,onEdgeMouseEnter:ra,onEdgeMouseMove:sa,onEdgeMouseLeave:ia,reconnectRadius:aa,defaultMarkerColor:Ri,noDragClassName:ua,noWheelClassName:da,noPanClassName:xo,rfId:yn,disableKeyboardA11y:wo,nodeExtent:xn,viewport:ka,onViewportChange:Ma}),g.jsx(uh,{nodes:e,edges:t,defaultNodes:n,defaultEdges:o,onConnect:h,onConnectStart:p,onConnectEnd:y,onClickConnectStart:v,onClickConnectEnd:b,nodesDraggable:Le,nodesConnectable:hn,nodesFocusable:gn,edgesFocusable:pn,edgesReconnectable:et,elementsSelectable:tt,elevateNodesOnSelect:xa,elevateEdgesOnSelect:ya,minZoom:nt,maxZoom:ot,nodeExtent:xn,onNodesChange:ca,onEdgesChange:la,snapToGrid:ee,snapGrid:Q,connectionMode:B,translateExtent:kt,connectOnClick:ha,defaultEdgeOptions:ma,fitView:yo,fitViewOptions:fa,onNodesDelete:T,onEdgesDelete:L,onDelete:H,onNodeDragStart:M,onNodeDrag:D,onNodeDragStop:j,onSelectionDrag:k,onSelectionDragStart:x,onSelectionDragStop:C,onMove:d,onMoveStart:f,onMoveEnd:c,noPanClassName:xo,nodeOrigin:Je,rfId:yn,autoPanOnConnect:wa,autoPanOnNodeDrag:ba,autoPanSpeed:va,onError:Ca,connectionRadius:Na,isValidConnection:_a,selectNodesOnDrag:ue,nodeDragThreshold:Sa,onBeforeDelete:P,paneClickDistance:mo,debug:ja}),g.jsx(ih,{onSelectionChange:R}),Qi,g.jsx(th,{proOptions:pa,position:ga}),g.jsx(Jf,{rfId:yn,disableKeyboardA11y:wo})]})})}var Pg=ai(jg);function Tg(e){const[t,n]=N.useState(e),o=N.useCallback(r=>n(s=>si(r,s)),[]);return[t,n,o]}function Dg(e){const[t,n]=N.useState(e),o=N.useCallback(r=>n(s=>ii(r,s)),[]);return[t,n,o]}function zg({dimensions:e,lineWidth:t,variant:n,className:o}){return g.jsx("path",{strokeWidth:t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`,className:oe(["react-flow__background-pattern",n,o])})}function Rg({radius:e,className:t}){return g.jsx("circle",{cx:e,cy:e,r:e,className:oe(["react-flow__background-pattern","dots",t])})}var Me;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(Me||(Me={}));const Hg={[Me.Dots]:1,[Me.Lines]:1,[Me.Cross]:6},Lg=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function $i({id:e,variant:t=Me.Dots,gap:n=20,size:o,lineWidth:r=1,offset:s=0,color:i,bgColor:a,style:l,className:u,patternClassName:d}){const f=N.useRef(null),{transform:c,patternId:h}=Z(Lg,ne),p=o||Hg[t],y=t===Me.Dots,v=t===Me.Cross,b=Array.isArray(n)?n:[n,n],_=[b[0]*c[2]||1,b[1]*c[2]||1],m=p*c[2],w=Array.isArray(s)?s:[s,s],A=v?[m,m]:_,$=[w[0]*c[2]||1+A[0]/2,w[1]*c[2]||1+A[1]/2],M=`${h}${e||""}`;return g.jsxs("svg",{className:oe(["react-flow__background",u]),style:{...l,...dn,"--xy-background-color-props":a,"--xy-background-pattern-color-props":i},ref:f,"data-testid":"rf__background",children:[g.jsx("pattern",{id:M,x:c[0]%_[0],y:c[1]%_[1],width:_[0],height:_[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${$[0]},-${$[1]})`,children:y?g.jsx(Rg,{radius:m/2,className:d}):g.jsx(zg,{dimensions:A,lineWidth:r,variant:t,className:d})}),g.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${M})`})]})}$i.displayName="Background";const Bg=N.memo($i);function Fg(){return g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:g.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function Og(){return g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:g.jsx("path",{d:"M0 0h32v4.2H0z"})})}function Vg(){return g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:g.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function Yg(){return g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:g.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function Xg(){return g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:g.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function Rt({children:e,className:t,...n}){return g.jsx("button",{type:"button",className:oe(["react-flow__controls-button",t]),...n,children:e})}const Wg=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom});function ji({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:o=!0,fitViewOptions:r,onZoomIn:s,onZoomOut:i,onFitView:a,onInteractiveChange:l,className:u,children:d,position:f="bottom-left",orientation:c="vertical","aria-label":h="React Flow controls"}){const p=te(),{isInteractive:y,minZoomReached:v,maxZoomReached:b}=Z(Wg,ne),{zoomIn:_,zoomOut:m,fitView:w}=go(),A=()=>{_(),s==null||s()},$=()=>{m(),i==null||i()},M=()=>{w(r),a==null||a()},D=()=>{p.setState({nodesDraggable:!y,nodesConnectable:!y,elementsSelectable:!y}),l==null||l(!y)},j=c==="horizontal"?"horizontal":"vertical";return g.jsxs(un,{className:oe(["react-flow__controls",j,u]),position:f,style:e,"data-testid":"rf__controls","aria-label":h,children:[t&&g.jsxs(g.Fragment,{children:[g.jsx(Rt,{onClick:A,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:b,children:g.jsx(Fg,{})}),g.jsx(Rt,{onClick:$,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:v,children:g.jsx(Og,{})})]}),n&&g.jsx(Rt,{className:"react-flow__controls-fitview",onClick:M,title:"fit view","aria-label":"fit view",children:g.jsx(Vg,{})}),o&&g.jsx(Rt,{className:"react-flow__controls-interactive",onClick:D,title:"toggle interactivity","aria-label":"toggle interactivity",children:y?g.jsx(Xg,{}):g.jsx(Yg,{})}),d]})}ji.displayName="Controls";const qg=N.memo(ji);function Gg({id:e,x:t,y:n,width:o,height:r,style:s,color:i,strokeColor:a,strokeWidth:l,className:u,borderRadius:d,shapeRendering:f,selected:c,onClick:h}){const{background:p,backgroundColor:y}=s||{},v=i||p||y;return g.jsx("rect",{className:oe(["react-flow__minimap-node",{selected:c},u]),x:t,y:n,rx:d,ry:d,width:o,height:r,style:{fill:v,stroke:a,strokeWidth:l},shapeRendering:f,onClick:h?b=>h(b,e):void 0})}const Ug=N.memo(Gg),Kg=e=>e.nodes.map(t=>t.id),kn=e=>e instanceof Function?e:()=>e;function Zg({nodeStrokeColor:e,nodeColor:t,nodeClassName:n="",nodeBorderRadius:o=5,nodeStrokeWidth:r,nodeComponent:s=Ug,onClick:i}){const a=Z(Kg,ne),l=kn(t),u=kn(e),d=kn(n),f=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return g.jsx(g.Fragment,{children:a.map(c=>g.jsx(Jg,{id:c,nodeColorFunc:l,nodeStrokeColorFunc:u,nodeClassNameFunc:d,nodeBorderRadius:o,nodeStrokeWidth:r,NodeComponent:s,onClick:i,shapeRendering:f},c))})}function Qg({id:e,nodeColorFunc:t,nodeStrokeColorFunc:n,nodeClassNameFunc:o,nodeBorderRadius:r,nodeStrokeWidth:s,shapeRendering:i,NodeComponent:a,onClick:l}){const{node:u,x:d,y:f,width:c,height:h}=Z(p=>{const y=p.nodeLookup.get(e),{x:v,y:b}=y.internals.positionAbsolute,{width:_,height:m}=_e(y);return{node:y,x:v,y:b,width:_,height:m}},ne);return!u||u.hidden||!Ps(u)?null:g.jsx(a,{x:d,y:f,width:c,height:h,style:u.style,selected:!!u.selected,className:o(u),color:t(u),borderRadius:r,strokeColor:n(u),strokeWidth:s,shapeRendering:i,onClick:l,id:u.id})}const Jg=N.memo(Qg);var ep=N.memo(Zg);const tp=200,np=150,op=e=>!e.hidden,rp=e=>{const t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?js(Et(e.nodeLookup,{filter:op}),t):t,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height}},sp="react-flow__minimap-desc";function Pi({style:e,className:t,nodeStrokeColor:n,nodeColor:o,nodeClassName:r="",nodeBorderRadius:s=5,nodeStrokeWidth:i,nodeComponent:a,bgColor:l,maskColor:u,maskStrokeColor:d,maskStrokeWidth:f,position:c="bottom-right",onClick:h,onNodeClick:p,pannable:y=!1,zoomable:v=!1,ariaLabel:b="React Flow mini map",inversePan:_,zoomStep:m=10,offsetScale:w=5}){const A=te(),$=N.useRef(null),{boundingRect:M,viewBB:D,rfId:j,panZoom:T,translateExtent:L,flowWidth:H,flowHeight:R}=Z(rp,ne),x=(e==null?void 0:e.width)??tp,k=(e==null?void 0:e.height)??np,C=M.width/x,S=M.height/k,I=Math.max(C,S),E=I*x,P=I*k,B=w*I,V=M.x-(E-M.width)/2-B,X=M.y-(P-M.height)/2-B,W=E+B*2,z=P+B*2,O=`${sp}-${j}`,F=N.useRef(0),Y=N.useRef();F.current=I,N.useEffect(()=>{if($.current&&T)return Y.current=Sf({domNode:$.current,panZoom:T,getTransform:()=>A.getState().transform,getViewScale:()=>F.current}),()=>{var K;(K=Y.current)==null||K.destroy()}},[T]),N.useEffect(()=>{var K;(K=Y.current)==null||K.update({translateExtent:L,width:H,height:R,inversePan:_,pannable:y,zoomStep:m,zoomable:v})},[y,v,_,m,L,H,R]);const U=h?K=>{var Q;const[G,ee]=((Q=Y.current)==null?void 0:Q.pointer(K))||[0,0];h(K,{x:G,y:ee})}:void 0,J=p?N.useCallback((K,G)=>{const ee=A.getState().nodeLookup.get(G);p(K,ee)},[]):void 0;return g.jsx(un,{position:c,style:{...e,"--xy-minimap-background-color-props":typeof l=="string"?l:void 0,"--xy-minimap-mask-background-color-props":typeof u=="string"?u:void 0,"--xy-minimap-mask-stroke-color-props":typeof d=="string"?d:void 0,"--xy-minimap-mask-stroke-width-props":typeof f=="number"?f*I:void 0,"--xy-minimap-node-background-color-props":typeof o=="string"?o:void 0,"--xy-minimap-node-stroke-color-props":typeof n=="string"?n:void 0,"--xy-minimap-node-stroke-width-props":typeof i=="string"?i:void 0},className:oe(["react-flow__minimap",t]),"data-testid":"rf__minimap",children:g.jsxs("svg",{width:x,height:k,viewBox:`${V} ${X} ${W} ${z}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":O,ref:$,onClick:U,children:[b&&g.jsx("title",{id:O,children:b}),g.jsx(ep,{onClick:J,nodeColor:o,nodeStrokeColor:n,nodeBorderRadius:s,nodeClassName:r,nodeStrokeWidth:i,nodeComponent:a}),g.jsx("path",{className:"react-flow__minimap-mask",d:`M${V-B},${X-B}h${W+B*2}v${z+B*2}h${-W-B*2}z
        M${D.x},${D.y}h${D.width}v${D.height}h${-D.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}Pi.displayName="MiniMap";N.memo(Pi);function ip({nodeId:e,position:t,variant:n=dt.Handle,className:o,style:r={},children:s,color:i,minWidth:a=10,minHeight:l=10,maxWidth:u=Number.MAX_VALUE,maxHeight:d=Number.MAX_VALUE,keepAspectRatio:f=!1,shouldResize:c,onResizeStart:h,onResize:p,onResizeEnd:y}){const v=di(),b=typeof e=="string"?e:v,_=te(),m=N.useRef(null),w=n===dt.Line?"right":"bottom-right",A=t??w,$=N.useRef(null);N.useEffect(()=>{if(!(!m.current||!b))return $.current||($.current=Ff({domNode:m.current,nodeId:b,getStoreItems:()=>{const{nodeLookup:T,transform:L,snapGrid:H,snapToGrid:R,nodeOrigin:x,domNode:k}=_.getState();return{nodeLookup:T,transform:L,snapGrid:H,snapToGrid:R,nodeOrigin:x,paneDomNode:k}},onChange:(T,L)=>{const{triggerNodeChanges:H,nodeLookup:R,parentLookup:x,nodeOrigin:k}=_.getState(),C=[],S={x:T.x,y:T.y},I=R.get(b);if(I&&I.expandParent&&I.parentId){const E=I.origin??k,P=T.width??I.measured.width??0,B=T.height??I.measured.height??0,V={id:I.id,parentId:I.parentId,rect:{width:P,height:B,...Ts({x:T.x??I.position.x,y:T.y??I.position.y},{width:P,height:B},I.parentId,R,E)}},X=ho([V],R,x,k);C.push(...X),S.x=T.x?Math.max(E[0]*P,T.x):void 0,S.y=T.y?Math.max(E[1]*B,T.y):void 0}if(S.x!==void 0&&S.y!==void 0){const E={id:b,type:"position",position:{...S}};C.push(E)}if(T.width!==void 0&&T.height!==void 0){const E={id:b,type:"dimensions",resizing:!0,setAttributes:!0,dimensions:{width:T.width,height:T.height}};C.push(E)}for(const E of L){const P={...E,type:"position"};C.push(P)}H(C)},onEnd:()=>{const T={id:b,type:"dimensions",resizing:!1};_.getState().triggerNodeChanges([T])}})),$.current.update({controlPosition:A,boundaries:{minWidth:a,minHeight:l,maxWidth:u,maxHeight:d},keepAspectRatio:f,onResizeStart:h,onResize:p,onResizeEnd:y,shouldResize:c}),()=>{var T;(T=$.current)==null||T.destroy()}},[A,a,l,u,d,f,h,p,y,c]);const M=A.split("-"),D=n===dt.Line?"borderColor":"backgroundColor",j=i?{...r,[D]:i}:r;return g.jsx("div",{className:oe(["react-flow__resize-control","nodrag",...M,n,o]),ref:m,style:j,children:s})}N.memo(ip);const it={x:250,y:120},ap=[{id:"start",type:"input",position:{x:100,y:100},data:{label:"Start"},style:{background:"#f7f7f7",border:"1px solid #ddd",borderRadius:"8px",padding:"10px",width:150}},{id:"application-1",type:"application",position:{x:100+it.x,y:100},data:{label:"CRM API",description:"Customer data source",icon:"database"}},{id:"tool-1",type:"tool",position:{x:100+it.x*2,y:100},data:{label:"Data Processor",description:"Transforms customer data",icon:"tool"}},{id:"agent-1",type:"agent",position:{x:100+it.x*2,y:100+it.y},data:{label:"AI Assistant",description:"Analyzes customer data",icon:"brain"}},{id:"end",type:"output",position:{x:100+it.x*3,y:100},data:{label:"End"},style:{background:"#f7f7f7",border:"1px solid #ddd",borderRadius:"8px",padding:"10px",width:150}}],cp=[{id:"e-start-app1",source:"start",target:"application-1",animated:!0,style:{stroke:"#555",strokeWidth:2}},{id:"e-app1-tool1",source:"application-1",target:"tool-1",animated:!0,style:{stroke:"#555",strokeWidth:2}},{id:"e-tool1-agent1",source:"tool-1",target:"agent-1",animated:!0,style:{stroke:"#555",strokeWidth:2}},{id:"e-agent1-end",source:"agent-1",target:"end",animated:!0,style:{stroke:"#555",strokeWidth:2}}];function lp({isOpen:e,setIsOpen:t,nodeId:n,nodeName:o,initialNote:r,onSave:s}){const[i,a]=Mn.useState(r);Mn.useEffect(()=>{e&&a(r)},[e,r]);const l=()=>{n&&(s(n,i),t(!1))};return g.jsx(Mr,{open:e,onOpenChange:t,children:g.jsxs(Ar,{className:"sm:max-w-[500px]",children:[g.jsxs(Ir,{children:[g.jsxs($r,{children:["Node Note: ",o]}),g.jsx(jr,{children:"Add a descriptive note to explain what this node does in your workflow."})]}),g.jsx("div",{className:"grid gap-4 py-4",children:g.jsxs("div",{className:"grid gap-2",children:[g.jsx(Fe,{htmlFor:"note",children:"Note"}),g.jsx(An,{id:"note",value:i,onChange:u=>a(u.target.value),placeholder:"Describe what this node does...",className:"min-h-[150px]"})]})}),g.jsxs(Pr,{children:[g.jsx(se,{type:"button",variant:"outline",onClick:()=>t(!1),children:"Cancel"}),g.jsx(se,{type:"button",onClick:l,children:"Save"})]})]})})}function up(){const[e,t,n]=Tg(ap),[o,r,s]=Dg(cp),[i,a]=N.useState(null),[l,u]=N.useState(null),[d,f]=N.useState({x:0,y:0}),[c,h]=N.useState(!1),[p,y]=N.useState(!1),[v,b]=N.useState(!1),[_,m]=N.useState(null),w=N.useRef(null),A=N.useCallback(z=>r(O=>Fs({...z,animated:!0,style:{stroke:"#555",strokeWidth:2}},O)),[r]),$=N.useCallback((z,O)=>{u(O),y(!0)},[]),M=N.useCallback(()=>{u(null),y(!1)},[]),D=N.useCallback(z=>{z.preventDefault(),z.dataTransfer.dropEffect="move"},[]),j=N.useCallback((z,O)=>{if(z.preventDefault(),!O.current||!i)return;const F=O.current.getBoundingClientRect(),Y=z.dataTransfer.getData("application/reactflow/type"),U=z.dataTransfer.getData("application/reactflow/label");if(!Y||typeof Y!="string")return;const J=i.screenToFlowPosition({x:z.clientX-F.left,y:z.clientY-F.top}),K={id:`${Y}-${Date.now()}`,type:Y,position:J,data:{label:U||`${Y.charAt(0).toUpperCase()+Y.slice(1)}`,onDelete:L,onClone:H,onSettings:R,onAddNote:x,onEditNote:k}};t(G=>G.concat(K))},[i,t]),T=N.useCallback(z=>{if(!w.current||!i)return;const O=w.current.getBoundingClientRect(),F=i.screenToFlowPosition({x:z.clientX-O.left,y:z.clientY-O.top});f(F),h(!0)},[i]),L=N.useCallback(z=>{t(O=>O.filter(F=>F.id!==z)),l&&l.id===z&&(u(null),y(!1)),fe.success("Node deleted")},[l,t]),H=N.useCallback(z=>{if(!z||!z.position)return;const O={x:z.position.x+50,y:z.position.y+50},F={...z,id:`${z.type}-${Date.now()}`,position:O,data:{...z.data,onDelete:L,onClone:H,onSettings:R,onAddNote:x,onEditNote:k}};t(Y=>[...Y,F]),fe.success("Node cloned")},[t]),R=N.useCallback(z=>{u(z),y(!0)},[]),x=N.useCallback(z=>{m(z.id),b(!0)},[]),k=N.useCallback(z=>{m(z),b(!0)},[]),C=N.useCallback((z,O)=>{t(F=>F.map(Y=>Y.id===z?{...Y,data:{...Y.data,note:O.trim()===""?void 0:O}}:Y)),O.trim()===""?fe.success("Note removed"):fe.success("Note saved")},[t]),S=N.useCallback((z,O)=>{t(F=>F.map(Y=>Y.id===z.id?{...Y,data:{...Y.data,...O}}:Y))},[t]),I=N.useCallback(()=>{y(!1)},[]),E=N.useCallback(()=>{if(!_)return{note:"",nodeName:""};const z=e.find(O=>O.id===_);return z?{note:typeof z.data.note=="string"?z.data.note:"",nodeName:typeof z.data.label=="string"?z.data.label:"Node"}:{note:"",nodeName:""}},[e,_]),P=N.useCallback((z,O)=>{if(!i)return;const F=i.screenToFlowPosition({x:window.innerWidth/2,y:window.innerHeight/2}),Y={id:`${z}-${Date.now()}`,type:z,position:F,data:{label:O,onDelete:L,onClone:H,onSettings:R,onAddNote:x,onEditNote:k}};t(U=>U.concat(Y))},[i,t,L,H,R,x,k]),B=N.useCallback((z,O)=>{const F={id:`${z}-${Date.now()}`,type:z,position:d,data:{label:O,onDelete:L,onClone:H,onSettings:R,onAddNote:x,onEditNote:k}};t(Y=>Y.concat(F)),h(!1)},[d,t,L,H,R,x,k]),V=N.useCallback(z=>z.trim()?!0:(fe.error("Please enter a workflow name"),!1),[]),X=E(),W=g.jsx(lp,{isOpen:v,setIsOpen:b,nodeId:_||"",nodeName:X.nodeName,initialNote:X.note,onSave:C});return{nodes:e,edges:o,onNodesChange:n,onEdgesChange:s,onConnect:A,onNodeClick:$,onPaneClick:M,onDragOver:D,onDrop:j,onAddNode:T,selectedNode:l,setSelectedNode:u,deleteNode:L,cloneNode:H,selectNodeForEditing:R,reactFlowInstance:i,setReactFlowInstance:a,isNodePickerOpen:c,setIsNodePickerOpen:h,nodePickerPosition:d,handleNodeAdd:B,handleAddNodeFromToolbar:P,saveWorkflow:V,reactFlowWrapper:w,setNodes:t,isNoteDialogOpen:v,setIsNoteDialogOpen:b,noteNodeId:_,openNoteDialog:x,openEditNoteDialog:k,saveNodeNote:C,noteDialogElement:W,isConfigPanelOpen:p,closeConfigPanel:I,saveNodeConfig:S}}const dp=[{type:"application",label:"Application",icon:Xn,description:"External API or service",color:"bg-yellow-100 border-yellow-300 hover:bg-yellow-200"},{type:"tool",label:"Tool",icon:Wn,description:"Process or transform data",color:"bg-blue-100 border-blue-300 hover:bg-blue-200"},{type:"agent",label:"Agent",icon:qn,description:"AI-powered assistant",color:"bg-pink-100 border-pink-300 hover:bg-pink-200"},{type:"task",label:"Task",icon:Qn,description:"Specific action to perform",color:"bg-green-100 border-green-300 hover:bg-green-200"},{type:"memory",label:"Memory",icon:Gn,description:"Store context information",color:"bg-purple-100 border-purple-300 hover:bg-purple-200"},{type:"reasoning",label:"Reasoning",icon:Zn,description:"Decision-making logic",color:"bg-teal-100 border-teal-300 hover:bg-teal-200"},{type:"input",label:"Input",icon:Un,description:"Starting point for data flow",color:"bg-gray-100 border-gray-300 hover:bg-gray-200"},{type:"output",label:"Output",icon:Kn,description:"Final result or endpoint",color:"bg-gray-100 border-gray-300 hover:bg-gray-200"}];function fp({isOpen:e,setIsOpen:t,position:n,onSelect:o}){const r=N.useRef(null);N.useEffect(()=>{const i=a=>{r.current&&!r.current.contains(a.target)&&t(!1)};return document.addEventListener("mousedown",i),()=>{document.removeEventListener("mousedown",i)}},[t]);const s=(i,a)=>{o(i,a)};return g.jsxs("div",{ref:r,className:"absolute z-10 bg-white rounded-md shadow-lg border p-2 w-72",style:{left:`${n.x}px`,top:`${n.y}px`,transform:"translate(-50%, -50%)"},children:[g.jsx("div",{className:"text-sm font-medium p-2 border-b mb-2",children:"Add Node"}),g.jsx("div",{className:"grid grid-cols-2 gap-2 max-h-80 overflow-y-auto p-1",children:dp.map(i=>g.jsxs("div",{className:`cursor-pointer rounded-md border p-2 transition-colors ${i.color}`,onClick:()=>s(i.type,i.label),draggable:!0,onDragStart:a=>{a.dataTransfer.setData("application/reactflow/type",i.type),a.dataTransfer.setData("application/reactflow/label",i.label),a.dataTransfer.effectAllowed="move"},children:[g.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[g.jsx(i.icon,{className:"h-4 w-4"}),g.jsx("span",{className:"font-medium",children:i.label})]}),g.jsx("p",{className:"text-xs text-muted-foreground",children:i.description})]},i.type))})]})}const hp=Ua,gp=Ka,pp=Za;function mp({workflowName:e,setWorkflowName:t,onBack:n,projectId:o}){return g.jsxs("div",{className:"flex items-center gap-4",children:[g.jsx(se,{variant:"ghost",onClick:n,className:"h-8 w-8 p-0",children:g.jsx(tc,{className:"h-4 w-4"})}),g.jsxs("div",{children:[g.jsx(In,{value:e,onChange:r=>t(r.target.value),className:"font-medium text-lg border-none focus-visible:ring-0 focus-visible:ring-offset-0 h-8 p-0"}),o&&g.jsxs("p",{className:"text-muted-foreground text-sm",children:["Project: ",o]})]})]})}function xp({onViewCode:e,onRun:t,onSave:n,onSettings:o,isSaving:r,isRunning:s,isDeploying:i,onDeploy:a}){return g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsxs(se,{size:"sm",variant:"outline",children:[g.jsx(Vr,{className:"mr-1 h-3 w-3"})," View Code"]}),g.jsxs(se,{variant:"outline",className:"gap-1 h-8",onClick:t,disabled:s,children:[s?g.jsx("span",{className:"h-3 w-3 animate-spin",children:""}):g.jsx(dc,{className:"h-3 w-3"}),"Run"]}),g.jsxs(se,{variant:"outline",className:"gap-1 h-8",onClick:a,disabled:i,children:[i?g.jsx("span",{className:"h-3 w-3 animate-spin",children:""}):g.jsx(uc,{className:"h-3 w-3"}),"Deploy"]}),g.jsxs(se,{className:"gap-1 h-8",onClick:n,disabled:r,children:[r?g.jsx("span",{className:"h-3 w-3 animate-spin",children:""}):g.jsx(nc,{className:"h-3 w-3"}),"Save"]}),g.jsx(se,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:o,children:g.jsx(Yr,{className:"h-4 w-4"})})]})}function yp({type:e,label:t,icon:n,color:o,onClick:r}){return g.jsxs(se,{variant:"outline",className:`flex items-center gap-1 h-8 ${o} border`,onClick:()=>r(e,t),children:[g.jsx(n,{className:"h-3 w-3"}),g.jsx("span",{className:"text-xs font-medium",children:t})]})}function wp({onAddNode:e}){const t=[{type:"application",label:"Application",icon:Xn,color:"bg-yellow-100 hover:bg-yellow-200 border-yellow-300"},{type:"tool",label:"Tool",icon:Wn,color:"bg-blue-100 hover:bg-blue-200 border-blue-300"},{type:"agent",label:"Agent",icon:qn,color:"bg-pink-100 hover:bg-pink-200 border-pink-300"},{type:"task",label:"Task",icon:Qn,color:"bg-green-100 hover:bg-green-200 border-green-300"},{type:"memory",label:"Memory",icon:Gn,color:"bg-purple-100 hover:bg-purple-200 border-purple-300"},{type:"reasoning",label:"Reasoning",icon:Zn,color:"bg-teal-100 hover:bg-teal-200 border-teal-300"},{type:"input",label:"Input",icon:Un,color:"bg-gray-100 hover:bg-gray-200 border-gray-300"},{type:"output",label:"Output",icon:Kn,color:"bg-gray-100 hover:bg-gray-200 border-gray-300"}];return g.jsx("div",{className:"p-4 border-t bg-gray-50 flex flex-wrap gap-2 overflow-x-auto",children:t.map(n=>g.jsx(yp,{type:n.type,label:n.label,icon:n.icon,color:n.color,onClick:e},n.type))})}function bp({workflowName:e,setWorkflowName:t,onViewCode:n,onSave:o,onRun:r,onSettings:s,onBack:i,projectId:a,isSaving:l,isRunning:u,isDeploying:d,onDeploy:f,onAddNode:c}){const[h,p]=N.useState(!0);return g.jsxs(hp,{open:h,onOpenChange:p,className:"border-b bg-white transition-all",children:[g.jsxs("div",{className:"p-4 flex justify-between items-center",children:[g.jsx(mp,{workflowName:e,setWorkflowName:t,onBack:i,projectId:a}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(xp,{onViewCode:n,onRun:r,onSave:o,onSettings:s,isSaving:l,isRunning:u,isDeploying:!1,onDeploy:()=>{}}),g.jsx(gp,{asChild:!0,children:g.jsx(se,{variant:"ghost",size:"icon",className:"h-8 w-8",children:h?g.jsx(oc,{className:"h-4 w-4"}):g.jsx(rc,{className:"h-4 w-4"})})})]})]}),g.jsx(pp,{children:g.jsx(wp,{onAddNode:c})})]})}function vp({isOpen:e,setIsOpen:t,workflowName:n,setWorkflowName:o,workflowDescription:r,setWorkflowDescription:s}){return g.jsx(Mr,{open:e,onOpenChange:t,children:g.jsxs(Ar,{className:"sm:max-w-md",children:[g.jsxs(Ir,{children:[g.jsx($r,{children:"Workflow Settings"}),g.jsx(jr,{children:"Configure the settings for your workflow."})]}),g.jsxs("div",{className:"space-y-4 py-2",children:[g.jsxs("div",{className:"space-y-2",children:[g.jsx("label",{htmlFor:"name",className:"text-sm font-medium",children:"Workflow Name"}),g.jsx("input",{id:"name",value:n,onChange:i=>o(i.target.value),className:"w-full p-2 border rounded"})]}),g.jsxs("div",{className:"space-y-2",children:[g.jsx("label",{htmlFor:"description",className:"text-sm font-medium",children:"Description"}),g.jsx("textarea",{id:"description",value:r,onChange:i=>s(i.target.value),rows:3,className:"w-full p-2 border rounded"})]}),g.jsxs("div",{children:[g.jsx("h3",{className:"text-sm font-medium mb-2",children:"Export Options"}),g.jsxs("div",{className:"flex gap-2",children:[g.jsxs(se,{variant:"outline",size:"sm",className:"flex-1",children:[g.jsx(sc,{className:"mr-1 h-3 w-3"})," Export JSON"]}),g.jsxs(se,{variant:"outline",size:"sm",className:"flex-1",children:[g.jsx(Vr,{className:"mr-1 h-3 w-3"})," Export Code"]})]})]})]}),g.jsxs(Pr,{className:"justify-between sm:justify-between",children:[g.jsxs(se,{type:"button",variant:"destructive",size:"sm",children:[g.jsx(Xr,{className:"mr-1 h-3 w-3"})," Delete Workflow"]}),g.jsx(se,{type:"button",onClick:()=>t(!1),children:"Close"})]})]})})}const Np=Qa,_p=Ja,Cp=N.forwardRef(({className:e,inset:t,children:n,...o},r)=>g.jsxs(Rr,{ref:r,className:Ie("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground",t&&"pl-8",e),...o,children:[n,g.jsx(ac,{className:"ml-auto h-4 w-4"})]}));Cp.displayName=Rr.displayName;const Ep=N.forwardRef(({className:e,...t},n)=>g.jsx(Hr,{ref:n,className:Ie("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));Ep.displayName=Hr.displayName;const Ti=N.forwardRef(({className:e,...t},n)=>g.jsx(ec,{children:g.jsx(Tr,{ref:n,className:Ie("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t})}));Ti.displayName=Tr.displayName;const lt=N.forwardRef(({className:e,inset:t,...n},o)=>g.jsx(Dr,{ref:o,className:Ie("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t&&"pl-8",e),...n}));lt.displayName=Dr.displayName;const Sp=N.forwardRef(({className:e,children:t,checked:n,...o},r)=>g.jsxs(Lr,{ref:r,className:Ie("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:n,...o,children:[g.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:g.jsx(Br,{children:g.jsx(cc,{className:"h-4 w-4"})})}),t]}));Sp.displayName=Lr.displayName;const kp=N.forwardRef(({className:e,children:t,...n},o)=>g.jsxs(Fr,{ref:o,className:Ie("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...n,children:[g.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:g.jsx(Br,{children:g.jsx(lc,{className:"h-2 w-2 fill-current"})})}),t]}));kp.displayName=Fr.displayName;const Mp=N.forwardRef(({className:e,inset:t,...n},o)=>g.jsx(Or,{ref:o,className:Ie("px-2 py-1.5 text-sm font-semibold text-foreground",t&&"pl-8",e),...n}));Mp.displayName=Or.displayName;const Di=N.forwardRef(({className:e,...t},n)=>g.jsx(zr,{ref:n,className:Ie("-mx-1 my-1 h-px bg-border",e),...t}));Di.displayName=zr.displayName;function Ap({children:e,node:t,onDelete:n,onClone:o,onSettings:r,onAddNote:s}){return g.jsxs(Np,{children:[g.jsx(_p,{asChild:!0,children:e}),g.jsxs(Ti,{className:"w-48",children:[g.jsxs(lt,{onClick:()=>r(t),className:"cursor-pointer",children:[g.jsx(Yr,{className:"mr-2 h-4 w-4"}),g.jsx("span",{children:"Settings"})]}),g.jsxs(lt,{onClick:()=>o(t),className:"cursor-pointer",children:[g.jsx(ic,{className:"mr-2 h-4 w-4"}),g.jsx("span",{children:"Clone"})]}),g.jsxs(lt,{onClick:()=>s(t),className:"cursor-pointer",children:[g.jsx(Wr,{className:"mr-2 h-4 w-4"}),g.jsx("span",{children:"Add/Edit Note"})]}),g.jsx(Di,{}),g.jsxs(lt,{onClick:()=>n(t.id),className:"cursor-pointer text-destructive focus:text-destructive",children:[g.jsx(Xr,{className:"mr-2 h-4 w-4"}),g.jsx("span",{children:"Delete"})]})]})]})}const $e={application:Xn,tool:Wn,agent:qn,task:Qn,memory:Gn,reasoning:Zn,input:Un,output:Kn},ie={application:{bg:"bg-yellow-50",border:"border-yellow-200"},tool:{bg:"bg-blue-50",border:"border-blue-200"},agent:{bg:"bg-pink-50",border:"border-pink-200"},task:{bg:"bg-green-50",border:"border-green-200"},memory:{bg:"bg-purple-50",border:"border-purple-200"},reasoning:{bg:"bg-teal-50",border:"border-teal-200"},input:{bg:"bg-gray-50",border:"border-gray-200"},output:{bg:"bg-gray-50",border:"border-gray-200"}},je=({data:e,icon:t,bgColor:n,borderColor:o,...r})=>{const s={id:r.id,type:r.type||"default",position:{x:r.positionAbsoluteX??0,y:r.positionAbsoluteY??0},data:e},i=g.jsxs("div",{className:`px-4 py-2 rounded-md shadow-sm ${n} ${o} border-2 min-w-[180px] relative`,children:[g.jsx(Qe,{type:"target",position:q.Left,className:"w-3 h-3 rounded-full bg-gray-400 border-2 border-white"}),g.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[g.jsx(t,{className:"h-5 w-5"}),g.jsx("span",{className:"font-medium text-sm",children:e.label||"Node"}),e.note&&g.jsxs(qr,{variant:"outline",className:"ml-auto cursor-pointer bg-white border-blue-400 hover:bg-blue-50",onClick:()=>e.onEditNote&&e.onEditNote(r.id),children:[g.jsx(Wr,{className:"h-3 w-3 mr-1"})," Note"]})]}),e.description&&g.jsx("p",{className:"text-xs text-muted-foreground",children:String(e.description)}),g.jsx(Qe,{type:"source",position:q.Right,className:"w-3 h-3 rounded-full bg-gray-400 border-2 border-white"})]});return e.onDelete&&e.onClone&&e.onSettings&&e.onAddNote?g.jsx(Ap,{node:s,onDelete:e.onDelete,onClone:e.onClone,onSettings:e.onSettings,onAddNote:e.onAddNote,children:i}):i},Ip=N.memo(e=>g.jsx(je,{...e,icon:$e.application,bgColor:ie.application.bg,borderColor:ie.application.border})),$p=N.memo(e=>g.jsx(je,{...e,icon:$e.tool,bgColor:ie.tool.bg,borderColor:ie.tool.border})),jp=N.memo(e=>g.jsx(je,{...e,icon:$e.agent,bgColor:ie.agent.bg,borderColor:ie.agent.border})),Pp=N.memo(e=>g.jsx(je,{...e,icon:$e.task,bgColor:ie.task.bg,borderColor:ie.task.border})),Tp=N.memo(e=>g.jsx(je,{...e,icon:$e.memory,bgColor:ie.memory.bg,borderColor:ie.memory.border})),Dp=N.memo(e=>g.jsx(je,{...e,icon:$e.reasoning,bgColor:ie.reasoning.bg,borderColor:ie.reasoning.border})),zp=N.memo(e=>g.jsx(je,{...e,icon:$e.input,bgColor:ie.input.bg,borderColor:ie.input.border})),Rp=N.memo(e=>g.jsx(je,{...e,icon:$e.output,bgColor:ie.output.bg,borderColor:ie.output.border})),Hp={application:Ip,tool:$p,agent:jp,task:Pp,memory:Tp,reasoning:Dp,input:zp,output:Rp};function Lp({nodes:e,edges:t,onNodesChange:n,onEdgesChange:o,onConnect:r,onNodeClick:s,onPaneClick:i,setReactFlowInstance:a,onDrop:l,onDragOver:u,selectedNode:d,setNodes:f,onAddNode:c,reactFlowWrapper:h}){const p=N.useCallback(v=>{v.preventDefault()},[]),y=N.useCallback(v=>{l(v,h)},[l,h]);return g.jsx("div",{ref:h,className:"flex-1 h-full",onContextMenu:p,children:g.jsxs(Pg,{nodes:e,edges:t,onNodesChange:n,onEdgesChange:o,onConnect:r,onNodeClick:s,onPaneClick:i,onContextMenu:p,onInit:a,onDrop:y,onDragOver:u,fitView:!0,attributionPosition:"bottom-right",nodeTypes:Hp,onPaneContextMenu:c,children:[g.jsx(Bg,{gap:16,size:1}),g.jsx(qg,{})]})})}function Bp({node:e,onClose:t,onSaveChanges:n}){const[o,r]=N.useState({}),[s,i]=N.useState(!1);N.useEffect(()=>{e&&e.data&&(r({...e.data}),i(!1))},[e]),N.useEffect(()=>{const f=c=>{c.key==="Escape"&&(s?window.confirm("You have unsaved changes. Are you sure you want to close?")&&t():t())};return window.addEventListener("keydown",f),()=>{window.removeEventListener("keydown",f)}},[t,s]);const a=N.useCallback((f,c)=>{r(h=>({...h,[f]:c})),i(!0)},[]),l=N.useCallback(()=>{e&&(n(e,o),i(!1),fe.success("Node configuration saved"))},[e,o,n]),u=N.useCallback(()=>{s&&!window.confirm("You have unsaved changes. Are you sure you want to close?")||t()},[t,s]);if(!e)return null;const d=Object.entries(o).filter(([f,c])=>typeof c!="function"&&!f.startsWith("on")&&!["id","position","type","__rf"].includes(f));return g.jsxs("div",{className:`fixed right-0 top-0 bottom-0 w-[360px] bg-background border-l border-border shadow-lg transform transition-transform duration-300 z-20 flex flex-col overflow-hidden ${e?"translate-x-0":"translate-x-full"}`,children:[g.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx("h3",{className:"text-lg font-semibold",children:"Node Configuration"}),g.jsx(qr,{variant:"outline",className:"ml-2",children:e.type})]}),g.jsx(se,{variant:"ghost",size:"icon",onClick:u,className:"h-8 w-8",children:g.jsx(Xa,{className:"h-4 w-4"})})]}),g.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:g.jsx("div",{className:"space-y-6",children:g.jsxs("div",{className:"space-y-4",children:[g.jsxs("div",{className:"space-y-2",children:[g.jsx(Fe,{htmlFor:"node-label",children:"Label"}),g.jsx(In,{id:"node-label",value:o.label||"",onChange:f=>a("label",f.target.value),placeholder:"Node Label"})]}),g.jsxs("div",{className:"space-y-2",children:[g.jsx(Fe,{htmlFor:"node-description",children:"Description"}),g.jsx(An,{id:"node-description",value:o.description||"",onChange:f=>a("description",f.target.value),placeholder:"Describe this node's purpose",rows:3})]}),o.note!==void 0&&g.jsxs("div",{className:"space-y-2",children:[g.jsx(Fe,{htmlFor:"node-note",children:"Note"}),g.jsx(An,{id:"node-note",value:o.note||"",onChange:f=>a("note",f.target.value),placeholder:"Add a note to this node",rows:3})]}),d.map(([f,c])=>f==="label"||f==="description"||f==="note"||typeof c!="string"&&typeof c!="number"&&typeof c!="boolean"?null:g.jsxs("div",{className:"space-y-2",children:[g.jsx(Fe,{htmlFor:`node-${f}`,children:f.charAt(0).toUpperCase()+f.slice(1)}),typeof c=="boolean"?g.jsxs("div",{className:"flex items-center space-x-2",children:[g.jsx("input",{type:"checkbox",id:`node-${f}`,checked:c,onChange:h=>a(f,h.target.checked),className:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),g.jsx(Fe,{htmlFor:`node-${f}`,children:"Enabled"})]}):g.jsx(In,{id:`node-${f}`,value:c,onChange:h=>a(f,h.target.value)})]},f))]})})}),g.jsxs("div",{className:"border-t p-4 flex justify-end gap-3",children:[g.jsx(se,{variant:"outline",onClick:u,children:"Cancel"}),g.jsx(se,{onClick:l,disabled:!s,children:"Save Changes"})]})]})}const Fp=mc(({children:e})=>e,{fallback:({error:e,componentStack:t,resetError:n})=>g.jsxs("div",{className:"p-8 border rounded-md bg-red-50 m-4",children:[g.jsx("h2",{className:"text-xl font-semibold text-red-700 mb-2",children:"Workflow Editor Error"}),g.jsx("p",{className:"mb-4 text-red-600",children:e.message}),g.jsx("button",{onClick:n,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",children:"Reset Editor"})]}),onError:(e,t,n)=>{console.error("Workflow Editor Error:",e),kr(e,{tags:{component:"WorkflowEditorPage"},contexts:{react:{componentStack:t}}}),fe.error(`Workflow Editor error: ${e.message}`)}});function Op(){const{projectId:e}=La(),t=Ba(),{user:n}=Wa(),[o,r]=N.useState("My Workflow"),[s,i]=N.useState(""),[a,l]=N.useState(!1),[u,d]=N.useState(!1),[f,c]=N.useState(!1),[h,p]=N.useState(!1),{nodes:y,edges:v,onNodesChange:b,onEdgesChange:_,onConnect:m,onNodeClick:w,onPaneClick:A,onDragOver:$,onDrop:M,onAddNode:D,selectedNode:j,setNodes:T,setReactFlowInstance:L,isNodePickerOpen:H,setIsNodePickerOpen:R,nodePickerPosition:x,handleNodeAdd:k,handleAddNodeFromToolbar:C,saveWorkflow:S,reactFlowWrapper:I,closeConfigPanel:E,saveNodeConfig:P,noteDialogElement:B}=up(),V=N.useCallback(()=>{S(o)&&(d(!0),setTimeout(()=>{fe.success("Workflow saved successfully"),d(!1)},1e3))},[o,S]),X=N.useCallback(()=>{p(!0),setTimeout(()=>{fe.success("Workflow deployed successfully"),p(!1)},Math.floor(Math.random()*1e3)+1e3)},[]),W=N.useCallback(()=>{if(c(!0),Math.random()<.8)throw fe.error("Error: Workflow execution failed"),c(!1),new Error("Simulated error during workflow execution");setTimeout(()=>{fe.success("Workflow executed successfully"),c(!1)},Math.floor(Math.random()*1500)+500)},[]),z=()=>{t("/studio")},O=j?"flex flex-col h-[calc(100vh-5rem)] pr-[360px] transition-all duration-300":"flex flex-col h-[calc(100vh-5rem)] transition-all duration-300";return N.useEffect(()=>{qa("page","workflow-editor"),Ga("workflow",{projectId:e,workflowName:o,nodesCount:y.length,edgesCount:v.length})},[e,o,y.length,v.length]),g.jsxs("div",{className:O,children:[g.jsx(bp,{workflowName:o,setWorkflowName:r,onViewCode:()=>t(`/studio/projects/${e}/code`),onSave:V,onRun:W,onSettings:()=>l(!0),onBack:z,projectId:e,isSaving:u,isRunning:f,isDeploying:h,onDeploy:X,onAddNode:C}),g.jsx(Lp,{nodes:y,edges:v,onNodesChange:b,onEdgesChange:_,onConnect:m,setReactFlowInstance:L,onDrop:M,onDragOver:$,onNodeClick:w,onPaneClick:A,selectedNode:j,setNodes:T,onAddNode:D,reactFlowWrapper:I}),H&&g.jsx(fp,{isOpen:H,setIsOpen:R,position:x,onSelect:k}),g.jsx(vp,{isOpen:a,setIsOpen:l,workflowName:o,setWorkflowName:r,workflowDescription:s,setWorkflowDescription:i}),g.jsx(Bp,{node:j,onClose:E,onSaveChanges:P}),B]})}function g0(){return g.jsx(Fp,{children:g.jsx(Op,{})})}export{g0 as default};
//# sourceMappingURL=WorkflowEditorPage-B8CHbqbp.js.map

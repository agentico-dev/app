import{j as r,p as b,u as g,q as x}from"./react-vendor-TyuC8qxg.js";import{R as v,a as w}from"./radio-group-BcLi_fAC.js";import{C as j,c as q}from"./card-DAAmTFtc.js";import{C as N}from"./check-CG9NCPd3.js";import{u as C,f as E,s as c}from"./index-D5uhiMQB.js";try{let s=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},t=new s.Error().stack;t&&(s._sentryDebugIds=s._sentryDebugIds||{},s._sentryDebugIds[t]="216e8f3a-e209-45c3-9ad5-ee2cfca9a201",s._sentryDebugIdIdentifier="sentry-dbid-216e8f3a-e209-45c3-9ad5-ee2cfca9a201")}catch{}function F({plans:s=[],selectedPlan:t,selectedPlanId:o,onSelectPlan:u}){const p=t||o||"",f=(s.length>0?s:[{id:"free",name:"Free",description:"Get started with basic features",price:0,interval:"monthly",features:["5 projects","Basic analytics","Community support"],active:!0},{id:"pro",name:"Pro",description:"For professional developers and teams",price:0,interval:"monthly",features:["Unlimited projects","Advanced analytics","Priority support","Custom integrations"],active:!0},{id:"enterprise",name:"Enterprise",description:"For large organizations with complex needs",price:0,interval:"monthly",features:["Unlimited everything","Dedicated support","Custom development","SLA guarantees","Enterprise SSO"],active:!0}]).reduce((n,i)=>(n[i.name]||(n[i.name]=[]),n[i.name].push(i),n),{});return r.jsx(v,{value:p,onValueChange:u,className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:Object.entries(f).map(([n,i])=>r.jsx(j,{className:`relative cursor-pointer transition-all ${i.some(d=>d.id===p)?"border-primary ring-2 ring-primary ring-offset-2":"hover:border-primary/50"}`,children:r.jsxs(q,{className:"p-6",children:[r.jsx(w,{value:i[0].id,id:n,className:"absolute right-4 top-4"}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"font-semibold",children:n}),r.jsx("p",{className:"text-sm text-muted-foreground",children:i[0].description})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-3xl font-bold",children:"$0"}),r.jsx("div",{className:"text-sm text-muted-foreground",children:"During beta"})]}),r.jsx("ul",{className:"space-y-2 text-sm",children:i[0].features.map((d,m)=>r.jsxs("li",{className:"flex items-center",children:[r.jsx(N,{className:"h-4 w-4 mr-2 text-primary"}),d]},m))})]})]})},n))})}function A(){var m;const s=b(),{session:t}=C(),{toast:o}=E(),u=!!t.user,{data:p=[],isLoading:h,error:f}=g({queryKey:["plans"],queryFn:async()=>{const{data:e,error:a}=await c.from("plans").select("*").order("price");if(a)throw a;return e}}),{data:n}=g({queryKey:["currentPlan",(m=t.user)==null?void 0:m.id],queryFn:async()=>{if(!t.user)return null;const{data:e,error:a}=await c.from("profiles").select("plan_id").eq("id",t.user.id).single();if(a)throw a;if(!(e!=null&&e.plan_id))return null;const{data:y,error:l}=await c.from("plans").select("*").eq("id",e.plan_id).single();if(l)throw l;return y},enabled:u}),i=x({mutationFn:async e=>{if(!t.user)throw new Error("Authentication required");const{error:a}=await c.from("profiles").update({plan_id:e,updated_at:new Date().toISOString()}).eq("id",t.user.id);if(a)throw a;const{data:y,error:l}=await c.from("plans").select("*").eq("id",e).single();if(l)throw l;return y},onSuccess:()=>{s.invalidateQueries({queryKey:["currentPlan"]}),o({title:"Plan updated",description:"Your subscription plan has been updated successfully."})},onError:e=>{o({title:"Error updating plan",description:e.message,variant:"destructive"})}}),d=x({mutationFn:async()=>{if(!t.user)throw new Error("Authentication required");const{error:e}=await c.from("profiles").update({plan_id:null,updated_at:new Date().toISOString()}).eq("id",t.user.id);if(e)throw e;return{success:!0}},onSuccess:()=>{s.invalidateQueries({queryKey:["currentPlan"]}),o({title:"Subscription canceled",description:"Your subscription has been canceled successfully."})},onError:e=>{o({title:"Error canceling subscription",description:e.message,variant:"destructive"})}});return{plans:p,currentPlan:n,isLoading:h,error:f,isAuthenticated:u,updatePlan:i,cancelSubscription:d}}export{F as P,A as u};
//# sourceMappingURL=usePlans-CZ0bocCl.js.map

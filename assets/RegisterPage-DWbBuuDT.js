import{j as e,p as U,u as q,q as E,r as x,t as T,L as K}from"./react-vendor-D9Z7L--9.js";import{B as w}from"./button-DyydDRsx.js";import{I as N}from"./input-C9MDm0T4.js";import{L as b}from"./label-Cq7s04FH.js";import{C as A,d as D,a as B,b as O,c as Q,e as G}from"./card-j9p50iY2.js";import{A as Y,a as z}from"./alert-B5yO3tQn.js";import{c as Z,u as F,b as I,s as g}from"./index-AU1k0GBq.js";import{z as j}from"./form-components-pVS8YJLg.js";import{R as $,a as H}from"./radio-group-DuLWSpMY.js";import{C as J}from"./check-B_vNfbYE.js";import{C as M}from"./circle-alert-DRDtbE-S.js";import{U as W}from"./user-DYaIP0qn.js";import{A as X}from"./arrow-right-C-0zz3DL.js";import{A as V}from"./arrow-left-CoG1BIxl.js";import"./ui-components-CC8ri8vc.js";import"./supabase-BVXwAj-b.js";import"./utils-DVqAV-fM.js";import"./circle-Bd03-FbO.js";try{let s=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},t=new s.Error().stack;t&&(s._sentryDebugIds=s._sentryDebugIds||{},s._sentryDebugIds[t]="58cc6400-3ecb-4e29-bd70-fa56294cff16",s._sentryDebugIdIdentifier="sentry-dbid-58cc6400-3ecb-4e29-bd70-fa56294cff16")}catch{}/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=Z("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);function re({plans:s=[],selectedPlan:t,selectedPlanId:o,onSelectPlan:y}){const d=t||o||"",m=(s.length>0?s:[{id:"free",name:"Free",description:"Get started with basic features",price:0,interval:"monthly",features:["5 projects","Basic analytics","Community support"],active:!0},{id:"pro",name:"Pro",description:"For professional developers and teams",price:0,interval:"monthly",features:["Unlimited projects","Advanced analytics","Priority support","Custom integrations"],active:!0},{id:"enterprise",name:"Enterprise",description:"For large organizations with complex needs",price:0,interval:"monthly",features:["Unlimited everything","Dedicated support","Custom development","SLA guarantees","Enterprise SSO"],active:!0}]).reduce((n,a)=>(n[a.name]||(n[a.name]=[]),n[a.name].push(a),n),{});return e.jsx($,{value:d,onValueChange:y,className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:Object.entries(m).map(([n,a])=>e.jsx(A,{className:`relative cursor-pointer transition-all ${a.some(p=>p.id===d)?"border-primary ring-2 ring-primary ring-offset-2":"hover:border-primary/50"}`,children:e.jsxs(D,{className:"p-6",children:[e.jsx(H,{value:a[0].id,id:n,className:"absolute right-4 top-4"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:n}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a[0].description})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-3xl font-bold",children:"$0"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"During beta"})]}),e.jsx("ul",{className:"space-y-2 text-sm",children:a[0].features.map((p,f)=>e.jsxs("li",{className:"flex items-center",children:[e.jsx(J,{className:"h-4 w-4 mr-2 text-primary"}),p]},f))})]})]})},n))})}function se(){var f;const s=U(),{session:t}=F(),{toast:o}=I(),y=!!t.user,{data:d=[],isLoading:v,error:m}=q({queryKey:["plans"],queryFn:async()=>{const{data:r,error:i}=await g.from("plans").select("*").order("price");if(i)throw i;return r}}),{data:n}=q({queryKey:["currentPlan",(f=t.user)==null?void 0:f.id],queryFn:async()=>{if(!t.user)return null;const{data:r,error:i}=await g.from("profiles").select("plan_id").eq("id",t.user.id).single();if(i)throw i;if(!(r!=null&&r.plan_id))return null;const{data:u,error:h}=await g.from("plans").select("*").eq("id",r.plan_id).single();if(h)throw h;return u},enabled:y}),a=E({mutationFn:async r=>{if(!t.user)throw new Error("Authentication required");const{error:i}=await g.from("profiles").update({plan_id:r,updated_at:new Date().toISOString()}).eq("id",t.user.id);if(i)throw i;const{data:u,error:h}=await g.from("plans").select("*").eq("id",r).single();if(h)throw h;return u},onSuccess:()=>{s.invalidateQueries({queryKey:["currentPlan"]}),o({title:"Plan updated",description:"Your subscription plan has been updated successfully."})},onError:r=>{o({title:"Error updating plan",description:r.message,variant:"destructive"})}}),p=E({mutationFn:async()=>{if(!t.user)throw new Error("Authentication required");const{error:r}=await g.from("profiles").update({plan_id:null,updated_at:new Date().toISOString()}).eq("id",t.user.id);if(r)throw r;return{success:!0}},onSuccess:()=>{s.invalidateQueries({queryKey:["currentPlan"]}),o({title:"Subscription canceled",description:"Your subscription has been canceled successfully."})},onError:r=>{o({title:"Error canceling subscription",description:r.message,variant:"destructive"})}});return{plans:d,currentPlan:n,isLoading:v,error:m,isAuthenticated:y,updatePlan:a,cancelSubscription:p}}const P=j.object({fullName:j.string().min(2,"Name must be at least 2 characters"),email:j.string().email("Please enter a valid email"),password:j.string().min(6,"Password must be at least 6 characters")});function we(){const[s,t]=x.useState(1),[o,y]=x.useState(""),[d,v]=x.useState(""),[m,n]=x.useState(""),[a,p]=x.useState("free"),[f,r]=x.useState(!1),[i,u]=x.useState(null),{signUp:h}=F(),{plans:_}=se(),k=T(),{toast:C}=I(),L=async l=>{l.preventDefault(),r(!0),u(null);try{const c=P.parse({fullName:o,email:d,password:m}),{error:S}=await h(c.email,c.password,{full_name:c.fullName,plan_id:a});if(S)throw S;C({title:"Registration successful",description:"Your account has been created and you are now logged in."}),k("/")}catch(c){console.error("Registration error:",c),c instanceof j.ZodError?u(c.errors[0].message):u(c.message||"Failed to register"),C({title:"Registration failed",description:c.message||"There was a problem creating your account.",variant:"destructive"})}finally{r(!1)}},R=()=>{try{s===1&&(P.parse({fullName:o,email:d,password:m}),t(2))}catch(l){l instanceof j.ZodError&&u(l.errors[0].message)}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-muted/40 px-4",children:e.jsxs(A,{className:"w-full max-w-md",children:[e.jsxs(B,{className:"space-y-1",children:[e.jsx(O,{className:"text-2xl text-center",children:"Create an account"}),e.jsx(Q,{className:"text-center",children:s===1?"Enter your details to create an account":"Choose your plan (all free during beta)"})]}),e.jsxs(D,{className:"space-y-4",children:[i&&e.jsxs(Y,{variant:"destructive",children:[e.jsx(M,{className:"h-4 w-4"}),e.jsx(z,{children:i})]}),s===1?e.jsxs("form",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{htmlFor:"fullName",children:"Full Name"}),e.jsxs("div",{className:"relative",children:[e.jsx(W,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground h-4 w-4"}),e.jsx(N,{id:"fullName",placeholder:"John Doe",value:o,onChange:l=>y(l.target.value),className:"pl-9",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{htmlFor:"email",children:"Email"}),e.jsx(N,{id:"email",type:"email",placeholder:"you@example.com",value:d,onChange:l=>v(l.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{htmlFor:"password",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(ee,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground h-4 w-4"}),e.jsx(N,{id:"password",type:"password",value:m,onChange:l=>n(l.target.value),className:"pl-9",required:!0})]})]}),e.jsxs(w,{type:"button",onClick:R,className:"w-full",children:["Continue ",e.jsx(X,{className:"ml-2 h-4 w-4"})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsx(re,{plans:_,selectedPlan:a,onSelectPlan:p}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs(w,{variant:"outline",type:"button",onClick:()=>t(1),className:"flex-1",children:[e.jsx(V,{className:"mr-2 h-4 w-4"})," Back"]}),e.jsx(w,{type:"button",onClick:L,className:"flex-1",disabled:f,children:f?"Creating Account...":"Create Account"})]})]})]}),e.jsx(G,{className:"flex flex-col space-y-4",children:e.jsxs("div",{className:"text-center text-sm text-muted-foreground",children:["Already have an account?"," ",e.jsx(K,{to:"/login",className:"text-primary hover:underline",children:"Sign in"})]})})]})})}export{we as default};
//# sourceMappingURL=RegisterPage-DWbBuuDT.js.map

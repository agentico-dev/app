import{j as e,r as A,L as G,u as J,l as W}from"./react-vendor-BIgZFnT2.js";import{u as q}from"./data-management-CvhHSD84.js";import{c as N,b as X,s as P,u as ee}from"./index-CCNkFhSt.js";import{T as se,a as ae,b as C,c as k}from"./tabs-BczPh-l6.js";import{C as j,a as p,b as y,c as b,d as g,e as re}from"./card-V8-Ke11t.js";import{B as t}from"./button-BwNwf_Dd.js";import{A as B,b as I,a as O}from"./alert-BBLkmMUr.js";import{S as v}from"./skeleton-Ds1sbJrL.js";import{a as E}from"./useOrganizations-xScNtNHy.js";import{A as ie,a as te}from"./avatar-CEXGMVOf.js";import{D as U,a as V,b as _,c as H,d as R,e as Y,f as Z}from"./dialog-D56bs7oc.js";import{I as K}from"./input-BLgNcvcB.js";import{L as w}from"./label-DmJGSaxI.js";import{S as ne,a as le,b as ce,c as de,d as S}from"./select-Fgt86WMA.js";import{C as oe}from"./circle-plus-BPIL71yT.js";import{B as Q}from"./badge-B5M88Wjv.js";import{C as me}from"./circle-alert-PqFqny9F.js";import{T as he}from"./textarea-Bzd9kmtz.js";import{F as $}from"./folder-CZi9zJKK.js";import{a as xe}from"./utils-CP2dCvBX.js";import{A as D}from"./arrow-left-DQ-A3jIw.js";import{S as je}from"./shield-DwRLAFB2.js";import{U as ue}from"./users-CcJrrCNw.js";import"./ui-components-CeV64dF6.js";import"./chevron-down-7AMG3Sqm.js";import"./check-D24AWwEj.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=N("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=N("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=N("FolderPlus",[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=N("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=N("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);function ge({organization:n,members:l,isLoading:d,isAuthenticated:c,isOrgMember:r}){const{addMember:m}=E(n.id),[i,h]=React.useState(!1),[o,x]=React.useState({email:"",role:"member"}),f=async s=>{s.preventDefault();try{await m.mutateAsync(o),h(!1),x({email:"",role:"member"})}catch(a){console.error("Error adding member:",a)}};return d?e.jsxs(j,{children:[e.jsxs(p,{children:[e.jsx(y,{children:"Team Members"}),e.jsx(b,{children:"Manage your organization's team members."})]}),e.jsx(g,{children:e.jsx("div",{className:"space-y-4",children:[1,2,3].map(s=>e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-muted"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"h-5 w-32 bg-muted rounded"}),e.jsx("div",{className:"h-4 w-24 bg-muted rounded"})]})]},s))})})]}):e.jsxs(j,{children:[e.jsxs(p,{className:"flex-row items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(y,{children:"Team Members"}),e.jsx(b,{children:"Manage your organization's team members."})]}),e.jsxs(U,{open:i,onOpenChange:h,children:[e.jsx(V,{asChild:!0,children:e.jsxs(t,{disabled:!c||!r,children:[e.jsx(L,{className:"h-4 w-4 mr-2"}),"Invite Member"]})}),e.jsxs(_,{children:[e.jsxs(H,{children:[e.jsx(R,{children:"Invite team member"}),e.jsx(Y,{children:"Add a new member to your organization. They will receive an email invitation."})]}),e.jsxs("form",{onSubmit:f,children:[e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(w,{htmlFor:"email",children:"Email"}),e.jsx(K,{id:"email",type:"email",value:o.email,onChange:s=>x({...o,email:s.target.value}),placeholder:"coworker@example.com",required:!0})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(w,{htmlFor:"role",children:"Role"}),e.jsxs(ne,{value:o.role,onValueChange:s=>x({...o,role:s}),children:[e.jsx(le,{id:"role",children:e.jsx(ce,{placeholder:"Select a role"})}),e.jsxs(de,{children:[e.jsx(S,{value:"admin",children:"Admin"}),e.jsx(S,{value:"member",children:"Member"})]})]})]})]}),e.jsx(Z,{children:e.jsx(t,{type:"submit",disabled:m.isPending,children:m.isPending?"Inviting...":"Invite Member"})})]})]})]})]}),e.jsx(g,{children:l.length===0?e.jsxs("div",{className:"text-center p-6",children:[e.jsx(L,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No team members yet"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Invite team members to collaborate with you in this organization."}),c&&r&&e.jsxs(t,{onClick:()=>h(!0),children:[e.jsx(oe,{className:"h-4 w-4 mr-2"}),"Invite Member"]})]}):e.jsx("div",{className:"space-y-4",children:l.map(s=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(ie,{children:e.jsx(te,{children:s.user_id.substring(0,2).toUpperCase()})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.user_id}),e.jsx("p",{className:"text-sm text-muted-foreground capitalize",children:s.role})]})]}),c&&r&&s.role!=="owner"&&e.jsx(t,{variant:"outline",size:"sm",disabled:!r,children:"Remove"})]},s.id))})})]})}function fe({organization:n,isAuthenticated:l,isOrgMember:d}){return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(j,{children:[e.jsxs(p,{children:[e.jsx(y,{children:"Current Plan"}),e.jsx(b,{children:"Manage your subscription and billing information."})]}),e.jsxs(g,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Free Plan"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Basic features for small organizations"})]}),e.jsx(Q,{className:"bg-blue-100 text-blue-800 hover:bg-blue-100",children:"Current Plan"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(M,{className:"h-4 w-4 mr-2 text-green-500"}),e.jsx("span",{children:"Up to 3 team members"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(M,{className:"h-4 w-4 mr-2 text-green-500"}),e.jsx("span",{children:"5 projects"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(M,{className:"h-4 w-4 mr-2 text-green-500"}),e.jsx("span",{children:"Basic analytics"})]})]})]}),e.jsx(re,{children:e.jsxs(t,{disabled:!l||!d,children:[e.jsx(z,{className:"h-4 w-4 mr-2"}),"Upgrade Plan"]})})]}),e.jsxs(j,{children:[e.jsxs(p,{children:[e.jsx(y,{children:"Payment Methods"}),e.jsx(b,{children:"Manage your payment methods and billing history."})]}),e.jsx(g,{children:!l||!d?e.jsxs(B,{children:[e.jsx(me,{className:"h-4 w-4"}),e.jsx(I,{children:"Access restricted"}),e.jsx(O,{children:"You need to sign in and be a member of this organization to view payment methods."})]}):e.jsxs("div",{className:"text-center p-6",children:[e.jsx(z,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No payment methods"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"You haven't added any payment methods yet."}),e.jsx(t,{children:"Add Payment Method"})]})})]})]})}function ye({organization:n,isAuthenticated:l,isOrgMember:d}){const{toast:c}=X(),[r,m]=A.useState(!1),[i,h]=A.useState({name:"",description:""}),{data:o,isLoading:x,refetch:f}=q({queryKey:["organization-projects",n.id],queryFn:async()=>{console.log("Fetching projects for organization:",n.id);const{data:a,error:u}=await P.from("projects").select("*").eq("organization_id",n.id);if(u)throw console.error("Error fetching projects:",u),c({title:"Error fetching projects",description:u.message,variant:"destructive"}),u;return console.log("Fetched projects:",a),a}}),s=async a=>{a.preventDefault();try{const{data:u,error:T}=await P.from("projects").insert({name:i.name,description:i.description,organization_id:n.id,status:"active"}).select();if(T)throw T;c({title:"Project created",description:"Your new project has been created successfully."}),m(!1),h({name:"",description:""}),f()}catch(u){console.error("Error creating project:",u),c({title:"Error creating project",description:u.message,variant:"destructive"})}};return x?e.jsxs(j,{children:[e.jsxs(p,{children:[e.jsx(y,{children:"Projects"}),e.jsx(b,{children:"Projects in this organization."})]}),e.jsx(g,{children:e.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:[1,2,3,4].map(a=>e.jsxs(j,{children:[e.jsxs(p,{className:"p-4",children:[e.jsx(v,{className:"h-5 w-3/4"}),e.jsx(v,{className:"h-4 w-1/2 mt-2"})]}),e.jsx(g,{className:"p-4 pt-0",children:e.jsx(v,{className:"h-4 w-full"})})]},a))})})]}):e.jsxs(j,{children:[e.jsxs(p,{className:"flex-row items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(y,{children:"Projects"}),e.jsx(b,{children:"Projects in this organization."})]}),e.jsxs(U,{open:r,onOpenChange:m,children:[e.jsx(V,{asChild:!0,children:e.jsxs(t,{disabled:!l||!d,children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),"New Project"]})}),e.jsxs(_,{children:[e.jsxs(H,{children:[e.jsx(R,{children:"Create a new project"}),e.jsx(Y,{children:"Add a new project to your organization."})]}),e.jsxs("form",{onSubmit:s,children:[e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(w,{htmlFor:"name",children:"Project Name"}),e.jsx(K,{id:"name",value:i.name,onChange:a=>h({...i,name:a.target.value}),placeholder:"My Awesome Project",required:!0})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(w,{htmlFor:"description",children:"Description"}),e.jsx(he,{id:"description",value:i.description,onChange:a=>h({...i,description:a.target.value}),placeholder:"Project description",rows:3})]})]}),e.jsx(Z,{children:e.jsx(t,{type:"submit",children:"Create Project"})})]})]})]})]}),e.jsx(g,{children:!o||o.length===0?e.jsxs("div",{className:"text-center p-6",children:[e.jsx($,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No projects yet"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"This organization doesn't have any projects yet."}),l&&d&&e.jsxs(t,{onClick:()=>m(!0),children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),"Create Project"]})]}):e.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:o.map(a=>e.jsxs(j,{children:[e.jsxs(p,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(y,{className:"text-lg",children:a.name}),e.jsx(Q,{className:a.status==="active"?"bg-green-100 text-green-800":a.status==="archived"?"bg-amber-100 text-amber-800":"bg-gray-100 text-gray-800",children:a.status})]}),e.jsx(b,{className:"line-clamp-2",children:a.description||"No description available"})]}),e.jsxs(g,{className:"p-4 pt-0",children:[e.jsx("div",{className:"flex items-center text-sm text-muted-foreground",children:e.jsxs("span",{children:["Created ",xe(new Date(a.created_at),"MMM d, yyyy")]})}),e.jsx("div",{className:"mt-4",children:e.jsx(t,{asChild:!0,variant:"outline",size:"sm",children:e.jsx(G,{to:`/projects/${a.id}`,children:"View Project"})})})]})]},a.id))})})]})}function Ze(){const{slug:n}=J(),l=W(),{session:d}=ee(),c=!!d.user,{data:r,isLoading:m}=q({queryKey:["organization",n],queryFn:async()=>{if(!n)throw new Error("Organization slug is required");const{data:f,error:s}=await P.from("organizations").select("*").eq("slug",n).single();if(s)throw s;return f},enabled:!!n}),{members:i,isLoading:h}=E(r==null?void 0:r.id),x=!!(i==null?void 0:i.find(f=>{var s;return f.user_id===((s=d.user)==null?void 0:s.id)}));return m?e.jsxs("div",{className:"container py-6 space-y-6",children:[e.jsx(v,{className:"h-8 w-1/3"}),e.jsx(v,{className:"h-4 w-1/4"}),e.jsx(v,{className:"h-64 w-full"})]}):r?e.jsxs("div",{className:"container py-6 space-y-6",children:[e.jsxs(t,{variant:"ghost",onClick:()=>l("/orgs"),children:[e.jsx(D,{className:"mr-2 h-4 w-4"})," Back to Organizations"]}),e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:r.name}),e.jsx("p",{className:"text-muted-foreground",children:r.description||"No description available"})]})}),!c&&e.jsxs(B,{variant:"default",className:"bg-amber-50 border-amber-200",children:[e.jsx(je,{className:"h-4 w-4 text-amber-500"}),e.jsx(I,{children:"Limited Access Mode"}),e.jsx(O,{children:"You're browsing in read-only mode. Sign in to manage this organization."})]}),e.jsxs(se,{defaultValue:"teams",className:"space-y-4",children:[e.jsxs(ae,{children:[e.jsxs(C,{value:"teams",children:[e.jsx(ue,{className:"h-4 w-4 mr-2"}),"Teams"]}),e.jsxs(C,{value:"billing",children:[e.jsx(z,{className:"h-4 w-4 mr-2"}),"Billing"]}),e.jsxs(C,{value:"projects",children:[e.jsx($,{className:"h-4 w-4 mr-2"}),"Projects"]})]}),e.jsx(k,{value:"teams",children:e.jsx(ge,{organization:r,members:i||[],isLoading:h,isAuthenticated:c,isOrgMember:x})}),e.jsx(k,{value:"billing",children:e.jsx(fe,{organization:r,isAuthenticated:c,isOrgMember:x})}),e.jsx(k,{value:"projects",children:e.jsx(ye,{organization:r,isAuthenticated:c,isOrgMember:x})})]})]}):e.jsxs("div",{className:"container py-6 space-y-6",children:[e.jsxs(t,{variant:"ghost",onClick:()=>l("/orgs"),children:[e.jsx(D,{className:"mr-2 h-4 w-4"})," Back to Organizations"]}),e.jsxs(j,{className:"p-8 flex flex-col items-center justify-center",children:[e.jsx(pe,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Organization not found"}),e.jsx("p",{className:"text-muted-foreground text-center max-w-md mb-4",children:"The organization you're looking for doesn't exist or you don't have permission to view it."}),e.jsx(t,{onClick:()=>l("/orgs"),children:"View All Organizations"})]})]})}export{Ze as default};
